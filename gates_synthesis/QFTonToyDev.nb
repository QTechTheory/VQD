(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33549,        710]
NotebookOptionsPosition[     30970,        658]
NotebookOutlinePosition[     31434,        676]
CellTagsIndexPosition[     31391,        673]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["QFT compilation", "Title",
 CellChangeTimes->{{3.8250058175043*^9, 3.825005854301442*^9}, {
  3.825006152419363*^9, 3.825006172060075*^9}, {3.825680827842572*^9, 
  3.8256808389487886`*^9}, {3.825701169183799*^9, 3.825701169340406*^9}, {
  3.826958311226933*^9, 3.826958327332601*^9}, {3.842502300665689*^9, 
  3.842502301878525*^9}, {3.8527993524910507`*^9, 3.852799360462612*^9}, {
  3.863432931373426*^9, 3.8634329616989822`*^9}, {3.868699024409354*^9, 
  3.868699027187418*^9}, {3.8686990665437183`*^9, 3.868699069668198*^9}, {
  3.868857053844982*^9, 
  3.868857066254548*^9}},ExpressionUUID->"abee3c70-2cd9-4715-9efd-\
c85791f2af36"],

Cell[CellGroupData[{

Cell["Toy device", "Chapter",
 CellChangeTimes->{{3.863449622964633*^9, 3.863449640468264*^9}, {
  3.868702687223363*^9, 3.868702689142354*^9}, {3.868857079463719*^9, 
  3.86885708128574*^9}},ExpressionUUID->"15a258ee-e7ec-417a-b517-\
50e93cc27c2b"],

Cell["Connectivity ", "Text",
 CellChangeTimes->{{3.8635059243554497`*^9, 3.863505939276258*^9}, {
  3.8688570976355124`*^9, 3.868857101970723*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"829ac279-643d-41d9-9158-11ee57dfc634"],

Cell[BoxData[
 RowBox[{
  RowBox[{"qubitsnum", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.868701528515696*^9, 3.868701533647602*^9}, {
  3.869159972995378*^9, 3.8691599733452806`*^9}, {3.870752271423876*^9, 
  3.8707522717552147`*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"a11c428d-b472-4d42-a296-b2fe5a4aef48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"qubitsnum", "-", "1"}]}], "]"}], ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"j", "\[UndirectedEdge]", 
      RowBox[{"j", "+", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"qubitsnum", "-", "2"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"VertexLabels", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{"Automatic", ",", "Center"}], "]"}]}], ",", 
   RowBox[{"VertexSize", "->", ".5"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.863505483563426*^9, 3.8635054902090187`*^9}, {
  3.863505806370343*^9, 3.863505906907765*^9}, {3.868699035081149*^9, 
  3.868699040695284*^9}, {3.8687015354471197`*^9, 3.8687015524694853`*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"f9fb01b6-1b1b-458a-a9b0-7eb0e5e5f7d5"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{0, 1, 2, 3}, {Null, {{1, 2}, {2, 3}, {3, 4}}}, {VertexLabels -> {
         Placed[Automatic, Center]}, VertexSize -> {0.5}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.], 
        ArrowBox[{{{0., 6.123233995736766*^-16}, {1., 
         4.898587196589413*^-16}}, {{1., 4.898587196589413*^-16}, {2., 
         2.4492935982947064`*^-16}}, {{2., 2.4492935982947064`*^-16}, {3., 
         0.}}}, 0.25]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 6.123233995736766*^-16}, 0.25], 
         InsetBox["0", {0., 6.123233995736766*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{1., 4.898587196589413*^-16}, 0.25], 
         InsetBox["1", {1., 4.898587196589413*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{2., 2.4492935982947064*^-16}, 0.25], 
         InsetBox["2", {2., 2.4492935982947064*^-16},
          BaseStyle->"Graphics"]}, {DiskBox[{3., 0.}, 0.25], 
         InsetBox["3", {3., 0.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{244.58333333333348`, Automatic}]], "Output",
 CellChangeTimes->{{3.8672286966902933`*^9, 3.8672287137016706`*^9}, 
   3.8672287633080797`*^9, 3.867296832619426*^9, 3.86730206170811*^9, 
   3.867385362630368*^9, 3.8677216080791397`*^9, 3.867740155111438*^9, 
   3.867751159165362*^9, 3.867751464268873*^9, 3.8677543072330217`*^9, 
   3.8678289453897657`*^9, 3.8678301737210712`*^9, 3.867830438434613*^9, 
   3.8678311207762127`*^9, 3.867831436176279*^9, 3.867832323919236*^9, 
   3.8679127000123367`*^9, {3.867922855099888*^9, 3.86792288391193*^9}, {
   3.867923165395238*^9, 3.8679231938986483`*^9}, 3.868519985594151*^9, 
   3.86852027647814*^9, 3.868692564871982*^9, 3.868699041694007*^9, {
   3.868701546444068*^9, 3.86870155316722*^9}, 3.8688572781095057`*^9, 
   3.868947153626165*^9, 3.868948549636544*^9, 3.868948594447659*^9, 
   3.8689486548995037`*^9, 3.868949069046781*^9, 3.868949131642275*^9, 
   3.868949462112677*^9, 3.868949525354032*^9, 3.8689527196758833`*^9, 
   3.8689561867571697`*^9, 3.868956289455407*^9, 3.868956327421945*^9, 
   3.868956429952786*^9, 3.868957267739599*^9, 3.868966975827427*^9, {
   3.868967247101918*^9, 3.868967265136766*^9}, 3.8689673239638023`*^9, 
   3.868967424136404*^9, 3.868967746459702*^9, 3.868968006604723*^9, 
   3.868971132620616*^9, 3.868971420512353*^9, 3.868971569528208*^9, 
   3.868971679609589*^9, 3.868971796737116*^9, 3.868992162080902*^9, 
   3.868994306683622*^9, 3.869033369973422*^9, 3.8690342376852407`*^9, 
   3.869050191629937*^9, {3.8690504119282007`*^9, 3.869050450896221*^9}, 
   3.869050921224902*^9, 3.869051027855961*^9, 3.869053864950305*^9, 
   3.8690539328511047`*^9, 3.869053992631894*^9, 3.869054285013618*^9, 
   3.8690544071099253`*^9, {3.869054444163455*^9, 3.86905451460464*^9}, {
   3.86905526760845*^9, 3.869055282353483*^9}, 3.869061052780702*^9, {
   3.869061236659766*^9, 3.869061252903678*^9}, {3.869061331482931*^9, 
   3.869061360282213*^9}, 3.8690615272179317`*^9, {3.8690615703847513`*^9, 
   3.869061587889533*^9}, 3.86906170707477*^9, 3.869061750192768*^9, 
   3.8690620448221693`*^9, {3.869062118405478*^9, 3.869062124892518*^9}, {
   3.869062174176552*^9, 3.869062201825343*^9}, {3.869062272734911*^9, 
   3.869062287942178*^9}, {3.869062329039198*^9, 3.869062421594831*^9}, 
   3.8690721243366823`*^9, 3.869072181731422*^9, 3.8690752153164377`*^9, 
   3.869077075693163*^9, 3.8690775849532413`*^9, 3.8690779579315643`*^9, {
   3.869078353948028*^9, 3.869078369445347*^9}, 3.869078435689641*^9, 
   3.8690784765679483`*^9, 3.869078666786448*^9, 3.8690786978239594`*^9, {
   3.86907873402036*^9, 3.8690788021404037`*^9}, {3.869078856614025*^9, 
   3.869078881495789*^9}, 3.869119673949834*^9, 3.869120013407447*^9, 
   3.869159975226276*^9, 3.870751724506734*^9, 3.8707522731141577`*^9, 
   3.870752477890399*^9, 3.870927101174553*^9, 3.8709273205228233`*^9, 
   3.870927391610318*^9, 3.870943340755886*^9, 3.870943545308506*^9, 
   3.870943967413371*^9, 3.8709442914721413`*^9, 3.870944670993614*^9, 
   3.870944705192268*^9, 3.870945026338194*^9, 3.8709465732050943`*^9, 
   3.870946622095911*^9, 3.870947213992221*^9, 3.870948214846197*^9, 
   3.870948303788052*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"1127a691-deac-49fe-9472-db1838dc5b36"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ToyDevice", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"qubitsNum", "->", "qubitsnum"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"average", " ", "of", " ", "T1"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "->", 
      SuperscriptBox["10", "5"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "T2", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"T2", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Set", " ", "the", " ", "standard", " ", "depolarising", " ", "and", 
       " ", "dephasing", " ", "passive", " ", "noise", " ", "using", " ", 
       "T1", " ", "and", " ", 
       RowBox[{"T2", "/", "T2s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"StdPassiveNoise", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fidelities", " ", "of", " ", "X"}], "-"}], ",", " ", 
       RowBox[{"Y", "-"}], ",", " ", 
       RowBox[{
        RowBox[{"and", " ", "Z"}], "-", " ", 
        RowBox[{
        "rotations", " ", "by", " ", "random", " ", "benchmarking"}]}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidSingle", "->", "0.995"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Error", " ", 
       RowBox[{"fraction", "/", "ratio"}], " ", 
       RowBox[{"{", 
        RowBox[{"depolarising", ",", " ", "dephasing"}], "}"}], " ", "sum", 
       " ", "is", " ", "either", " ", "one", " ", "or", " ", "zero"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"EFSingle", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", "qubit", " ", "gate", " ", "frequency"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RabiFreq", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fidelities", " ", "of", " ", "X"}], "-"}], ",", " ", 
       RowBox[{"Y", "-"}], ",", " ", 
       RowBox[{
        RowBox[{"and", " ", "Z"}], "-", " ", 
        RowBox[{
        "rotations", " ", "by", " ", "random", " ", "benchmarking"}]}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidTwo", "->", "0.995"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Error", " ", 
        RowBox[{"fraction", "/", "ratio"}], " ", "of", " ", "two"}], "-", 
       RowBox[{"qubit", " ", "gates", " ", 
        RowBox[{"{", 
         RowBox[{"depolarising", ",", " ", "dephasing"}], "}"}], " ", "which",
         " ", "is", " ", "is", " ", "either", " ", "one", " ", "or", " ", 
        "zero"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"EFTwo", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "frequency", " ", "of", " ", "driving", " ", "qubit", " ", 
       "gates"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"TwoGateFreq", "->", "10"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.863454326576664*^9, 3.86345445086904*^9}, {
   3.863454537922344*^9, 3.863454759471093*^9}, {3.8634548456673307`*^9, 
   3.863454893238694*^9}, {3.8634550060872517`*^9, 3.863455068944643*^9}, {
   3.863455133571136*^9, 3.863455227330941*^9}, 3.863455467661772*^9, {
   3.863457164835682*^9, 3.863457167999679*^9}, {3.863466625653171*^9, 
   3.863466626534453*^9}, {3.863466656717869*^9, 3.863466703168454*^9}, {
   3.8634973211659327`*^9, 3.8634973254412003`*^9}, {3.86349739810318*^9, 
   3.863497405046731*^9}, {3.863497468564005*^9, 3.8634974835231323`*^9}, {
   3.863497865402828*^9, 3.863497937969355*^9}, {3.863498036048129*^9, 
   3.863498049295327*^9}, {3.8635054303559723`*^9, 3.863505433213793*^9}, {
   3.86350550349166*^9, 3.86350553320689*^9}, {3.8635055942440557`*^9, 
   3.863505686303484*^9}, {3.863506291528799*^9, 3.8635062968553467`*^9}, {
   3.863507204742934*^9, 3.863507205398917*^9}, {3.863507542638804*^9, 
   3.863507557917809*^9}, {3.863507943529126*^9, 3.863507976755619*^9}, {
   3.863508044958579*^9, 3.863508077212262*^9}, {3.86350890518664*^9, 
   3.863508920135289*^9}, {3.863508966728973*^9, 3.863509008780376*^9}, {
   3.86350916806068*^9, 3.8635091910245733`*^9}, {3.863509252645124*^9, 
   3.863509294736676*^9}, {3.8635093606291122`*^9, 3.8635093818916273`*^9}, {
   3.8635094652267933`*^9, 3.8635094801530046`*^9}, {3.863509592159338*^9, 
   3.8635096225429373`*^9}, {3.8635122825187902`*^9, 3.863512284570554*^9}, {
   3.863516612474678*^9, 3.8635166674884863`*^9}, {3.8635167208981028`*^9, 
   3.8635167625815563`*^9}, {3.863516823329026*^9, 3.8635169241870117`*^9}, {
   3.863516997922885*^9, 3.863517000491891*^9}, {3.863517045192436*^9, 
   3.863517066165266*^9}, 3.863517275598391*^9, {3.863517980140644*^9, 
   3.8635180038636103`*^9}, {3.863545141306963*^9, 3.863545144601259*^9}, {
   3.8635454117536716`*^9, 3.8635454140819263`*^9}, 3.863547338032958*^9, {
   3.863687152768737*^9, 3.863687173097149*^9}, {3.863688838935486*^9, 
   3.863688840892613*^9}, {3.863689282911751*^9, 3.863689315823909*^9}, {
   3.863689387898333*^9, 3.8636894121330137`*^9}, {3.863689578759942*^9, 
   3.863689581331337*^9}, 3.8636919098766613`*^9, {3.863692067181011*^9, 
   3.863692077649724*^9}, {3.863692162508729*^9, 3.863692200222268*^9}, {
   3.8636932798622427`*^9, 3.86369328878601*^9}, {3.863693614307301*^9, 
   3.8636936252782173`*^9}, {3.8636983827134*^9, 3.863698383179586*^9}, {
   3.8636984439189243`*^9, 3.863698452578929*^9}, {3.863698548560186*^9, 
   3.863698566835609*^9}, {3.863698868775147*^9, 3.8636988713380957`*^9}, {
   3.863700237685199*^9, 3.8637002389417953`*^9}, {3.8637034550869093`*^9, 
   3.8637034837088337`*^9}, {3.863704291710779*^9, 3.863704301547406*^9}, {
   3.863714520229396*^9, 3.863714530328062*^9}, {3.863714865544895*^9, 
   3.863714867559564*^9}, {3.863720844655518*^9, 3.8637208466883287`*^9}, {
   3.863723030071966*^9, 3.863723046850814*^9}, {3.86372666141252*^9, 
   3.863726684924015*^9}, {3.86372989606573*^9, 3.863729920257824*^9}, {
   3.863730000866426*^9, 3.863730061449833*^9}, {3.863730142585045*^9, 
   3.863730146333034*^9}, {3.863730273549018*^9, 3.863730277915167*^9}, {
   3.864809315364197*^9, 3.864809342435961*^9}, {3.865241896577642*^9, 
   3.865241965319664*^9}, {3.865242170995185*^9, 3.8652422163818073`*^9}, {
   3.865242586418998*^9, 3.865242645945384*^9}, {3.865301523610495*^9, 
   3.865301523804263*^9}, {3.865304595713649*^9, 3.865304630418612*^9}, {
   3.865305281127989*^9, 3.865305309602809*^9}, 3.865305588921054*^9, {
   3.865305787159018*^9, 3.86530581639502*^9}, {3.865305853260783*^9, 
   3.865305867462254*^9}, {3.865310939498365*^9, 3.865310941287299*^9}, {
   3.865311194937191*^9, 3.8653111979588823`*^9}, {3.8653143900727043`*^9, 
   3.865314454237653*^9}, {3.8653154779690933`*^9, 3.865315496838056*^9}, {
   3.865318109970881*^9, 3.86531811099685*^9}, 3.865318180928546*^9, {
   3.865318743182887*^9, 3.86531874745192*^9}, 3.865318833112453*^9, {
   3.865326490592826*^9, 3.865326494629116*^9}, {3.8653354448526373`*^9, 
   3.86533546437783*^9}, {3.8653355083434153`*^9, 3.86533557048916*^9}, {
   3.8653364322479973`*^9, 3.8653364655979757`*^9}, {3.865341484936504*^9, 
   3.8653414878495913`*^9}, 3.8653416195005007`*^9, {3.865345851123419*^9, 
   3.865345858317955*^9}, {3.865346113550395*^9, 3.865346190009326*^9}, {
   3.8653470773484173`*^9, 3.865347081495287*^9}, {3.8656707470014057`*^9, 
   3.865670796318157*^9}, {3.8656790007660303`*^9, 3.865679001323718*^9}, 
   3.8656843989423237`*^9, 3.8666160769098997`*^9, {3.866616114160323*^9, 
   3.8666162015449247`*^9}, {3.866619375120623*^9, 3.8666194336431723`*^9}, 
   3.866621122381987*^9, {3.866621590627623*^9, 3.86662159691364*^9}, {
   3.866621655249542*^9, 3.866621666883637*^9}, 3.8666222144323053`*^9, {
   3.866636067324276*^9, 3.8666360678426657`*^9}, {3.8668803882353*^9, 
   3.8668804426595716`*^9}, {3.866886228025002*^9, 3.866886228632259*^9}, {
   3.866886331468575*^9, 3.866886354812584*^9}, {3.866886483413403*^9, 
   3.866886483701168*^9}, {3.866890866868362*^9, 3.866890889128701*^9}, {
   3.86707189088066*^9, 3.867071901570595*^9}, {3.8670738873681097`*^9, 
   3.8670738876101637`*^9}, {3.867074295673387*^9, 3.867074305041202*^9}, 
   3.867078025094675*^9, 3.867081305646978*^9, {3.8670826214818277`*^9, 
   3.867082622779291*^9}, {3.867086220820739*^9, 3.867086273052486*^9}, 
   3.8670865841642027`*^9, {3.8670867191588707`*^9, 3.867086806160844*^9}, {
   3.8670869054397783`*^9, 3.867087010207574*^9}, {3.8670874390882807`*^9, 
   3.867087442064454*^9}, {3.86708800649929*^9, 3.867088006932907*^9}, {
   3.867090304711514*^9, 3.867090305162479*^9}, {3.8672286096262703`*^9, 
   3.86722864276227*^9}, {3.867389960250317*^9, 3.867389961480669*^9}, {
   3.867401335686801*^9, 3.867401336230983*^9}, {3.8677540734954567`*^9, 
   3.867754074642458*^9}, {3.867830195310774*^9, 3.8678302810795507`*^9}, {
   3.867830430817397*^9, 3.8678304360372353`*^9}, {3.86783062016473*^9, 
   3.8678306224016113`*^9}, {3.8678307198952303`*^9, 
   3.8678307226975737`*^9}, {3.8678311109554157`*^9, 3.867831118485732*^9}, {
   3.867831426795176*^9, 3.867831431991856*^9}, {3.867832315373279*^9, 
   3.8678323204096947`*^9}, {3.868007902693049*^9, 3.868007907485073*^9}, {
   3.868008287158381*^9, 3.868008291558558*^9}, 3.868009148893956*^9, {
   3.868010153313923*^9, 3.868010158310638*^9}, {3.868010220280282*^9, 
   3.868010221215962*^9}, {3.8686990739199867`*^9, 3.868699074856243*^9}, {
   3.8687026944517927`*^9, 3.868702785299205*^9}, {3.868702838140484*^9, 
   3.8687028789755983`*^9}, 3.868703300879455*^9, {3.868703570663795*^9, 
   3.8687035715609903`*^9}, {3.868704256331715*^9, 3.8687043596828947`*^9}, {
   3.868857145338335*^9, 3.868857148024179*^9}, {3.8688572814112377`*^9, 
   3.868857283203155*^9}, {3.868857621341179*^9, 3.868857633611974*^9}, {
   3.86894780018863*^9, 3.8689478074058237`*^9}, {3.868949517980275*^9, 
   3.868949518304879*^9}, {3.869159967588525*^9, 3.869159979040751*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"3bda493b-5873-44c4-94ab-5aee082b7221"],

Cell[TextData[{
 StyleBox["Native gates: ",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Rx", "j"], "[", "\[Theta]", "]"}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"03fc2044-273f-4d02-bd99-0d1d7831b37a"],
 StyleBox[",",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"  ", 
    RowBox[{
     SubscriptBox["Ry", "j"], "[", "\[Theta]", "]"}]}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"b10e8391-a52e-4413-95de-434b29129ff5"],
 StyleBox[", ",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "i"], "[", 
    SubscriptBox["Z", 
     RowBox[{"i", "+", "1"}]], "]"}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"b4cd6076-d36b-43f7-84fb-f8cf6a247fbe"],
 StyleBox[",Meas, Init,  ",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Wait", 
     RowBox[{"-", "1"}]], "[", "\[CapitalDelta]t", "]"}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"842aecc7-817d-492a-957a-70bd8511a971"],
 StyleBox[" ",
  FontSize->16,
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.863725890751071*^9, 3.863725945595072*^9}, {
   3.8637260039392443`*^9, 3.863726046906814*^9}, {3.8637262183462543`*^9, 
   3.8637262630355453`*^9}, {3.863730154282933*^9, 3.86373022574188*^9}, {
   3.8653435696419897`*^9, 3.865343570428134*^9}, {3.8653459282893667`*^9, 
   3.86534594832773*^9}, {3.865419987035368*^9, 3.865420017385858*^9}, {
   3.865662176892826*^9, 3.865662180588489*^9}, 3.86714158011434*^9, {
   3.8671425304046297`*^9, 3.867142547051798*^9}},
 FontSize->24,
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1c2e6c9a-f492-42f8-a0b3-7ef1a2c7be3d"],

Cell[CellGroupData[{

Cell["Compilation : QFT", "Section",
 CellChangeTimes->{{3.867917942663125*^9, 
  3.867917955512952*^9}},ExpressionUUID->"8a2946a7-0828-4f58-8e9a-\
e7452895485c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QFT", "[", 
   RowBox[{"nqubit_", ",", 
    RowBox[{"swap_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"swap", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           SubscriptBox["SWAP", 
            RowBox[{"i", ",", 
             RowBox[{"nqubit", "-", "i", "-", "1"}]}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{
              RowBox[{"IntegerPart", "[", 
               FractionBox["nqubit", "2"], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        SubscriptBox["H", "0"], "}"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["C", "m"], "[", 
            RowBox[{
             SubscriptBox["Ph", "i"], "[", 
             RowBox[{"\[Pi]", " ", 
              SuperscriptBox["2", 
               RowBox[{
                RowBox[{"-", "m"}], "-", "1"}]]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          SubscriptBox["H", "i"], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nqubit", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.867918057844376*^9, 3.867918079403161*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"7223637e-e19a-451f-8ec6-4383440f8e81"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DrawCircuit", "[", 
  RowBox[{"QFT", "[", "qubitsnum", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8691257458058443`*^9, 3.869125754714542*^9}, {
  3.869159982643214*^9, 3.8691599846491947`*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"30482a1a-c0d5-44fd-953d-8b9f0c7f5788"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[
   1]], {{LineBox[{{0, 0.5}, {1, 0.5}}], LineBox[{{0, 1.5}, {1, 1.5}}], 
     LineBox[{{0, 2.5}, {1, 2.5}}], LineBox[{{0, 3.5}, {1, 3.5}}]}, {
     LineBox[{{1, 0.5}, {2, 0.5}}], LineBox[{{1, 1.5}, {2, 1.5}}], 
     LineBox[{{1, 2.5}, {2, 2.5}}], LineBox[{{1, 3.5}, {2, 3.5}}]}, {
     LineBox[{{2, 0.5}, {3, 0.5}}], LineBox[{{2, 1.5}, {3, 1.5}}], 
     LineBox[{{2, 2.5}, {3, 2.5}}], LineBox[{{2, 3.5}, {3, 3.5}}]}, {
     LineBox[{{3, 0.5}, {4, 0.5}}], LineBox[{{3, 1.5}, {4, 1.5}}], 
     LineBox[{{3, 2.5}, {4, 2.5}}], LineBox[{{3, 3.5}, {4, 3.5}}]}, {
     LineBox[{{4, 0.5}, {5, 0.5}}], LineBox[{{4, 1.5}, {5, 1.5}}], 
     LineBox[{{4, 2.5}, {5, 2.5}}], LineBox[{{4, 3.5}, {5, 3.5}}]}, {
     LineBox[{{5, 0.5}, {6, 0.5}}], LineBox[{{5, 1.5}, {6, 1.5}}], 
     LineBox[{{5, 2.5}, {6, 2.5}}], LineBox[{{5, 3.5}, {6, 3.5}}]}, {
     LineBox[{{6, 0.5}, {7, 0.5}}], LineBox[{{6, 1.5}, {7, 1.5}}], 
     LineBox[{{6, 2.5}, {7, 2.5}}], LineBox[{{6, 3.5}, {7, 3.5}}]}, {
     LineBox[{{7, 0.5}, {8, 0.5}}], LineBox[{{7, 1.5}, {8, 1.5}}], 
     LineBox[{{7, 2.5}, {8, 2.5}}], LineBox[{{7, 3.5}, {8, 3.5}}]}, {
     LineBox[{{8, 0.5}, {9, 0.5}}], LineBox[{{8, 1.5}, {9, 1.5}}], 
     LineBox[{{8, 2.5}, {9, 2.5}}], LineBox[{{8, 3.5}, {9, 3.5}}]}, {
     LineBox[{{9, 0.5}, {10, 0.5}}], LineBox[{{9, 1.5}, {10, 1.5}}], 
     LineBox[{{9, 2.5}, {10, 2.5}}], LineBox[{{9, 3.5}, {10, 3.5}}]}}, {{
     RectangleBox[{0.1, 0.1}, {0.9, 0.9}], 
     InsetBox["\<\"H\"\>", {0.5, 0.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{1.5, 0.5}, 0.1], DiskBox[{1.5, 1.5}, 0.1]}, 
      LineBox[{{1.5, 0.5}, {1.5, 1.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {1.75, 0.75}]}, {
     RectangleBox[{2.1, 1.1}, {2.9, 1.9}], 
     InsetBox["\<\"H\"\>", {2.5, 1.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{3.5, 0.5}, 0.1], DiskBox[{3.5, 2.5}, 0.1]}, 
      LineBox[{{3.5, 0.5}, {3.5, 2.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {3.75, 0.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{4.5, 1.5}, 0.1], DiskBox[{4.5, 2.5}, 0.1]}, 
      LineBox[{{4.5, 1.5}, {4.5, 2.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {4.75, 1.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{5.5, 0.5}, 0.1], DiskBox[{5.5, 3.5}, 0.1]}, 
      LineBox[{{5.5, 0.5}, {5.5, 3.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {5.75, 0.75}]}, {
     RectangleBox[{6.1, 2.1}, {6.9, 2.9}], 
     InsetBox["\<\"H\"\>", {6.5, 2.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{7.5, 1.5}, 0.1], DiskBox[{7.5, 3.5}, 0.1]}, 
      LineBox[{{7.5, 1.5}, {7.5, 3.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {7.75, 1.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{8.5, 2.5}, 0.1], DiskBox[{8.5, 3.5}, 0.1]}, 
      LineBox[{{8.5, 2.5}, {8.5, 3.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {8.75, 2.75}]}, {
     RectangleBox[{9.1, 3.1}, {9.9, 3.9}], 
     InsetBox["\<\"H\"\>", {9.5, 3.5}]}}},
  ImageSize->330,
  PlotRangePadding->None]], "Output",
 CellChangeTimes->{3.8691257557244577`*^9, 3.869150654083363*^9, 
  3.869158283219563*^9, 3.869159984981099*^9, 3.870751724582417*^9, 
  3.870751880202739*^9, 3.870752283931679*^9, 3.870752494215638*^9, 
  3.8709271012649517`*^9, 3.870927320607119*^9, 3.870927391680105*^9, 
  3.870943340807973*^9, 3.8709435453605633`*^9, 3.870943967470265*^9, 
  3.870944291507901*^9, 3.870944671024472*^9, 3.8709447052236032`*^9, 
  3.870945026372467*^9, 3.8709465732551317`*^9, 3.870946622136319*^9, 
  3.870947214029455*^9, 3.87094821489672*^9, 3.8709483038386297`*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"ec82aa8e-a001-4d58-af0f-dc374d68b230"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"unitary", "=", 
   RowBox[{"CalcCircuitMatrix", "@", 
    RowBox[{"QFT", "@", "qubitsnum"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dev", "=", 
   RowBox[{"ToyDevice", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868527143580469*^9, 3.868527206906705*^9}, {
   3.868527309004236*^9, 3.868527311310334*^9}, {3.8685274200503893`*^9, 
   3.868527422414784*^9}, {3.868857691356863*^9, 3.868857695864408*^9}, 
   3.8689471260266743`*^9, {3.868956545122559*^9, 3.868956575183311*^9}, 
   3.869125367237299*^9, {3.869159988480816*^9, 3.869159990210507*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"81762d45-6b99-4765-91ac-2d54dfe2ab26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DestroyAllQuregs", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conf", "=", 
   RowBox[{"DefaultConfig", "[", 
    RowBox[{"dev", ",", "unitary", ",", "4"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8709270903824997`*^9, 3.870927090567156*^9}, {
  3.870927573074489*^9, 3.870927611284567*^9}, {3.870927653882328*^9, 
  3.870927654199522*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"950ea4f9-e559-45c0-a202-d24a85371411"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"varMeanInitStates", "[", "conf", "]"}]], "Input",
 CellChangeTimes->{{3.8709485169354467`*^9, 3.87094852185151*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"713351c6-e45b-457e-b90e-741d1b67b5ca"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.31892504098485247`", ",", "0.1689868707165522`"}], "}"}]}], 
   ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.07777554288364442`", ",", "0.03629421042507368`"}], "}"}]}], 
   ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.13938589182160885`", ",", "0.0352532793382548`"}], "}"}]}], 
   ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.3983670298108712`", ",", "0.0698440542881606`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.870948522347826*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"23bded0b-8843-4e38-b9bf-90cbb7443c5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"CircuitSynthesis", "[", 
    RowBox[{"qubitsnum", ",", "conf"}], "]"}], "//", "First"}], 
  "]"}]], "Input",
 CellLabel->
  "In[265]:=",ExpressionUUID->"94be4b3a-03e5-4c13-b275-b38aee0a83f4"],

Cell[BoxData["\<\"Compilation with automatically generated ansatz\"\>"], \
"Print",
 CellChangeTimes->{
  3.870923141316547*^9, 3.870923239347958*^9, {3.870923303028798*^9, 
   3.870923383796466*^9}, {3.870926625582335*^9, 3.8709266540474443`*^9}, {
   3.870926733342712*^9, 3.87092674517659*^9}, 3.870926838505267*^9, 
   3.870926872932427*^9, 3.870926931072583*^9, 3.8709271013924437`*^9, 
   3.870927320720234*^9, 3.870927391792158*^9, 3.870927492703068*^9, {
   3.870927526181198*^9, 3.870927563822043*^9}, 3.870927615990305*^9, 
   3.8709277648099194`*^9, 3.870927818668151*^9, 3.870933701261875*^9, {
   3.870934029629675*^9, 3.87093405786287*^9}, 3.8709422581530952`*^9, 
   3.8709423461041317`*^9, 3.8709424554855547`*^9, 3.8709432071979322`*^9, 
   3.8709433409637947`*^9, 3.870943545497612*^9, 3.870943618076694*^9, 
   3.870943967632415*^9, 3.8709442917177057`*^9, 3.8709446712295303`*^9, 
   3.8709447052783747`*^9, 3.870945026428162*^9, 3.870946573436946*^9, 
   3.870946622241691*^9, 3.870947100197527*^9, 3.870947214096621*^9, 
   3.870948215110339*^9, 3.870948303912608*^9, 3.8709485260827713`*^9},
 CellLabel->
  "During evaluation of \
In[265]:=",ExpressionUUID->"2bddc6ef-452f-48a6-a736-134644105fd5"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.870923148391027*^9, 3.8709232406570044`*^9, {3.87092330378059*^9, 
   3.870923384581388*^9}, {3.870926626329988*^9, 3.870926654898532*^9}, {
   3.870926734176978*^9, 3.870926745961588*^9}, 3.870926846195978*^9, {
   3.870926926303928*^9, 3.87092694405965*^9}, 3.870927126006261*^9, 
   3.870927371809372*^9, {3.870927476025082*^9, 3.870927498033739*^9}, {
   3.870927529234931*^9, 3.8709275649741287`*^9}, 3.870927625581468*^9, 
   3.870927770275487*^9, 3.870927942394796*^9, 3.870933711608801*^9, {
   3.870934040307413*^9, 3.870934063533699*^9}, 3.870942264462281*^9, 
   3.870942379085453*^9, 3.870942955974907*^9, 3.870943266080495*^9, 
   3.870943362018243*^9, 3.8709435498637323`*^9, 3.8709436197202463`*^9, 
   3.87094397189351*^9, 3.87094430764023*^9, 3.870944675149981*^9, 
   3.870944962886343*^9, 3.8709450628003283`*^9, 3.870946577360285*^9, 
   3.8709466374525948`*^9, 3.870947136594611*^9, 3.8709472407979383`*^9, 
   3.870948243565974*^9, 3.870948434532419*^9, 3.870948537371335*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"80da269f-4a9e-4c40-b311-aaa98468bd9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"conf", "[", "\"\<usecorr\>\"", "]"}]], "Input",
 CellLabel->
  "In[573]:=",ExpressionUUID->"ae7a041e-61e0-4e6e-8f94-8c03ebd5c670"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.870947263293831*^9},
 CellLabel->
  "Out[573]=",ExpressionUUID->"01f0e47e-fb3e-41c3-9cd1-6c06c68faf82"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1296., 794.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.8 Inherited,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e95e7187-87a6-4583-aff0-c5729e46fb72"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 645, 10, 117, "Title",ExpressionUUID->"abee3c70-2cd9-4715-9efd-c85791f2af36"],
Cell[CellGroupData[{
Cell[1250, 36, 249, 4, 82, "Chapter",ExpressionUUID->"15a258ee-e7ec-417a-b517-50e93cc27c2b"],
Cell[1502, 42, 244, 4, 60, "Text",ExpressionUUID->"829ac279-643d-41d9-9158-11ee57dfc634"],
Cell[1749, 48, 326, 7, 35, "Input",ExpressionUUID->"a11c428d-b472-4d42-a296-b2fe5a4aef48"],
Cell[CellGroupData[{
Cell[2100, 59, 868, 21, 35, "Input",ExpressionUUID->"f9fb01b6-1b1b-458a-a9b0-7eb0e5e5f7d5"],
Cell[2971, 82, 4673, 76, 71, "Output",ExpressionUUID->"1127a691-deac-49fe-9472-db1838dc5b36"]
}, Open  ]],
Cell[7659, 161, 10333, 171, 555, "Input",ExpressionUUID->"3bda493b-5873-44c4-94ab-5aee082b7221"],
Cell[17995, 334, 1834, 54, 64, "Text",ExpressionUUID->"1c2e6c9a-f492-42f8-a0b3-7ef1a2c7be3d"],
Cell[CellGroupData[{
Cell[19854, 392, 162, 3, 80, "Section",ExpressionUUID->"8a2946a7-0828-4f58-8e9a-e7452895485c"],
Cell[20019, 397, 1736, 51, 115, "Input",ExpressionUUID->"7223637e-e19a-451f-8ec6-4383440f8e81"],
Cell[CellGroupData[{
Cell[21780, 452, 304, 6, 35, "Input",ExpressionUUID->"30482a1a-c0d5-44fd-953d-8b9f0c7f5788"],
Cell[22087, 460, 3632, 66, 171, "Output",ExpressionUUID->"ec82aa8e-a001-4d58-af0f-dc374d68b230"]
}, Open  ]],
Cell[25734, 529, 695, 14, 61, "Input",ExpressionUUID->"81762d45-6b99-4765-91ac-2d54dfe2ab26"],
Cell[26432, 545, 488, 11, 61, "Input",ExpressionUUID->"950ea4f9-e559-45c0-a202-d24a85371411"],
Cell[CellGroupData[{
Cell[26945, 560, 223, 4, 35, "Input",ExpressionUUID->"713351c6-e45b-457e-b90e-741d1b67b5ca"],
Cell[27171, 566, 740, 21, 40, "Output",ExpressionUUID->"23bded0b-8843-4e38-b9bf-90cbb7443c5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27948, 592, 253, 7, 35, "Input",ExpressionUUID->"94be4b3a-03e5-4c13-b275-b38aee0a83f4"],
Cell[28204, 601, 1220, 19, 27, "Print",ExpressionUUID->"2bddc6ef-452f-48a6-a736-134644105fd5"],
Cell[29427, 622, 1141, 17, 40, "Output",ExpressionUUID->"80da269f-4a9e-4c40-b311-aaa98468bd9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30605, 644, 154, 3, 35, "Input",ExpressionUUID->"ae7a041e-61e0-4e6e-8f94-8c03ebd5c670"],
Cell[30762, 649, 156, 3, 40, "Output",ExpressionUUID->"01f0e47e-fb3e-41c3-9cd1-6c06c68faf82"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)


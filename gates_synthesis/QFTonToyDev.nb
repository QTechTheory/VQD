(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90671,       1973]
NotebookOptionsPosition[     86335,       1893]
NotebookOutlinePosition[     86804,       1911]
CellTagsIndexPosition[     86761,       1908]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["QFT compilation", "Title",
 CellChangeTimes->{{3.8250058175043*^9, 3.825005854301442*^9}, {
  3.825006152419363*^9, 3.825006172060075*^9}, {3.825680827842572*^9, 
  3.8256808389487886`*^9}, {3.825701169183799*^9, 3.825701169340406*^9}, {
  3.826958311226933*^9, 3.826958327332601*^9}, {3.842502300665689*^9, 
  3.842502301878525*^9}, {3.8527993524910507`*^9, 3.852799360462612*^9}, {
  3.863432931373426*^9, 3.8634329616989822`*^9}, {3.868699024409354*^9, 
  3.868699027187418*^9}, {3.8686990665437183`*^9, 3.868699069668198*^9}, {
  3.868857053844982*^9, 
  3.868857066254548*^9}},ExpressionUUID->"abee3c70-2cd9-4715-9efd-\
c85791f2af36"],

Cell[CellGroupData[{

Cell["Toy device", "Chapter",
 CellChangeTimes->{{3.863449622964633*^9, 3.863449640468264*^9}, {
  3.868702687223363*^9, 3.868702689142354*^9}, {3.868857079463719*^9, 
  3.86885708128574*^9}},ExpressionUUID->"15a258ee-e7ec-417a-b517-\
50e93cc27c2b"],

Cell["Connectivity ", "Text",
 CellChangeTimes->{{3.8635059243554497`*^9, 3.863505939276258*^9}, {
  3.8688570976355124`*^9, 3.868857101970723*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"829ac279-643d-41d9-9158-11ee57dfc634"],

Cell[BoxData[
 RowBox[{
  RowBox[{"qubitsnum", "=", "6"}], ";"}]], "Input",
 CellChangeTimes->{{3.868701528515696*^9, 3.868701533647602*^9}, {
  3.869159972995378*^9, 3.8691599733452806`*^9}},
 CellLabel->
  "In[5178]:=",ExpressionUUID->"a11c428d-b472-4d42-a296-b2fe5a4aef48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"qubitsnum", "-", "1"}]}], "]"}], ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"j", "\[UndirectedEdge]", 
      RowBox[{"j", "+", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"qubitsnum", "-", "2"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"VertexLabels", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{"Automatic", ",", "Center"}], "]"}]}], ",", 
   RowBox[{"VertexSize", "->", ".5"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.863505483563426*^9, 3.8635054902090187`*^9}, {
  3.863505806370343*^9, 3.863505906907765*^9}, {3.868699035081149*^9, 
  3.868699040695284*^9}, {3.8687015354471197`*^9, 3.8687015524694853`*^9}},
 CellLabel->
  "In[5179]:=",ExpressionUUID->"f9fb01b6-1b1b-458a-a9b0-7eb0e5e5f7d5"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{0, 1, 2, 3, 4, 5}, {
      Null, {{1, 2}, {2, 3}, {3, 4}, {4, 5}, {5, 6}}}, {VertexLabels -> {
         Placed[Automatic, Center]}, VertexSize -> {0.5}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.], 
        ArrowBox[{{{0., 9.797174393178826*^-16}, {1., 
         8.572527594031472*^-16}}, {{1., 8.572527594031472*^-16}, {2., 
         7.347880794884119*^-16}}, {{2., 7.347880794884119*^-16}, {3., 
         4.898587196589412*^-16}}, {{3., 4.898587196589412*^-16}, {4., 
         2.449293598294706*^-16}}, {{4., 2.449293598294706*^-16}, {5., 0.}}}, 
         0.25]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 9.797174393178826*^-16}, 0.25], 
         InsetBox["0", {0., 9.797174393178826*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{1., 8.572527594031472*^-16}, 0.25], 
         InsetBox["1", {1., 8.572527594031472*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{2., 7.347880794884119*^-16}, 0.25], 
         InsetBox["2", {2., 7.347880794884119*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{3., 4.898587196589412*^-16}, 0.25], 
         InsetBox["3", {3., 4.898587196589412*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{4., 2.449293598294706*^-16}, 0.25], 
         InsetBox["4", {4., 2.449293598294706*^-16},
          BaseStyle->"Graphics"]}, {DiskBox[{5., 0.}, 0.25], 
         InsetBox["5", {5., 0.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{244.58333333333348`, Automatic}]], "Output",
 CellChangeTimes->{{3.8672286966902933`*^9, 3.8672287137016706`*^9}, 
   3.8672287633080797`*^9, 3.867296832619426*^9, 3.86730206170811*^9, 
   3.867385362630368*^9, 3.8677216080791397`*^9, 3.867740155111438*^9, 
   3.867751159165362*^9, 3.867751464268873*^9, 3.8677543072330217`*^9, 
   3.8678289453897657`*^9, 3.8678301737210712`*^9, 3.867830438434613*^9, 
   3.8678311207762127`*^9, 3.867831436176279*^9, 3.867832323919236*^9, 
   3.8679127000123367`*^9, {3.867922855099888*^9, 3.86792288391193*^9}, {
   3.867923165395238*^9, 3.8679231938986483`*^9}, 3.868519985594151*^9, 
   3.86852027647814*^9, 3.868692564871982*^9, 3.868699041694007*^9, {
   3.868701546444068*^9, 3.86870155316722*^9}, 3.8688572781095057`*^9, 
   3.868947153626165*^9, 3.868948549636544*^9, 3.868948594447659*^9, 
   3.8689486548995037`*^9, 3.868949069046781*^9, 3.868949131642275*^9, 
   3.868949462112677*^9, 3.868949525354032*^9, 3.8689527196758833`*^9, 
   3.8689561867571697`*^9, 3.868956289455407*^9, 3.868956327421945*^9, 
   3.868956429952786*^9, 3.868957267739599*^9, 3.868966975827427*^9, {
   3.868967247101918*^9, 3.868967265136766*^9}, 3.8689673239638023`*^9, 
   3.868967424136404*^9, 3.868967746459702*^9, 3.868968006604723*^9, 
   3.868971132620616*^9, 3.868971420512353*^9, 3.868971569528208*^9, 
   3.868971679609589*^9, 3.868971796737116*^9, 3.868992162080902*^9, 
   3.868994306683622*^9, 3.869033369973422*^9, 3.8690342376852407`*^9, 
   3.869050191629937*^9, {3.8690504119282007`*^9, 3.869050450896221*^9}, 
   3.869050921224902*^9, 3.869051027855961*^9, 3.869053864950305*^9, 
   3.8690539328511047`*^9, 3.869053992631894*^9, 3.869054285013618*^9, 
   3.8690544071099253`*^9, {3.869054444163455*^9, 3.86905451460464*^9}, {
   3.86905526760845*^9, 3.869055282353483*^9}, 3.869061052780702*^9, {
   3.869061236659766*^9, 3.869061252903678*^9}, {3.869061331482931*^9, 
   3.869061360282213*^9}, 3.8690615272179317`*^9, {3.8690615703847513`*^9, 
   3.869061587889533*^9}, 3.86906170707477*^9, 3.869061750192768*^9, 
   3.8690620448221693`*^9, {3.869062118405478*^9, 3.869062124892518*^9}, {
   3.869062174176552*^9, 3.869062201825343*^9}, {3.869062272734911*^9, 
   3.869062287942178*^9}, {3.869062329039198*^9, 3.869062421594831*^9}, 
   3.8690721243366823`*^9, 3.869072181731422*^9, 3.8690752153164377`*^9, 
   3.869077075693163*^9, 3.8690775849532413`*^9, 3.8690779579315643`*^9, {
   3.869078353948028*^9, 3.869078369445347*^9}, 3.869078435689641*^9, 
   3.8690784765679483`*^9, 3.869078666786448*^9, 3.8690786978239594`*^9, {
   3.86907873402036*^9, 3.8690788021404037`*^9}, {3.869078856614025*^9, 
   3.869078881495789*^9}, 3.869119673949834*^9, 3.869120013407447*^9, 
   3.869159975226276*^9},
 CellLabel->
  "Out[5179]=",ExpressionUUID->"33ba259d-e324-4269-88d9-765edd43ee0d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ToyDevice", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"qubitsNum", "->", "qubitsnum"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"average", " ", "of", " ", "T1"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "->", 
      SuperscriptBox["10", "5"]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "T2", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"T2", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Set", " ", "the", " ", "standard", " ", "depolarising", " ", "and", 
       " ", "dephasing", " ", "passive", " ", "noise", " ", "using", " ", 
       "T1", " ", "and", " ", 
       RowBox[{"T2", "/", "T2s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"StdPassiveNoise", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fidelities", " ", "of", " ", "X"}], "-"}], ",", " ", 
       RowBox[{"Y", "-"}], ",", " ", 
       RowBox[{
        RowBox[{"and", " ", "Z"}], "-", " ", 
        RowBox[{
        "rotations", " ", "by", " ", "random", " ", "benchmarking"}]}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidSingle", "->", "0.995"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Error", " ", 
       RowBox[{"fraction", "/", "ratio"}], " ", 
       RowBox[{"{", 
        RowBox[{"depolarising", ",", " ", "dephasing"}], "}"}], " ", "sum", 
       " ", "is", " ", "either", " ", "one", " ", "or", " ", "zero"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"EFSingle", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Single", " ", "qubit", " ", "gate", " ", "frequency"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RabiFreq", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Fidelities", " ", "of", " ", "X"}], "-"}], ",", " ", 
       RowBox[{"Y", "-"}], ",", " ", 
       RowBox[{
        RowBox[{"and", " ", "Z"}], "-", " ", 
        RowBox[{
        "rotations", " ", "by", " ", "random", " ", "benchmarking"}]}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidTwo", "->", "0.995"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Error", " ", 
        RowBox[{"fraction", "/", "ratio"}], " ", "of", " ", "two"}], "-", 
       RowBox[{"qubit", " ", "gates", " ", 
        RowBox[{"{", 
         RowBox[{"depolarising", ",", " ", "dephasing"}], "}"}], " ", "which",
         " ", "is", " ", "is", " ", "either", " ", "one", " ", "or", " ", 
        "zero"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"EFTwo", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "frequency", " ", "of", " ", "driving", " ", "qubit", " ", 
       "gates"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"TwoGateFreq", "->", "10"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.863454326576664*^9, 3.86345445086904*^9}, {
   3.863454537922344*^9, 3.863454759471093*^9}, {3.8634548456673307`*^9, 
   3.863454893238694*^9}, {3.8634550060872517`*^9, 3.863455068944643*^9}, {
   3.863455133571136*^9, 3.863455227330941*^9}, 3.863455467661772*^9, {
   3.863457164835682*^9, 3.863457167999679*^9}, {3.863466625653171*^9, 
   3.863466626534453*^9}, {3.863466656717869*^9, 3.863466703168454*^9}, {
   3.8634973211659327`*^9, 3.8634973254412003`*^9}, {3.86349739810318*^9, 
   3.863497405046731*^9}, {3.863497468564005*^9, 3.8634974835231323`*^9}, {
   3.863497865402828*^9, 3.863497937969355*^9}, {3.863498036048129*^9, 
   3.863498049295327*^9}, {3.8635054303559723`*^9, 3.863505433213793*^9}, {
   3.86350550349166*^9, 3.86350553320689*^9}, {3.8635055942440557`*^9, 
   3.863505686303484*^9}, {3.863506291528799*^9, 3.8635062968553467`*^9}, {
   3.863507204742934*^9, 3.863507205398917*^9}, {3.863507542638804*^9, 
   3.863507557917809*^9}, {3.863507943529126*^9, 3.863507976755619*^9}, {
   3.863508044958579*^9, 3.863508077212262*^9}, {3.86350890518664*^9, 
   3.863508920135289*^9}, {3.863508966728973*^9, 3.863509008780376*^9}, {
   3.86350916806068*^9, 3.8635091910245733`*^9}, {3.863509252645124*^9, 
   3.863509294736676*^9}, {3.8635093606291122`*^9, 3.8635093818916273`*^9}, {
   3.8635094652267933`*^9, 3.8635094801530046`*^9}, {3.863509592159338*^9, 
   3.8635096225429373`*^9}, {3.8635122825187902`*^9, 3.863512284570554*^9}, {
   3.863516612474678*^9, 3.8635166674884863`*^9}, {3.8635167208981028`*^9, 
   3.8635167625815563`*^9}, {3.863516823329026*^9, 3.8635169241870117`*^9}, {
   3.863516997922885*^9, 3.863517000491891*^9}, {3.863517045192436*^9, 
   3.863517066165266*^9}, 3.863517275598391*^9, {3.863517980140644*^9, 
   3.8635180038636103`*^9}, {3.863545141306963*^9, 3.863545144601259*^9}, {
   3.8635454117536716`*^9, 3.8635454140819263`*^9}, 3.863547338032958*^9, {
   3.863687152768737*^9, 3.863687173097149*^9}, {3.863688838935486*^9, 
   3.863688840892613*^9}, {3.863689282911751*^9, 3.863689315823909*^9}, {
   3.863689387898333*^9, 3.8636894121330137`*^9}, {3.863689578759942*^9, 
   3.863689581331337*^9}, 3.8636919098766613`*^9, {3.863692067181011*^9, 
   3.863692077649724*^9}, {3.863692162508729*^9, 3.863692200222268*^9}, {
   3.8636932798622427`*^9, 3.86369328878601*^9}, {3.863693614307301*^9, 
   3.8636936252782173`*^9}, {3.8636983827134*^9, 3.863698383179586*^9}, {
   3.8636984439189243`*^9, 3.863698452578929*^9}, {3.863698548560186*^9, 
   3.863698566835609*^9}, {3.863698868775147*^9, 3.8636988713380957`*^9}, {
   3.863700237685199*^9, 3.8637002389417953`*^9}, {3.8637034550869093`*^9, 
   3.8637034837088337`*^9}, {3.863704291710779*^9, 3.863704301547406*^9}, {
   3.863714520229396*^9, 3.863714530328062*^9}, {3.863714865544895*^9, 
   3.863714867559564*^9}, {3.863720844655518*^9, 3.8637208466883287`*^9}, {
   3.863723030071966*^9, 3.863723046850814*^9}, {3.86372666141252*^9, 
   3.863726684924015*^9}, {3.86372989606573*^9, 3.863729920257824*^9}, {
   3.863730000866426*^9, 3.863730061449833*^9}, {3.863730142585045*^9, 
   3.863730146333034*^9}, {3.863730273549018*^9, 3.863730277915167*^9}, {
   3.864809315364197*^9, 3.864809342435961*^9}, {3.865241896577642*^9, 
   3.865241965319664*^9}, {3.865242170995185*^9, 3.8652422163818073`*^9}, {
   3.865242586418998*^9, 3.865242645945384*^9}, {3.865301523610495*^9, 
   3.865301523804263*^9}, {3.865304595713649*^9, 3.865304630418612*^9}, {
   3.865305281127989*^9, 3.865305309602809*^9}, 3.865305588921054*^9, {
   3.865305787159018*^9, 3.86530581639502*^9}, {3.865305853260783*^9, 
   3.865305867462254*^9}, {3.865310939498365*^9, 3.865310941287299*^9}, {
   3.865311194937191*^9, 3.8653111979588823`*^9}, {3.8653143900727043`*^9, 
   3.865314454237653*^9}, {3.8653154779690933`*^9, 3.865315496838056*^9}, {
   3.865318109970881*^9, 3.86531811099685*^9}, 3.865318180928546*^9, {
   3.865318743182887*^9, 3.86531874745192*^9}, 3.865318833112453*^9, {
   3.865326490592826*^9, 3.865326494629116*^9}, {3.8653354448526373`*^9, 
   3.86533546437783*^9}, {3.8653355083434153`*^9, 3.86533557048916*^9}, {
   3.8653364322479973`*^9, 3.8653364655979757`*^9}, {3.865341484936504*^9, 
   3.8653414878495913`*^9}, 3.8653416195005007`*^9, {3.865345851123419*^9, 
   3.865345858317955*^9}, {3.865346113550395*^9, 3.865346190009326*^9}, {
   3.8653470773484173`*^9, 3.865347081495287*^9}, {3.8656707470014057`*^9, 
   3.865670796318157*^9}, {3.8656790007660303`*^9, 3.865679001323718*^9}, 
   3.8656843989423237`*^9, 3.8666160769098997`*^9, {3.866616114160323*^9, 
   3.8666162015449247`*^9}, {3.866619375120623*^9, 3.8666194336431723`*^9}, 
   3.866621122381987*^9, {3.866621590627623*^9, 3.86662159691364*^9}, {
   3.866621655249542*^9, 3.866621666883637*^9}, 3.8666222144323053`*^9, {
   3.866636067324276*^9, 3.8666360678426657`*^9}, {3.8668803882353*^9, 
   3.8668804426595716`*^9}, {3.866886228025002*^9, 3.866886228632259*^9}, {
   3.866886331468575*^9, 3.866886354812584*^9}, {3.866886483413403*^9, 
   3.866886483701168*^9}, {3.866890866868362*^9, 3.866890889128701*^9}, {
   3.86707189088066*^9, 3.867071901570595*^9}, {3.8670738873681097`*^9, 
   3.8670738876101637`*^9}, {3.867074295673387*^9, 3.867074305041202*^9}, 
   3.867078025094675*^9, 3.867081305646978*^9, {3.8670826214818277`*^9, 
   3.867082622779291*^9}, {3.867086220820739*^9, 3.867086273052486*^9}, 
   3.8670865841642027`*^9, {3.8670867191588707`*^9, 3.867086806160844*^9}, {
   3.8670869054397783`*^9, 3.867087010207574*^9}, {3.8670874390882807`*^9, 
   3.867087442064454*^9}, {3.86708800649929*^9, 3.867088006932907*^9}, {
   3.867090304711514*^9, 3.867090305162479*^9}, {3.8672286096262703`*^9, 
   3.86722864276227*^9}, {3.867389960250317*^9, 3.867389961480669*^9}, {
   3.867401335686801*^9, 3.867401336230983*^9}, {3.8677540734954567`*^9, 
   3.867754074642458*^9}, {3.867830195310774*^9, 3.8678302810795507`*^9}, {
   3.867830430817397*^9, 3.8678304360372353`*^9}, {3.86783062016473*^9, 
   3.8678306224016113`*^9}, {3.8678307198952303`*^9, 
   3.8678307226975737`*^9}, {3.8678311109554157`*^9, 3.867831118485732*^9}, {
   3.867831426795176*^9, 3.867831431991856*^9}, {3.867832315373279*^9, 
   3.8678323204096947`*^9}, {3.868007902693049*^9, 3.868007907485073*^9}, {
   3.868008287158381*^9, 3.868008291558558*^9}, 3.868009148893956*^9, {
   3.868010153313923*^9, 3.868010158310638*^9}, {3.868010220280282*^9, 
   3.868010221215962*^9}, {3.8686990739199867`*^9, 3.868699074856243*^9}, {
   3.8687026944517927`*^9, 3.868702785299205*^9}, {3.868702838140484*^9, 
   3.8687028789755983`*^9}, 3.868703300879455*^9, {3.868703570663795*^9, 
   3.8687035715609903`*^9}, {3.868704256331715*^9, 3.8687043596828947`*^9}, {
   3.868857145338335*^9, 3.868857148024179*^9}, {3.8688572814112377`*^9, 
   3.868857283203155*^9}, {3.868857621341179*^9, 3.868857633611974*^9}, {
   3.86894780018863*^9, 3.8689478074058237`*^9}, {3.868949517980275*^9, 
   3.868949518304879*^9}, {3.869159967588525*^9, 3.869159979040751*^9}},
 CellLabel->
  "In[5180]:=",ExpressionUUID->"3bda493b-5873-44c4-94ab-5aee082b7221"],

Cell[TextData[{
 StyleBox["Native gates: ",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Rx", "j"], "[", "\[Theta]", "]"}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"03fc2044-273f-4d02-bd99-0d1d7831b37a"],
 StyleBox[",",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"  ", 
    RowBox[{
     SubscriptBox["Ry", "j"], "[", "\[Theta]", "]"}]}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"b10e8391-a52e-4413-95de-434b29129ff5"],
 StyleBox[", ",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "i"], "[", 
    SubscriptBox["Z", 
     RowBox[{"i", "+", "1"}]], "]"}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"b4cd6076-d36b-43f7-84fb-f8cf6a247fbe"],
 StyleBox[",Meas, Init,  ",
  FontSize->16,
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Wait", 
     RowBox[{"-", "1"}]], "[", "\[CapitalDelta]t", "]"}], TraditionalForm]],
  FontSize->16,
  FontWeight->"Bold",ExpressionUUID->"842aecc7-817d-492a-957a-70bd8511a971"],
 StyleBox[" ",
  FontSize->16,
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.863725890751071*^9, 3.863725945595072*^9}, {
   3.8637260039392443`*^9, 3.863726046906814*^9}, {3.8637262183462543`*^9, 
   3.8637262630355453`*^9}, {3.863730154282933*^9, 3.86373022574188*^9}, {
   3.8653435696419897`*^9, 3.865343570428134*^9}, {3.8653459282893667`*^9, 
   3.86534594832773*^9}, {3.865419987035368*^9, 3.865420017385858*^9}, {
   3.865662176892826*^9, 3.865662180588489*^9}, 3.86714158011434*^9, {
   3.8671425304046297`*^9, 3.867142547051798*^9}},
 FontSize->24,
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1c2e6c9a-f492-42f8-a0b3-7ef1a2c7be3d"],

Cell[CellGroupData[{

Cell["Compilation : QFT", "Section",
 CellChangeTimes->{{3.867917942663125*^9, 
  3.867917955512952*^9}},ExpressionUUID->"8a2946a7-0828-4f58-8e9a-\
e7452895485c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QFT", "[", 
   RowBox[{"nqubit_", ",", 
    RowBox[{"swap_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"swap", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           SubscriptBox["SWAP", 
            RowBox[{"i", ",", 
             RowBox[{"nqubit", "-", "i", "-", "1"}]}]], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{
              RowBox[{"IntegerPart", "[", 
               FractionBox["nqubit", "2"], "]"}], "-", "1"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        SubscriptBox["H", "0"], "}"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["C", "m"], "[", 
            RowBox[{
             SubscriptBox["Ph", "i"], "[", 
             RowBox[{"\[Pi]", " ", 
              SuperscriptBox["2", 
               RowBox[{
                RowBox[{"-", "m"}], "-", "1"}]]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "0", ",", 
             RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          SubscriptBox["H", "i"], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nqubit", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.867918057844376*^9, 3.867918079403161*^9}},
 CellLabel->
  "In[5181]:=",ExpressionUUID->"7223637e-e19a-451f-8ec6-4383440f8e81"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DrawCircuit", "[", 
  RowBox[{"QFT", "[", "qubitsnum", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8691257458058443`*^9, 3.869125754714542*^9}, {
  3.869159982643214*^9, 3.8691599846491947`*^9}},
 CellLabel->
  "In[5182]:=",ExpressionUUID->"30482a1a-c0d5-44fd-953d-8b9f0c7f5788"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[
   1]], {{LineBox[{{0, 0.5}, {1, 0.5}}], LineBox[{{0, 1.5}, {1, 1.5}}], 
     LineBox[{{0, 2.5}, {1, 2.5}}], LineBox[{{0, 3.5}, {1, 3.5}}], 
     LineBox[{{0, 4.5}, {1, 4.5}}], LineBox[{{0, 5.5}, {1, 5.5}}]}, {
     LineBox[{{1, 0.5}, {2, 0.5}}], LineBox[{{1, 1.5}, {2, 1.5}}], 
     LineBox[{{1, 2.5}, {2, 2.5}}], LineBox[{{1, 3.5}, {2, 3.5}}], 
     LineBox[{{1, 4.5}, {2, 4.5}}], LineBox[{{1, 5.5}, {2, 5.5}}]}, {
     LineBox[{{2, 0.5}, {3, 0.5}}], LineBox[{{2, 1.5}, {3, 1.5}}], 
     LineBox[{{2, 2.5}, {3, 2.5}}], LineBox[{{2, 3.5}, {3, 3.5}}], 
     LineBox[{{2, 4.5}, {3, 4.5}}], LineBox[{{2, 5.5}, {3, 5.5}}]}, {
     LineBox[{{3, 0.5}, {4, 0.5}}], LineBox[{{3, 1.5}, {4, 1.5}}], 
     LineBox[{{3, 2.5}, {4, 2.5}}], LineBox[{{3, 3.5}, {4, 3.5}}], 
     LineBox[{{3, 4.5}, {4, 4.5}}], LineBox[{{3, 5.5}, {4, 5.5}}]}, {
     LineBox[{{4, 0.5}, {5, 0.5}}], LineBox[{{4, 1.5}, {5, 1.5}}], 
     LineBox[{{4, 2.5}, {5, 2.5}}], LineBox[{{4, 3.5}, {5, 3.5}}], 
     LineBox[{{4, 4.5}, {5, 4.5}}], LineBox[{{4, 5.5}, {5, 5.5}}]}, {
     LineBox[{{5, 0.5}, {6, 0.5}}], LineBox[{{5, 1.5}, {6, 1.5}}], 
     LineBox[{{5, 2.5}, {6, 2.5}}], LineBox[{{5, 3.5}, {6, 3.5}}], 
     LineBox[{{5, 4.5}, {6, 4.5}}], LineBox[{{5, 5.5}, {6, 5.5}}]}, {
     LineBox[{{6, 0.5}, {7, 0.5}}], LineBox[{{6, 1.5}, {7, 1.5}}], 
     LineBox[{{6, 2.5}, {7, 2.5}}], LineBox[{{6, 3.5}, {7, 3.5}}], 
     LineBox[{{6, 4.5}, {7, 4.5}}], LineBox[{{6, 5.5}, {7, 5.5}}]}, {
     LineBox[{{7, 0.5}, {8, 0.5}}], LineBox[{{7, 1.5}, {8, 1.5}}], 
     LineBox[{{7, 2.5}, {8, 2.5}}], LineBox[{{7, 3.5}, {8, 3.5}}], 
     LineBox[{{7, 4.5}, {8, 4.5}}], LineBox[{{7, 5.5}, {8, 5.5}}]}, {
     LineBox[{{8, 0.5}, {9, 0.5}}], LineBox[{{8, 1.5}, {9, 1.5}}], 
     LineBox[{{8, 2.5}, {9, 2.5}}], LineBox[{{8, 3.5}, {9, 3.5}}], 
     LineBox[{{8, 4.5}, {9, 4.5}}], LineBox[{{8, 5.5}, {9, 5.5}}]}, {
     LineBox[{{9, 0.5}, {10, 0.5}}], LineBox[{{9, 1.5}, {10, 1.5}}], 
     LineBox[{{9, 2.5}, {10, 2.5}}], LineBox[{{9, 3.5}, {10, 3.5}}], 
     LineBox[{{9, 4.5}, {10, 4.5}}], LineBox[{{9, 5.5}, {10, 5.5}}]}, {
     LineBox[{{10, 0.5}, {11, 0.5}}], LineBox[{{10, 1.5}, {11, 1.5}}], 
     LineBox[{{10, 2.5}, {11, 2.5}}], LineBox[{{10, 3.5}, {11, 3.5}}], 
     LineBox[{{10, 4.5}, {11, 4.5}}], LineBox[{{10, 5.5}, {11, 5.5}}]}, {
     LineBox[{{11, 0.5}, {12, 0.5}}], LineBox[{{11, 1.5}, {12, 1.5}}], 
     LineBox[{{11, 2.5}, {12, 2.5}}], LineBox[{{11, 3.5}, {12, 3.5}}], 
     LineBox[{{11, 4.5}, {12, 4.5}}], LineBox[{{11, 5.5}, {12, 5.5}}]}, {
     LineBox[{{12, 0.5}, {13, 0.5}}], LineBox[{{12, 1.5}, {13, 1.5}}], 
     LineBox[{{12, 2.5}, {13, 2.5}}], LineBox[{{12, 3.5}, {13, 3.5}}], 
     LineBox[{{12, 4.5}, {13, 4.5}}], LineBox[{{12, 5.5}, {13, 5.5}}]}, {
     LineBox[{{13, 0.5}, {14, 0.5}}], LineBox[{{13, 1.5}, {14, 1.5}}], 
     LineBox[{{13, 2.5}, {14, 2.5}}], LineBox[{{13, 3.5}, {14, 3.5}}], 
     LineBox[{{13, 4.5}, {14, 4.5}}], LineBox[{{13, 5.5}, {14, 5.5}}]}, {
     LineBox[{{14, 0.5}, {15, 0.5}}], LineBox[{{14, 1.5}, {15, 1.5}}], 
     LineBox[{{14, 2.5}, {15, 2.5}}], LineBox[{{14, 3.5}, {15, 3.5}}], 
     LineBox[{{14, 4.5}, {15, 4.5}}], LineBox[{{14, 5.5}, {15, 5.5}}]}, {
     LineBox[{{15, 0.5}, {16, 0.5}}], LineBox[{{15, 1.5}, {16, 1.5}}], 
     LineBox[{{15, 2.5}, {16, 2.5}}], LineBox[{{15, 3.5}, {16, 3.5}}], 
     LineBox[{{15, 4.5}, {16, 4.5}}], LineBox[{{15, 5.5}, {16, 5.5}}]}, {
     LineBox[{{16, 0.5}, {17, 0.5}}], LineBox[{{16, 1.5}, {17, 1.5}}], 
     LineBox[{{16, 2.5}, {17, 2.5}}], LineBox[{{16, 3.5}, {17, 3.5}}], 
     LineBox[{{16, 4.5}, {17, 4.5}}], LineBox[{{16, 5.5}, {17, 5.5}}]}, {
     LineBox[{{17, 0.5}, {18, 0.5}}], LineBox[{{17, 1.5}, {18, 1.5}}], 
     LineBox[{{17, 2.5}, {18, 2.5}}], LineBox[{{17, 3.5}, {18, 3.5}}], 
     LineBox[{{17, 4.5}, {18, 4.5}}], LineBox[{{17, 5.5}, {18, 5.5}}]}, {
     LineBox[{{18, 0.5}, {19, 0.5}}], LineBox[{{18, 1.5}, {19, 1.5}}], 
     LineBox[{{18, 2.5}, {19, 2.5}}], LineBox[{{18, 3.5}, {19, 3.5}}], 
     LineBox[{{18, 4.5}, {19, 4.5}}], LineBox[{{18, 5.5}, {19, 5.5}}]}, {
     LineBox[{{19, 0.5}, {20, 0.5}}], LineBox[{{19, 1.5}, {20, 1.5}}], 
     LineBox[{{19, 2.5}, {20, 2.5}}], LineBox[{{19, 3.5}, {20, 3.5}}], 
     LineBox[{{19, 4.5}, {20, 4.5}}], LineBox[{{19, 5.5}, {20, 5.5}}]}, {
     LineBox[{{20, 0.5}, {21, 0.5}}], LineBox[{{20, 1.5}, {21, 1.5}}], 
     LineBox[{{20, 2.5}, {21, 2.5}}], LineBox[{{20, 3.5}, {21, 3.5}}], 
     LineBox[{{20, 4.5}, {21, 4.5}}], LineBox[{{20, 5.5}, {21, 5.5}}]}}, {{
     RectangleBox[{0.1, 0.1}, {0.9, 0.9}], 
     InsetBox["\<\"H\"\>", {0.5, 0.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{1.5, 0.5}, 0.1], DiskBox[{1.5, 1.5}, 0.1]}, 
      LineBox[{{1.5, 0.5}, {1.5, 1.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {1.75, 0.75}]}, {
     RectangleBox[{2.1, 1.1}, {2.9, 1.9}], 
     InsetBox["\<\"H\"\>", {2.5, 1.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{3.5, 0.5}, 0.1], DiskBox[{3.5, 2.5}, 0.1]}, 
      LineBox[{{3.5, 0.5}, {3.5, 2.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {3.75, 0.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{4.5, 1.5}, 0.1], DiskBox[{4.5, 2.5}, 0.1]}, 
      LineBox[{{4.5, 1.5}, {4.5, 2.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {4.75, 1.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{5.5, 0.5}, 0.1], DiskBox[{5.5, 3.5}, 0.1]}, 
      LineBox[{{5.5, 0.5}, {5.5, 3.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {5.75, 0.75}]}, {
     RectangleBox[{6.1, 2.1}, {6.9, 2.9}], 
     InsetBox["\<\"H\"\>", {6.5, 2.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{7.5, 1.5}, 0.1], DiskBox[{7.5, 3.5}, 0.1]}, 
      LineBox[{{7.5, 1.5}, {7.5, 3.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {7.75, 1.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{8.5, 0.5}, 0.1], DiskBox[{8.5, 4.5}, 0.1]}, 
      LineBox[{{8.5, 0.5}, {8.5, 4.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {8.75, 0.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{9.5, 2.5}, 0.1], DiskBox[{9.5, 3.5}, 0.1]}, 
      LineBox[{{9.5, 2.5}, {9.5, 3.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {9.75, 2.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{10.5, 1.5}, 0.1], DiskBox[{10.5, 4.5}, 0.1]}, 
      LineBox[{{10.5, 1.5}, {10.5, 4.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {10.75, 1.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{11.5, 0.5}, 0.1], DiskBox[{11.5, 5.5}, 0.1]}, 
      LineBox[{{11.5, 0.5}, {11.5, 5.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {11.75, 0.75}]}, {
     RectangleBox[{12.1, 3.1}, {12.9, 3.9}], 
     InsetBox["\<\"H\"\>", {12.5, 3.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{13.5, 2.5}, 0.1], DiskBox[{13.5, 4.5}, 0.1]}, 
      LineBox[{{13.5, 2.5}, {13.5, 4.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {13.75, 2.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{14.5, 1.5}, 0.1], DiskBox[{14.5, 5.5}, 0.1]}, 
      LineBox[{{14.5, 1.5}, {14.5, 5.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {14.75, 1.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{15.5, 3.5}, 0.1], DiskBox[{15.5, 4.5}, 0.1]}, 
      LineBox[{{15.5, 3.5}, {15.5, 4.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {15.75, 3.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{16.5, 2.5}, 0.1], DiskBox[{16.5, 5.5}, 0.1]}, 
      LineBox[{{16.5, 2.5}, {16.5, 5.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {16.75, 2.75}]}, {
     RectangleBox[{17.1, 4.1}, {17.9, 4.9}], 
     InsetBox["\<\"H\"\>", {17.5, 4.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{18.5, 3.5}, 0.1], DiskBox[{18.5, 5.5}, 0.1]}, 
      LineBox[{{18.5, 3.5}, {18.5, 5.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {18.75, 3.75}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{19.5, 4.5}, 0.1], DiskBox[{19.5, 5.5}, 0.1]}, 
      LineBox[{{19.5, 4.5}, {19.5, 5.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {19.75, 4.75}]}, {
     RectangleBox[{20.1, 5.1}, {20.9, 5.9}], 
     InsetBox["\<\"H\"\>", {20.5, 5.5}]}}},
  ImageSize->660,
  PlotRangePadding->None]], "Output",
 CellChangeTimes->{3.8691257557244577`*^9, 3.869150654083363*^9, 
  3.869158283219563*^9, 3.869159984981099*^9},
 CellLabel->
  "Out[5182]=",ExpressionUUID->"8ebd290d-f22e-43ef-92fb-9722392fd4d8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"unitary", "=", 
   RowBox[{"CalcCircuitMatrix", "@", 
    RowBox[{"QFT", "@", "qubitsnum"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dev", "=", 
   RowBox[{"ToyDevice", "[", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868527143580469*^9, 3.868527206906705*^9}, {
   3.868527309004236*^9, 3.868527311310334*^9}, {3.8685274200503893`*^9, 
   3.868527422414784*^9}, {3.868857691356863*^9, 3.868857695864408*^9}, 
   3.8689471260266743`*^9, {3.868956545122559*^9, 3.868956575183311*^9}, 
   3.869125367237299*^9, {3.869159988480816*^9, 3.869159990210507*^9}},
 CellLabel->
  "In[5183]:=",ExpressionUUID->"81762d45-6b99-4765-91ac-2d54dfe2ab26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DestroyAllQuregs", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conf", "=", 
   RowBox[{"DefaultConfig", "[", 
    RowBox[{"dev", ",", "unitary", ",", "10"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.868527209013508*^9, 3.868527224433976*^9}, 
   3.86852737726013*^9, {3.868527868373602*^9, 3.86852787090902*^9}, {
   3.868947198692009*^9, 3.868947198829638*^9}, {3.869159993633972*^9, 
   3.869159994524619*^9}},
 CellLabel->
  "In[5185]:=",ExpressionUUID->"356105f1-e4ac-4b9c-9598-a08196ee3f3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"conf", "[", "\"\<fixansatz\>\"", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["Rx", "0"], "[", "\[Theta]", "]"}], ",", 
     RowBox[{
      SubscriptBox["Rz", "0"], "[", "\[Theta]", "]"}], ",", 
     RowBox[{
      SubscriptBox["C", "0"], "[", 
      RowBox[{
       SubscriptBox["Rz", "1"], "[", "\[Theta]", "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["Rz", "0"], "[", "\[Theta]", "]"}], ",", 
     RowBox[{
      SubscriptBox["C", "0"], "[", 
      RowBox[{
       SubscriptBox["Rz", "1"], "[", "\[Theta]", "]"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["Rz", "1"], "[", "\[Theta]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conf", "[", "\"\<grad\>\"", "]"}], "=", "\"\<NG\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.868608661528701*^9, 3.8686088417607107`*^9}, {
   3.868608917122403*^9, 3.868608920551703*^9}, {3.8686089803853483`*^9, 
   3.868608985725819*^9}, {3.8686122013148327`*^9, 3.868612206800045*^9}, {
   3.868612270999916*^9, 3.868612271436001*^9}, {3.868947338558213*^9, 
   3.868947359790821*^9}, {3.868947509414378*^9, 3.86894751541892*^9}, {
   3.86895660390287*^9, 3.86895662879872*^9}, {3.868956704114009*^9, 
   3.868956704353118*^9}, {3.868956775231141*^9, 3.868956791767565*^9}, {
   3.8689571827536488`*^9, 3.868957189843358*^9}, {3.8689572999280777`*^9, 
   3.868957349551551*^9}, {3.868959392396325*^9, 3.868959434020196*^9}, {
   3.868965782596249*^9, 3.8689657907498426`*^9}, {3.869053859653413*^9, 
   3.869053860709396*^9}, {3.869055265229821*^9, 3.86905526530259*^9}, {
   3.8690610500953197`*^9, 3.869061050513009*^9}, {3.869072069781864*^9, 
   3.869072069932411*^9}, 3.869073884186842*^9, {3.869078376725093*^9, 
   3.869078390005537*^9}, {3.8690785222671556`*^9, 3.8690785570546017`*^9}, {
   3.86908016266215*^9, 3.869080162799479*^9}, {3.869080266958775*^9, 
   3.8690803057280617`*^9}, {3.869080533659536*^9, 3.869080533844347*^9}, {
   3.869119670577389*^9, 3.869119681324663*^9}, {3.869125408036134*^9, 
   3.869125412064179*^9}, {3.869159998139669*^9, 3.869159998897854*^9}},
 CellLabel->
  "In[5187]:=",ExpressionUUID->"c456b507-b47d-4d96-9967-32a1c9bce31b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "=", 
  RowBox[{"QMIGraph", "[", 
   RowBox[{"0", ",", "qubitsnum"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.869125547683573*^9, 3.869125550932603*^9}, {
  3.869126252430019*^9, 3.86912626478132*^9}, {3.86912640113488*^9, 
  3.869126401216032*^9}, {3.8691440292526093`*^9, 3.86914404247342*^9}, {
  3.869150677455806*^9, 3.8691506782006702`*^9}, {3.8691600208692913`*^9, 
  3.8691600224020452`*^9}},
 CellLabel->
  "In[5223]:=",ExpressionUUID->"6a341ed6-37a8-4319-b645-1a577268082e"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{0, 1, 2, 3, 4, 5}, {Null, 
       SparseArray[
       Automatic, {6, 6}, 0, {
        1, {{0, 5, 10, 15, 20, 25, 30}, {{2}, {3}, {4}, {5}, {6}, {1}, {3}, {
          4}, {5}, {6}, {1}, {2}, {4}, {5}, {6}, {1}, {2}, {3}, {5}, {6}, {
          1}, {2}, {3}, {4}, {6}, {1}, {2}, {3}, {4}, {5}}}, Pattern}]}, {
      EdgeLabels -> {
        UndirectedEdge[0, 1] -> 0, UndirectedEdge[1, 5] -> 0, 
         UndirectedEdge[1, 4] -> 0, UndirectedEdge[3, 4] -> 
         0.03836012749005635, UndirectedEdge[2, 5] -> 0.06897263894268052, 
         UndirectedEdge[2, 4] -> 0.07183323178247061, UndirectedEdge[1, 2] -> 
         0, UndirectedEdge[0, 4] -> 0, UndirectedEdge[4, 5] -> 
         0.01567234014671208, UndirectedEdge[0, 2] -> 0, UndirectedEdge[2, 3] -> 
         0.0133180946681931, UndirectedEdge[0, 3] -> 0, UndirectedEdge[3, 5] -> 
         0.03638186040714647, UndirectedEdge[1, 3] -> 0, UndirectedEdge[0, 5] -> 
         0}, EdgeWeight -> {
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0133180946681931, 0.07183323178247061, 
         0.06897263894268052, 0.03836012749005635, 0.03638186040714647, 
         0.01567234014671208}, GraphLayout -> {"Dimension" -> 2}, 
       VertexLabels -> {
         Placed[Automatic, Center]}, VertexSize -> {Small}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           1.8369701987210297`*^-16, 1.}}, 0.04999999999999997]}, 
         InsetBox["0", {-0.43301270189221935, 0.7500000000000004}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           0.8660254037844386, 0.4999999999999993}}, 0.04999999999999997]}, 
         InsetBox["0", {-1.6653345369377348*^-16, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           0.8660254037844389, -0.5000000000000012}}, 0.04999999999999997]}, 
         InsetBox["0", {0., -2.220446049250313*^-16}, ImageScaled[{0.5, 0.5}],
          
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0", {-0.4330127018922193, -0.2499999999999996}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 
           0.5000000000000008}, {-0.8660254037844384, -0.4999999999999994}}, 
           0.04999999999999997]}, 
         InsetBox["0", {-0.8660254037844386, 6.938893903907228*^-16}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 1.}, {0.8660254037844386, 
           0.4999999999999993}}, 0.04999999999999997]}, 
         InsetBox["0", {0.4330127018922194, 0.7499999999999997}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 1.}, {
           0.8660254037844389, -0.5000000000000012}}, 0.04999999999999997]}, 
         InsetBox["0", {0.4330127018922196, 0.2499999999999994}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 1.}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0", {2.83276944882399*^-16, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 
           1.}, {-0.8660254037844384, -0.4999999999999994}}, 
           0.04999999999999997]}, 
         InsetBox["0", {-0.4330127018922191, 0.25000000000000033}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844386, 0.4999999999999993}, {
           0.8660254037844389, -0.5000000000000012}}, 0.04999999999999997]}, 
         InsetBox["0.0133180946681931`", {0.8660254037844388, -9.71445146547012*^-16},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844386, 0.4999999999999993}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0.07183323178247061`", {0.43301270189221946, -0.25000000000000033},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844386, 
           0.4999999999999993}, {-0.8660254037844384, -0.4999999999999994}}, 
           0.04999999999999997]}, 
         InsetBox["0.06897263894268052`", {1.1102230246251565*^-16, -5.551115123125783*^-17},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0.03836012749005635`", {0.43301270189221963, -0.7500000000000007},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{
           0.8660254037844389, -0.5000000000000012}, {-0.8660254037844384, \
-0.4999999999999994}}, 0.04999999999999997]}, 
         InsetBox["0.03638186040714647`", {2.7755575615628914*^-16, -0.5000000000000003},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{
           3.8285686989269494`*^-16, -1.}, {-0.8660254037844384, \
-0.4999999999999994}}, 0.04999999999999997]}, 
         InsetBox["0.01567234014671208`", {-0.433012701892219, -0.7499999999999997},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{-0.8660254037844389, 0.5000000000000008}, 
          0.04999999999999997], 
         InsetBox["0", {-0.8660254037844389, 0.5000000000000008},
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.8369701987210297*^-16, 1.}, 0.04999999999999997], 
         InsetBox["1", {1.8369701987210297*^-16, 1.},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8660254037844386, 0.4999999999999993}, 
          0.04999999999999997], 
         InsetBox["2", {0.8660254037844386, 0.4999999999999993},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8660254037844389, -0.5000000000000012}, 
          0.04999999999999997], 
         InsetBox["3", {0.8660254037844389, -0.5000000000000012},
          BaseStyle->"Graphics"]}, {
         DiskBox[{3.8285686989269494*^-16, -1.}, 0.04999999999999997], 
         InsetBox["4", {3.8285686989269494*^-16, -1.},
          BaseStyle->"Graphics"]}, {
         DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
          0.04999999999999997], 
         InsetBox["5", {-0.8660254037844384, -0.4999999999999994},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{151.6666666666669, Automatic}]], "Output",
 CellChangeTimes->{{3.86915067899927*^9, 3.869150687745429*^9}, 
   3.869158288971594*^9, {3.869160010987797*^9, 3.869160022965185*^9}, 
   3.8691601793057337`*^9},
 CellLabel->
  "Out[5223]=",ExpressionUUID->"6b7641b7-988e-4bce-984f-a0925a59c4d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "=", 
  RowBox[{"QMIGraphAvg", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QMIGraph", "[", 
      RowBox[{"#", ",", "qubitsnum"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.8691440457255993`*^9, 3.869144083653634*^9}, {
   3.869145566330977*^9, 3.869145571598695*^9}, 3.8691456247812347`*^9, {
   3.869150695723976*^9, 3.869150695891746*^9}, {3.8691581120452843`*^9, 
   3.8691581121397743`*^9}, {3.869160028183051*^9, 3.869160037899145*^9}},
 CellLabel->
  "In[5224]:=",ExpressionUUID->"7691effc-c64f-4d3b-a86e-e8ec796902ba"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{0, 1, 2, 3, 4, 5}, {
      Null, {{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {2, 3}, {2, 4}, {2, 5}, {
       2, 6}, {3, 4}, {3, 5}, {3, 6}, {4, 5}, {4, 6}, {5, 6}}}, {
      EdgeLabels -> {
        UndirectedEdge[0, 1] -> 0.0638670522415728, UndirectedEdge[1, 5] -> 
         0.08703384457815952, UndirectedEdge[1, 4] -> 0.04201303797171256, 
         UndirectedEdge[3, 4] -> 0.059830422089473735`, UndirectedEdge[2, 5] -> 
         0.07585463330378445, UndirectedEdge[2, 4] -> 0.062417229969328754`, 
         UndirectedEdge[1, 2] -> 0.07154975897714133, UndirectedEdge[0, 4] -> 
         0.06477689827949967, UndirectedEdge[4, 5] -> 0.05956795892249775, 
         UndirectedEdge[0, 2] -> 0.05212697375325157, UndirectedEdge[2, 3] -> 
         0.07163959937451236, UndirectedEdge[0, 3] -> 0.0627189743586767, 
         UndirectedEdge[3, 5] -> 0.07744948649127943, UndirectedEdge[1, 3] -> 
         0.0840958825176315, UndirectedEdge[0, 5] -> 0.06505824717147782}, 
       VertexLabels -> {
         Placed[Automatic, Center]}, VertexSize -> {Small}, 
       EdgeWeight -> {0.0638670522415728, 0.05212697375325157, 
        0.0627189743586767, 0.06477689827949967, 0.06505824717147782, 
        0.07154975897714133, 0.0840958825176315, 0.04201303797171256, 
        0.08703384457815952, 0.07163959937451236, 0.062417229969328754`, 
        0.07585463330378445, 0.059830422089473735`, 0.07744948649127943, 
        0.05956795892249775}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           1.8369701987210297`*^-16, 1.}}, 0.04999999999999997]}, 
         InsetBox["0.0638670522415728`", {-0.43301270189221935, 0.7500000000000004},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           0.8660254037844386, 0.4999999999999993}}, 0.04999999999999997]}, 
         InsetBox["0.05212697375325157`", {-1.6653345369377348*^-16, 0.5}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           0.8660254037844389, -0.5000000000000012}}, 0.04999999999999997]}, 
         InsetBox["0.0627189743586767`", {0., -2.220446049250313*^-16}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 0.5000000000000008}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0.06477689827949967`", {-0.4330127018922193, -0.2499999999999996},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844389, 
           0.5000000000000008}, {-0.8660254037844384, -0.4999999999999994}}, 
           0.04999999999999997]}, 
         InsetBox["0.06505824717147782`", {-0.8660254037844386, 6.938893903907228*^-16},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 1.}, {0.8660254037844386, 
           0.4999999999999993}}, 0.04999999999999997]}, 
         InsetBox["0.07154975897714133`", {0.4330127018922194, 0.7499999999999997},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 1.}, {
           0.8660254037844389, -0.5000000000000012}}, 0.04999999999999997]}, 
         InsetBox["0.0840958825176315`", {0.4330127018922196, 0.2499999999999994},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 1.}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0.04201303797171256`", {2.83276944882399*^-16, 0.}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 
           1.}, {-0.8660254037844384, -0.4999999999999994}}, 
           0.04999999999999997]}, 
         InsetBox["0.08703384457815952`", {-0.4330127018922191, 0.25000000000000033},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844386, 0.4999999999999993}, {
           0.8660254037844389, -0.5000000000000012}}, 0.04999999999999997]}, 
         InsetBox["0.07163959937451236`", {0.8660254037844388, -9.71445146547012*^-16},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844386, 0.4999999999999993}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0.062417229969328754`", {0.43301270189221946, -0.25000000000000033},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844386, 
           0.4999999999999993}, {-0.8660254037844384, -0.4999999999999994}}, 
           0.04999999999999997]}, 
         InsetBox["0.07585463330378445`", {1.1102230246251565*^-16, -5.551115123125783*^-17},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
           3.8285686989269494`*^-16, -1.}}, 0.04999999999999997]}, 
         InsetBox["0.059830422089473735`", {0.43301270189221963, -0.7500000000000007},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{
           0.8660254037844389, -0.5000000000000012}, {-0.8660254037844384, \
-0.4999999999999994}}, 0.04999999999999997]}, 
         InsetBox["0.07744948649127943`", {2.7755575615628914*^-16, -0.5000000000000003},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{
           3.8285686989269494`*^-16, -1.}, {-0.8660254037844384, \
-0.4999999999999994}}, 0.04999999999999997]}, 
         InsetBox["0.05956795892249775`", {-0.433012701892219, -0.7499999999999997},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{-0.8660254037844389, 0.5000000000000008}, 
          0.04999999999999997], 
         InsetBox["0", {-0.8660254037844389, 0.5000000000000008},
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.8369701987210297*^-16, 1.}, 0.04999999999999997], 
         InsetBox["1", {1.8369701987210297*^-16, 1.},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8660254037844386, 0.4999999999999993}, 
          0.04999999999999997], 
         InsetBox["2", {0.8660254037844386, 0.4999999999999993},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8660254037844389, -0.5000000000000012}, 
          0.04999999999999997], 
         InsetBox["3", {0.8660254037844389, -0.5000000000000012},
          BaseStyle->"Graphics"]}, {
         DiskBox[{3.8285686989269494*^-16, -1.}, 0.04999999999999997], 
         InsetBox["4", {3.8285686989269494*^-16, -1.},
          BaseStyle->"Graphics"]}, {
         DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
          0.04999999999999997], 
         InsetBox["5", {-0.8660254037844384, -0.4999999999999994},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.86914405049501*^9, 3.8691440924335413`*^9}, 
   3.869144162256068*^9, 3.869145493615932*^9, 3.869145572202075*^9, 
   3.869145625097267*^9, 3.869147389001919*^9, 3.86914756987113*^9, 
   3.869150696291039*^9, {3.869158109629551*^9, 3.869158112519858*^9}, 
   3.869158290965958*^9, {3.86916003028236*^9, 3.869160038988648*^9}, 
   3.869160181304521*^9},
 CellLabel->
  "Out[5224]=",ExpressionUUID->"3760da6b-6703-46ba-8763-c6ad1435d1eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "probZeros"}]], "Input",
 CellChangeTimes->{{3.869160071286764*^9, 3.869160072720366*^9}},
 CellLabel->
  "In[5193]:=",ExpressionUUID->"111ce0af-cbcc-447d-8627-cd6df2df9340"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"probZeros[nqubit_Integer, \[Rho]s_List]. \
Probability of outcome zeros on each qubit, averaged over multiple training \
sets \[Rho]. Returns association. This is used in chosing single qubit gate \
guess.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"probZeros", "[", 
                    RowBox[{"qubits_List", ",", "\[Rho]s_List"}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "prob0", "}"}], ",", 
                    RowBox[{
                    RowBox[{"prob0", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"q", "\[Rule]", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"CalcProbOfOutcome", "[", 
                    RowBox[{"\[Rho]", ",", "q", ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Rho]", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "\[Rho]s", "}"}], "]"}]}], "}"}]}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "qubits"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"#1", ",", "1"}], "]"}], "&"}]}], "]"}]}], ";", 
                    RowBox[{"Association", "[", "prob0", "]"}]}]}], 
                    "]"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"probZeros", "[", 
                    RowBox[{"nqubit_Integer", ",", "\[Rho]s_List"}], "]"}], 
                    ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "prob0", "}"}], ",", 
                    RowBox[{
                    RowBox[{"prob0", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"q", "\[Rule]", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"CalcProbOfOutcome", "[", 
                    RowBox[{"\[Rho]", ",", "q", ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Rho]", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "\[Rho]s", "}"}], "]"}]}], "}"}]}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{"nqubit", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"#1", ",", "1"}], "]"}], "&"}]}], "]"}]}], ";", 
                    RowBox[{"Association", "[", "prob0", "]"}]}]}], 
                    "]"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"probZeros", "[", 
                    RowBox[{"nqubit_", ",", "\[Rho]s_"}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "prob0", "}"}], ",", 
                    RowBox[{
                    RowBox[{"prob0", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"q", "\[Rule]", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"CalcProbOfOutcome", "[", 
                    RowBox[{"\[Rho]", ",", "q", ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Rho]", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "\[Rho]s", "}"}], "]"}]}], "}"}]}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{"nqubit", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"#1", ",", "1"}], "]"}], "&"}]}], "]"}]}], ";", 
                    RowBox[{"Association", "[", "prob0", "]"}]}]}], 
                    "]"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"probZeros", "[", 
                    RowBox[{"nqubit_", ",", "\[Rho]s__"}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "prob0", "}"}], ",", 
                    RowBox[{
                    RowBox[{"prob0", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"q", "\[Rule]", 
                    RowBox[{"Mean", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"CalcProbOfOutcome", "[", 
                    RowBox[{"\[Rho]", ",", "q", ",", "0"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Rho]", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", "\[Rho]s", "}"}], "]"}]}], "}"}]}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{"nqubit", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"Normalize", "[", 
                    RowBox[{
                    RowBox[{"prob0", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"#1", ",", "1"}], "]"}], "&"}]}], "]"}]}], ";", 
                    "prob0"}]}], "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"Global`probZeros\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"probZeros[nqubit_Integer, \[Rho]s_List]. \
Probability of outcome zeros on each qubit, averaged over multiple training \
sets \[Rho]. Returns association. This is used in chosing single qubit gate \
guess.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{15., {5., 10.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{15., {5., 10.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "probZeros[nqubit_Integer, \[Rho]s_List]. Probability of outcome zeros on \
each qubit, averaged over multiple training sets \[Rho]. Returns association. \
This is used in chosing single qubit gate guess.", "Documentation" -> None, 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, $CellContext`probZeros, {$CellContext`probZeros[
         Pattern[$CellContext`qubits, 
          Blank[List]], 
         Pattern[$CellContext`\[Rho]s, 
          Blank[List]]] :> 
       Module[{$CellContext`prob0}, $CellContext`prob0 = 
          Table[$CellContext`q -> Mean[
              Table[
               
               QuEST`CalcProbOfOutcome[$CellContext`\[Rho], $CellContext`q, 
                0], {$CellContext`\[Rho], 
                
                Flatten[{$CellContext`\[Rho]s}]}]], {$CellContext`q, \
$CellContext`qubits}]; Part[$CellContext`prob0, All, 2] = Normalize[
            Part[$CellContext`prob0, All, 2], 
            Norm[#, 1]& ]; <|$CellContext`prob0|>], $CellContext`probZeros[
         Pattern[$CellContext`nqubit, 
          Blank[Integer]], 
         Pattern[$CellContext`\[Rho]s, 
          Blank[List]]] :> 
       Module[{$CellContext`prob0}, $CellContext`prob0 = 
          Table[$CellContext`q -> Mean[
              Table[
               
               QuEST`CalcProbOfOutcome[$CellContext`\[Rho], $CellContext`q, 
                0], {$CellContext`\[Rho], 
                Flatten[{$CellContext`\[Rho]s}]}]], {$CellContext`q, 
             0, $CellContext`nqubit - 1}]; 
         Part[$CellContext`prob0, All, 2] = Normalize[
            Part[$CellContext`prob0, All, 2], 
            Norm[#, 1]& ]; <|$CellContext`prob0|>], $CellContext`probZeros[
         Pattern[$CellContext`nqubit, 
          Blank[]], 
         Pattern[$CellContext`\[Rho]s, 
          Blank[]]] :> 
       Module[{$CellContext`prob0}, $CellContext`prob0 = 
          Table[$CellContext`q -> Mean[
              Table[
               
               QuEST`CalcProbOfOutcome[$CellContext`\[Rho], $CellContext`q, 
                0], {$CellContext`\[Rho], 
                Flatten[{$CellContext`\[Rho]s}]}]], {$CellContext`q, 
             0, $CellContext`nqubit - 1}]; 
         Part[$CellContext`prob0, All, 2] = Normalize[
            Part[$CellContext`prob0, All, 2], 
            Norm[#, 1]& ]; <|$CellContext`prob0|>], $CellContext`probZeros[
         Pattern[$CellContext`nqubit, 
          Blank[]], 
         Pattern[$CellContext`\[Rho]s, 
          BlankSequence[]]] :> 
       Module[{$CellContext`prob0}, $CellContext`prob0 = 
          Table[$CellContext`q -> Mean[
              Table[
               
               QuEST`CalcProbOfOutcome[$CellContext`\[Rho], $CellContext`q, 
                0], {$CellContext`\[Rho], 
                Flatten[{$CellContext`\[Rho]s}]}]], {$CellContext`q, 
             0, $CellContext`nqubit - 1}]; 
         Part[$CellContext`prob0, All, 2] = Normalize[
            Part[$CellContext`prob0, All, 2], 
            Norm[#, 1]& ]; $CellContext`prob0]}], "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> "Global`probZeros"|>,
    False]]], "Output",
 CellChangeTimes->{3.869160073012804*^9},
 CellLabel->
  "Out[5193]=",ExpressionUUID->"9d91edf8-520d-48c6-8627-91a558525574"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "=", 
  RowBox[{"probZeros", "[", 
   RowBox[{"qubitsnum", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.869160055510373*^9, 3.86916009975984*^9}},
 CellLabel->
  "In[5194]:=",ExpressionUUID->"079b46af-a605-45b2-8f4b-e4188054a0a3"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"0", "\[Rule]", "0.15883638546021955`"}], ",", 
   RowBox[{"1", "\[Rule]", "0.14560002000520123`"}], ",", 
   RowBox[{"2", "\[Rule]", "0.19821290138800243`"}], ",", 
   RowBox[{"3", "\[Rule]", "0.1400115755885672`"}], ",", 
   RowBox[{"4", "\[Rule]", "0.19796465601059995`"}], ",", 
   RowBox[{"5", "\[Rule]", "0.15937446154740967`"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.869160100188527*^9},
 CellLabel->
  "Out[5194]=",ExpressionUUID->"9197c0dd-37ee-495c-a37b-7c8d3974d8cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"singleRGate", "[", 
  RowBox[{"conf", ",", "p"}], "]"}]], "Input",
 CellChangeTimes->{{3.869160104189623*^9, 3.8691601125164547`*^9}},
 CellLabel->
  "In[5225]:=",ExpressionUUID->"f78f27ed-12c8-4a22-8f8f-6973f44e4de5"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["Ry", "1"], "[", "\[Theta]", "]"}]], "Output",
 CellChangeTimes->{{3.869160112998129*^9, 3.869160121612893*^9}, 
   3.869160185686007*^9},
 CellLabel->
  "Out[5225]=",ExpressionUUID->"48e020fb-e220-445b-af1e-247b56ef69aa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "g", "]"}]], "Input",
 CellChangeTimes->{{3.86916016300563*^9, 3.869160166075918*^9}},
 CellLabel->
  "In[5216]:=",ExpressionUUID->"b345b397-b3e4-40bc-97de-3dd701914291"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"twoRGate", "[", 
  RowBox[{"conf", ",", "g"}], "]"}]], "Input",
 CellChangeTimes->{{3.8691601372304487`*^9, 3.869160142503243*^9}},
 CellLabel->
  "In[5277]:=",ExpressionUUID->"3d3893f3-133e-4e03-8947-68ce50bd580e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["C", "2"], "[", 
    RowBox[{
     SubscriptBox["Ry", "3"], "[", "\[Theta]", "]"}], "]"}], ",", 
   RowBox[{
    SubscriptBox["C", "3"], "[", 
    RowBox[{
     SubscriptBox["Rz", "4"], "[", "\[Theta]", "]"}], "]"}], ",", 
   RowBox[{
    SubscriptBox["C", "4"], "[", 
    RowBox[{
     SubscriptBox["Rz", "5"], "[", "\[Theta]", "]"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.869160143092248*^9, 3.869160188371385*^9, 3.869160232472889*^9, {
   3.86916029026678*^9, 3.869160299835568*^9}, {3.86916051253432*^9, 
   3.8691605139630013`*^9}},
 CellLabel->
  "Out[5277]=",ExpressionUUID->"4fb4e161-c345-44a5-8286-8253643d73a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"conf", "[", "\"\<connectivity\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.869160534322091*^9, 3.869160537690414*^9}},
 CellLabel->
  "In[5278]:=",ExpressionUUID->"7d92e7a1-419e-4557-8ce6-018c761d5224"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{0, 1, 2, 3, 4, 5}, {
      Null, {{1, 2}, {2, 3}, {3, 4}, {4, 5}, {5, 6}}}, {VertexLabels -> {
         Placed[Automatic, Center]}, VertexSize -> {Small}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[0.], 
        ArrowBox[{{{0., 9.797174393178826*^-16}, {1., 
         8.572527594031472*^-16}}, {{1., 8.572527594031472*^-16}, {2., 
         7.347880794884119*^-16}}, {{2., 7.347880794884119*^-16}, {3., 
         4.898587196589412*^-16}}, {{3., 4.898587196589412*^-16}, {4., 
         2.449293598294706*^-16}}, {{4., 2.449293598294706*^-16}, {5., 0.}}}, 
         0.05]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 9.797174393178826*^-16}, 0.05], 
         InsetBox["0", {0., 9.797174393178826*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{1., 8.572527594031472*^-16}, 0.05], 
         InsetBox["1", {1., 8.572527594031472*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{2., 7.347880794884119*^-16}, 0.05], 
         InsetBox["2", {2., 7.347880794884119*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{3., 4.898587196589412*^-16}, 0.05], 
         InsetBox["3", {3., 4.898587196589412*^-16},
          BaseStyle->"Graphics"]}, {
         DiskBox[{4., 2.449293598294706*^-16}, 0.05], 
         InsetBox["4", {4., 2.449293598294706*^-16},
          BaseStyle->"Graphics"]}, {DiskBox[{5., 0.}, 0.05], 
         InsetBox["5", {5., 0.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.869160538052438*^9},
 CellLabel->
  "Out[5278]=",ExpressionUUID->"08917856-e8c8-42c7-9640-cbd8df10be1b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"conf", "[", "\"\<grad\>\"", "]"}], "=", "\"\<SGD\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8691200292882977`*^9, 3.869120030446431*^9}},
 CellLabel->
  "In[4557]:=",ExpressionUUID->"94e3f508-510e-4e7b-92ff-3594769dc4f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"CircuitSynthesis", "[", 
    RowBox[{"3", ",", "conf"}], "]"}], "//", "First"}], "]"}]], "Input",
 CellLabel->
  "In[4558]:=",ExpressionUUID->"6025f334-4b96-4a37-a0f2-87e18d5891c7"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Compilation with a fixed ansatz\"\>"], "Print",
 CellChangeTimes->{{3.869119688672855*^9, 3.869119702095677*^9}, {
   3.8691200103416777`*^9, 3.869120032197433*^9}, 3.86912534765022*^9, 
   3.869125378250369*^9, 3.869143623871169*^9},
 CellLabel->
  "During evaluation of \
In[4558]:=",ExpressionUUID->"7574ffe6-b51a-46fd-a1b1-920e798b5271"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"0", "\[UndirectedEdge]", "1"}], "\[Rule]", 
    "0.5204189911347865`"}], ",", 
   RowBox[{
    RowBox[{"0", "\[UndirectedEdge]", "2"}], "\[Rule]", 
    "0.08287704962688369`"}], ",", 
   RowBox[{
    RowBox[{"1", "\[UndirectedEdge]", "2"}], "\[Rule]", 
    "0.31719371808007774`"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.869119688672855*^9, 3.869119702095677*^9}, {
   3.8691200103416777`*^9, 3.869120032197433*^9}, 3.86912534765022*^9, 
   3.869125378250369*^9, 3.86914362471646*^9},
 CellLabel->
  "During evaluation of \
In[4558]:=",ExpressionUUID->"31578f25-e6e5-4373-ad6d-daa18e3971cc"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{0, 1, 2}, {Null, 
       SparseArray[
       Automatic, {3, 3}, 0, {
        1, {{0, 2, 4, 6}, {{2}, {3}, {1}, {3}, {1}, {2}}}, Pattern}]}, {
      EdgeLabels -> {
        UndirectedEdge[0, 1] -> 0.5204189911347865, UndirectedEdge[1, 2] -> 
         0.31719371808007774`, UndirectedEdge[0, 2] -> 0.08287704962688369}, 
       EdgeWeight -> {0.5204189911347865, 0.08287704962688369, 
        0.31719371808007774`}, GraphLayout -> {"Dimension" -> 2}, 
       VertexLabels -> {
         Placed[Automatic, Center]}, VertexSize -> {Small}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844384, -0.4999999999999994}, {
           1.8369701987210297`*^-16, 1.}}, 0.08660254037844384]}, 
         InsetBox["0.5204189911347865`", {-0.4330127018922191, 0.25000000000000033},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{-0.8660254037844384, -0.4999999999999994}, {
           0.8660254037844389, -0.5000000000000012}}, 0.08660254037844384]}, 
         InsetBox["0.08287704962688369`", {2.7755575615628914*^-16, -0.5000000000000003},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[0.], 
          ArrowBox[{{1.8369701987210297`*^-16, 1.}, {
           0.8660254037844389, -0.5000000000000012}}, 0.08660254037844384]}, 
         InsetBox["0.31719371808007774`", {0.4330127018922196, 0.2499999999999994},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
          0.08660254037844384], 
         InsetBox["0", {-0.8660254037844384, -0.4999999999999994},
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.8369701987210297*^-16, 1.}, 0.08660254037844384], 
         InsetBox["1", {1.8369701987210297*^-16, 1.},
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.8660254037844389, -0.5000000000000012}, 
          0.08660254037844384], 
         InsetBox["2", {0.8660254037844389, -0.5000000000000012},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{122.66666666666657`, Automatic}]], "Print",
 CellChangeTimes->{{3.869119688672855*^9, 3.869119702095677*^9}, {
   3.8691200103416777`*^9, 3.869120032197433*^9}, 3.86912534765022*^9, 
   3.869125378250369*^9, 3.8691436247369127`*^9},
 CellLabel->
  "During evaluation of \
In[4558]:=",ExpressionUUID->"4d904c7a-d727-4a11-a5b8-776f285e690f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.6535399763724407`"},
    {
     GraphicsBox[
      {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[
       1]], {{LineBox[{{0, 0.5}, {1, 0.5}}], LineBox[{{0, 1.5}, {1, 1.5}}], 
         LineBox[{{0, 2.5}, {1, 2.5}}]}, {LineBox[{{1, 0.5}, {2, 0.5}}], 
         LineBox[{{1, 1.5}, {2, 1.5}}], LineBox[{{1, 2.5}, {2, 2.5}}]}, {
         LineBox[{{2, 0.5}, {3, 0.5}}], LineBox[{{2, 1.5}, {3, 1.5}}], 
         LineBox[{{2, 2.5}, {3, 2.5}}]}, {LineBox[{{3, 0.5}, {4, 0.5}}], 
         LineBox[{{3, 1.5}, {4, 1.5}}], LineBox[{{3, 2.5}, {4, 2.5}}]}, {
         LineBox[{{4, 0.5}, {5, 0.5}}], LineBox[{{4, 1.5}, {5, 1.5}}], 
         LineBox[{{4, 2.5}, {5, 2.5}}]}, {LineBox[{{5, 0.5}, {6, 0.5}}], 
         LineBox[{{5, 1.5}, {6, 1.5}}], LineBox[{{5, 2.5}, {6, 2.5}}]}}, {{
         RectangleBox[{0.1, 0.1}, {0.9, 0.9}], 
         InsetBox["\<\"Rx\"\>", {0.5, 0.5}]}, {
         RectangleBox[{1.1, 0.1}, {1.9, 0.9}], 
         InsetBox["\<\"Rz\"\>", {1.5, 0.5}]}, {
         {FaceForm[GrayLevel[0]], DiskBox[{2.5, 0.5}, 0.1], 
          LineBox[{{2.5, 0.5}, {2.5, 1.5}}]}, {
          RectangleBox[{2.1, 1.1}, {2.9, 1.9}], 
          InsetBox["\<\"Rz\"\>", {2.5, 1.5}]}}, {
         RectangleBox[{3.1, 0.1}, {3.9, 0.9}], 
         InsetBox["\<\"Rz\"\>", {3.5, 0.5}]}, {
         {FaceForm[GrayLevel[0]], DiskBox[{4.5, 0.5}, 0.1], 
          LineBox[{{4.5, 0.5}, {4.5, 1.5}}]}, {
          RectangleBox[{4.1, 1.1}, {4.9, 1.9}], 
          InsetBox["\<\"Rz\"\>", {4.5, 1.5}]}}, {
         RectangleBox[{5.1, 1.1}, {5.9, 1.9}], 
         InsetBox["\<\"Rz\"\>", {5.5, 1.5}]}}},
      ImageSize->210,
      PlotRangePadding->None]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["Rx", "0"], "[", 
        SubscriptBox["\[Theta]", "1"], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "0"], "[", 
        SubscriptBox["\[Theta]", "2"], "]"}], ",", 
       RowBox[{
        SubscriptBox["C", "0"], "[", 
        RowBox[{
         SubscriptBox["Rz", "1"], "[", 
         SubscriptBox["\[Theta]", "3"], "]"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "0"], "[", 
        SubscriptBox["\[Theta]", "4"], "]"}], ",", 
       RowBox[{
        SubscriptBox["C", "0"], "[", 
        RowBox[{
         SubscriptBox["Rz", "1"], "[", 
         SubscriptBox["\[Theta]", "5"], "]"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "1"], "[", 
        SubscriptBox["\[Theta]", "6"], "]"}]}], "}"}]},
    {
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Theta]", "1"], "\[Rule]", "1.5191368663474936`"}], 
       ",", 
       RowBox[{
        SubscriptBox["\[Theta]", "2"], "\[Rule]", "0.6977112806045211`"}], 
       ",", 
       RowBox[{
        SubscriptBox["\[Theta]", "3"], "\[Rule]", "0.5666086656309697`"}], 
       ",", 
       RowBox[{
        SubscriptBox["\[Theta]", "4"], "\[Rule]", "0.6977116760375018`"}], 
       ",", 
       RowBox[{
        SubscriptBox["\[Theta]", "5"], "\[Rule]", "0.5666084097714502`"}], 
       ",", 
       RowBox[{
        SubscriptBox["\[Theta]", "6"], "\[Rule]", "2.1873053687168316`"}]}], 
      "\[RightAssociation]"}]},
    {
     GraphicsBox[{{}, 
       {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
        0.012833333333333334`], AbsoluteThickness[1.6], 
        PointBox[{{1., 0.6847422476190563}, {2., 0.6663848712194872}, {3., 
         0.6579267566990802}, {4., 0.6553679290124607}, {5., 
         0.6540391368713883}, {6., 0.6537428641785791}, {7., 
         0.6536058693779244}, {8., 0.6535668776955547}, {9., 
         0.6535476347450169}, {10., 0.6535429589079688}, {11., 
         0.6535409111201639}, {12., 0.6535403276138537}, {13., 
         0.6535400572732323}, {14., 0.6535400572732323}, {15., 
         0.6535399763724407}}]}, {{}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0., 0.6529307080688084},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      Method->{
       "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            Identity[
             Part[#, 1]], 
            Identity[
             Part[#, 2]]}& )}},
      PlotRange->{{0., 15.}, {0.6529307080688084, 0.664506805837852}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Print",
 CellChangeTimes->{{3.869119688672855*^9, 3.869119702095677*^9}, {
   3.8691200103416777`*^9, 3.869120032197433*^9}, 3.86912534765022*^9, 
   3.869125378250369*^9, 3.869143624760262*^9},
 CellLabel->
  "During evaluation of \
In[4558]:=",ExpressionUUID->"df9910eb-d7ba-4c55-ba3d-c2d8b8fb388a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.636715`", ",", "0.6535399763724407`"}], "}"}]], "Output",
 CellChangeTimes->{{3.869119688804064*^9, 3.86911970224642*^9}, {
   3.869120010502077*^9, 3.869120033167059*^9}, 3.869125349405511*^9, 
   3.8691253802322693`*^9, 3.8691436247681837`*^9},
 CellLabel->
  "Out[4558]=",ExpressionUUID->"e264ae1c-594d-4b0a-a875-1f6f2e64f15a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1919., 1063.5},
WindowMargins->{{Automatic, 960.5}, {Automatic, 16}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1. Inherited,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e95e7187-87a6-4583-aff0-c5729e46fb72"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 645, 10, 146, "Title",ExpressionUUID->"abee3c70-2cd9-4715-9efd-c85791f2af36"],
Cell[CellGroupData[{
Cell[1250, 36, 249, 4, 102, "Chapter",ExpressionUUID->"15a258ee-e7ec-417a-b517-50e93cc27c2b"],
Cell[1502, 42, 244, 4, 76, "Text",ExpressionUUID->"829ac279-643d-41d9-9158-11ee57dfc634"],
Cell[1749, 48, 276, 6, 44, "Input",ExpressionUUID->"a11c428d-b472-4d42-a296-b2fe5a4aef48"],
Cell[CellGroupData[{
Cell[2050, 58, 869, 21, 44, "Input",ExpressionUUID->"f9fb01b6-1b1b-458a-a9b0-7eb0e5e5f7d5"],
Cell[2922, 81, 4703, 79, 92, "Output",ExpressionUUID->"33ba259d-e324-4269-88d9-765edd43ee0d"]
}, Open  ]],
Cell[7640, 163, 10334, 171, 692, "Input",ExpressionUUID->"3bda493b-5873-44c4-94ab-5aee082b7221"],
Cell[17977, 336, 1834, 54, 81, "Text",ExpressionUUID->"1c2e6c9a-f492-42f8-a0b3-7ef1a2c7be3d"],
Cell[CellGroupData[{
Cell[19836, 394, 162, 3, 100, "Section",ExpressionUUID->"8a2946a7-0828-4f58-8e9a-e7452895485c"],
Cell[20001, 399, 1737, 51, 143, "Input",ExpressionUUID->"7223637e-e19a-451f-8ec6-4383440f8e81"],
Cell[CellGroupData[{
Cell[21763, 454, 305, 6, 44, "Input",ExpressionUUID->"30482a1a-c0d5-44fd-953d-8b9f0c7f5788"],
Cell[22071, 462, 8174, 143, 321, "Output",ExpressionUUID->"8ebd290d-f22e-43ef-92fb-9722392fd4d8"]
}, Open  ]],
Cell[30260, 608, 696, 14, 76, "Input",ExpressionUUID->"81762d45-6b99-4765-91ac-2d54dfe2ab26"],
Cell[30959, 624, 560, 12, 76, "Input",ExpressionUUID->"356105f1-e4ac-4b9c-9598-a08196ee3f3b"],
Cell[31522, 638, 2245, 46, 76, "Input",ExpressionUUID->"c456b507-b47d-4d96-9967-32a1c9bce31b"],
Cell[CellGroupData[{
Cell[33792, 688, 513, 10, 44, "Input",ExpressionUUID->"6a341ed6-37a8-4319-b645-1a577268082e"],
Cell[34308, 700, 7814, 153, 269, "Output",ExpressionUUID->"6b7641b7-988e-4bce-984f-a0925a59c4d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42159, 858, 676, 15, 44, "Input",ExpressionUUID->"7691effc-c64f-4d3b-a86e-e8ec796902ba"],
Cell[42838, 875, 8380, 160, 622, "Output",ExpressionUUID->"3760da6b-6703-46ba-8763-c6ad1435d1eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51255, 1040, 202, 4, 44, "Input",ExpressionUUID->"111ce0af-cbcc-447d-8627-cd6df2df9340"],
Cell[51460, 1046, 19515, 450, 155, "Output",ExpressionUUID->"9d91edf8-520d-48c6-8627-91a558525574"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71012, 1501, 361, 9, 44, "Input",ExpressionUUID->"079b46af-a605-45b2-8f4b-e4188054a0a3"],
Cell[71376, 1512, 570, 12, 71, "Output",ExpressionUUID->"9197c0dd-37ee-495c-a37b-7c8d3974d8cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71983, 1529, 242, 5, 44, "Input",ExpressionUUID->"f78f27ed-12c8-4a22-8f8f-6973f44e4de5"],
Cell[72228, 1536, 261, 6, 71, "Output",ExpressionUUID->"48e020fb-e220-445b-af1e-247b56ef69aa"]
}, Open  ]],
Cell[72504, 1545, 207, 4, 44, "Input",ExpressionUUID->"b345b397-b3e4-40bc-97de-3dd701914291"],
Cell[CellGroupData[{
Cell[72736, 1553, 239, 5, 44, "Input",ExpressionUUID->"3d3893f3-133e-4e03-8947-68ce50bd580e"],
Cell[72978, 1560, 707, 21, 72, "Output",ExpressionUUID->"4fb4e161-c345-44a5-8286-8253643d73a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73722, 1586, 226, 4, 44, "Input",ExpressionUUID->"7d92e7a1-419e-4557-8ce6-018c761d5224"],
Cell[73951, 1592, 2004, 41, 78, "Output",ExpressionUUID->"08917856-e8c8-42c7-9640-cbd8df10be1b"]
}, Open  ]],
Cell[75970, 1636, 275, 7, 44, "Input",ExpressionUUID->"94e3f508-510e-4e7b-92ff-3594769dc4f2"],
Cell[CellGroupData[{
Cell[76270, 1647, 243, 6, 44, "Input",ExpressionUUID->"6025f334-4b96-4a37-a0f2-87e18d5891c7"],
Cell[CellGroupData[{
Cell[76538, 1657, 359, 6, 35, "Print",ExpressionUUID->"7574ffe6-b51a-46fd-a1b1-920e798b5271"],
Cell[76900, 1665, 659, 17, 35, "Print",ExpressionUUID->"31578f25-e6e5-4373-ad6d-daa18e3971cc"],
Cell[77562, 1684, 2933, 60, 174, "Print",ExpressionUUID->"4d904c7a-d727-4a11-a5b8-776f285e690f"],
Cell[80498, 1746, 5398, 131, 379, "Print",ExpressionUUID->"df9910eb-d7ba-4c55-ba3d-c2d8b8fb388a"]
}, Open  ]],
Cell[85911, 1880, 372, 7, 71, "Output",ExpressionUUID->"e264ae1c-594d-4b0a-a875-1f6f2e64f15a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)


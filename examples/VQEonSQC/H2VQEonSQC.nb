(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28952,        686]
NotebookOptionsPosition[     26160,        631]
NotebookOutlinePosition[     26782,        653]
CellTagsIndexPosition[     26739,        650]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["H2 VQE on Superconducting Qubits", "Title",
 CellChangeTimes->{{3.883715555188192*^9, 3.883715560920237*^9}, {
  3.8837156066949453`*^9, 3.8837156104111958`*^9}, {3.885457060551186*^9, 
  3.8854570648153677`*^9}, {3.885461355915464*^9, 
  3.88546135642795*^9}},ExpressionUUID->"46e2a614-73a5-4753-96e9-\
20a551b9dc09"],

Cell[TextData[StyleBox["Set environment, such as threads, gpu, etc.",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.8528844215679693`*^9, 3.8528844367050333`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1ccb639d-ecf0-4907-9136-7224a50e65c1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"SetEnvironment", "[", 
     RowBox[{"\"\<OMP_NUM_THREADS\>\"", "\[Rule]", "\"\<8\>\""}], "]"}], "\n", 
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], ";"}], "*)"}]], "Input",\

 CellChangeTimes->{3.872921462633623*^9, 3.885381853501893*^9},
 CellLabel->
  "In[978]:=",ExpressionUUID->"8a9e8263-0781-49c6-b46d-dc48f0507ac0"],

Cell[TextData[StyleBox["Load the QuESTLink",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d8bc6e16-f96e-4c94-a693-6b23befed153"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Import", "[", "\"\</home/cica/programs/QuESTlink/Link/QuESTlink.m\>\"", 
    "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"CreateLocalQuESTEnv", "[", "\"\<quest_link_cpu\>\"", "]"}], ";"}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.82497505062926*^9, 3.8249750506297073`*^9}, 
   3.824994043627574*^9, 3.825001607792643*^9, {3.825001692867886*^9, 
   3.825001693910748*^9}, 3.825005541672139*^9, {3.8257703632332573`*^9, 
   3.8257703928999557`*^9}, {3.8257705549908867`*^9, 
   3.8257705572226887`*^9}, {3.827395402084569*^9, 3.827395414565299*^9}, 
   3.8273959879208593`*^9, {3.8273960394479303`*^9, 3.8273960853619223`*^9}, {
   3.8273961168062162`*^9, 3.827396123715522*^9}, {3.827396318549856*^9, 
   3.827396412632536*^9}, {3.8274045827011538`*^9, 3.82740458379325*^9}, {
   3.8278173564819393`*^9, 3.827817361228321*^9}, {3.830976734134877*^9, 
   3.8309767494625072`*^9}, {3.834480282684927*^9, 3.834480283538302*^9}, {
   3.834480426528635*^9, 3.834480438344689*^9}, {3.840643429673587*^9, 
   3.84064343214264*^9}, {3.840644090065632*^9, 3.840644110294639*^9}, {
   3.841376639126837*^9, 3.841376652890356*^9}, {3.852805051225027*^9, 
   3.852805051940732*^9}, 3.852866941489101*^9, 3.863433244574464*^9, {
   3.863444417946168*^9, 3.8634444207524557`*^9}, {3.863758485466724*^9, 
   3.8637585009226294`*^9}, {3.863763334072833*^9, 3.8637633356047773`*^9}, {
   3.875107822325452*^9, 3.8751078327815647`*^9}, {3.8833829933758574`*^9, 
   3.883382993547421*^9}, 3.885381849503845*^9},
 CellLabel->
  "In[979]:=",ExpressionUUID->"a4cd114b-0ea9-4c05-a15f-5d75ed5e4a1e"],

Cell[TextData[StyleBox["Virtual quantum devices, loaded after questlink",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.8406416900502462`*^9, 3.840641698118609*^9}, {3.840641813367085*^9, 
  3.840641822804656*^9}, {3.853839759327433*^9, 3.853839762140107*^9}, {
  3.86344845184791*^9, 3.863448455324099*^9}, {3.8637680860803547`*^9, 
  3.863768086918572*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"082f5e06-2cf0-42c4-b066-3920ceb23b54"],

Cell[TextData[{
 StyleBox["frequency unit: M",
  FontSlant->"Italic"],
 StyleBox["Hz",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\ntime unit:",
  FontSlant->"Italic"],
 StyleBox[" \[Mu]s",
  FontWeight->"Bold",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
   3.8406416900502462`*^9, 3.840641698118609*^9}, {3.840641813367085*^9, 
   3.840641822804656*^9}, {3.853839759327433*^9, 3.853839762140107*^9}, {
   3.86344845184791*^9, 3.863448455324099*^9}, {3.8637680860803547`*^9, 
   3.863768086918572*^9}, {3.884321633494584*^9, 3.8843216654912567`*^9}, 
   3.8843217068262587`*^9, {3.884322736344953*^9, 3.884322736949984*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"fc86f3fc-0a99-4091-926c-6b67799ed040"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SuperconductingHub", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "number", " ", "of", " ", "qubits", " ", "should", " ", 
       "match", " ", "all", " ", 
       RowBox[{"assignments", ".", " ", "Qubits"}], " ", "are", " ", 
       "numbered", " ", "from", " ", "0", " ", "to", " ", "N"}], "-", "1"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"qubitsNum", "->", "6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"The", " ", "T1", " ", "time"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "->", "63"}], ",", 
        RowBox[{"1", "->", "93"}], ",", 
        RowBox[{"2", "->", "109"}], ",", 
        RowBox[{"3", "->", "115"}], ",", 
        RowBox[{"4", "->", "68"}], ",", 
        RowBox[{"5", "->", "125"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "The", " ", "T2", " ", "time", " ", "with", " ", "Hahn", " ", "echo", 
       " ", "applied"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"T2", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "->", "113"}], ",", 
        RowBox[{"1", "->", "149"}], ",", 
        RowBox[{"2", "->", "185"}], ",", 
        RowBox[{"3", "->", "161"}], ",", 
        RowBox[{"4", "->", "122"}], ",", 
        RowBox[{"5", "->", "200"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Excited", " ", "population", " ", "probability", " ", "in", " ", 
        "the", " ", "initialisation"}], ",", " ", 
       RowBox[{"also", " ", "the", " ", "thermal", " ", "state"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ExcitedInit", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", "0.032"}], ",", 
        RowBox[{"1", "\[Rule]", "0.021"}], ",", 
        RowBox[{"2", "\[Rule]", "0.008"}], ",", 
        RowBox[{"3", "\[Rule]", "0.009"}], ",", 
        RowBox[{"4", "\[Rule]", "0.025"}], ",", 
        RowBox[{"5", "\[Rule]", "0.007"}]}], "|>"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Each", " ", "qubit", " ", "frequency", " ", "in", " ", "MHz"}],
       "   ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"QubitFreq", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "->", "4500"}], ",", 
        RowBox[{"1", "->", "4900"}], ",", 
        RowBox[{"2", "->", "4700"}], ",", 
        RowBox[{"3", "->", "5100"}], ",", 
        RowBox[{"4", "->", "4900"}], ",", 
        RowBox[{"5", "->", "5300"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Exchange", " ", "coupling", " ", "strength", " ", "of", " ", "the", 
        " ", 
        RowBox[{"resonators", ".", " ", 
         RowBox[{"Use", " ", "[", "Esc", "]"}]}], "o"}], "-", 
       RowBox[{
        RowBox[{"o", "[", "Esc", "]"}], " ", "for", " ", "notation"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ExchangeCoupling", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{
         RowBox[{"0", "\[UndirectedEdge]", "1"}], "->", "4"}], ",", 
        RowBox[{
         RowBox[{"0", "\[UndirectedEdge]", "2"}], "->", "1.5"}], ",", 
        RowBox[{
         RowBox[{"1", "\[UndirectedEdge]", "3"}], "->", "1.5"}], ",", 
        RowBox[{
         RowBox[{"2", "\[UndirectedEdge]", "3"}], "->", "4"}], ",", 
        RowBox[{
         RowBox[{"2", "\[UndirectedEdge]", "4"}], "->", "1.5"}], ",", 
        RowBox[{
         RowBox[{"3", "\[UndirectedEdge]", "5"}], "->", "1.5"}], ",", 
        RowBox[{
         RowBox[{"4", "\[UndirectedEdge]", "5"}], "->", "4"}]}], "|>"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Transmon", " ", "Anharmonicity", " ", "in", " ", "MHz"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Anharmonicity", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "->", "296.7"}], ",", 
        RowBox[{"1", "->", "298.6"}], ",", 
        RowBox[{"2", "->", "297.4"}], ",", 
        RowBox[{"3", "->", "298.3"}], ",", 
        RowBox[{"4", "->", "297.2"}], ",", 
        RowBox[{"5", "->", "299.1"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{"Fidelity", " ", "of", " ", "qubit", " ", "readout"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidRead", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "->", "0.9"}], ",", 
        RowBox[{"1", "->", "0.92"}], ",", 
        RowBox[{"2", "->", "0.96"}], ",", 
        RowBox[{"3", "->", "0.97"}], ",", 
        RowBox[{"4", "->", "0.93"}], ",", 
        RowBox[{"5", "->", "0.97"}]}], "|>"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Measurement", " ", "duration", " ", "in", " ", 
       RowBox[{"\[Mu]s", ".", " ", "It"}], " ", "is", " ", "done", " ", 
       "without", " ", "quantum", " ", "amplifiers"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"DurMeas", "->", "5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Duration", " ", "of", " ", "the", " ", "Rx", " ", "and", " ", "Ry", 
       " ", "gates", " ", "are", " ", "the", " ", "same", " ", "regardless", 
       " ", "the", " ", 
       RowBox[{"angle", ".", " ", "Rz"}], " ", "is", " ", "virtual", " ", 
       "and", " ", 
       RowBox[{"perfect", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DurRxRy", "->", "0.05"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Duration", " ", "of", " ", "the", " ", "cross", " ", "resonance", " ", 
       "ZX", " ", "gate", " ", "that", " ", "is", " ", "fixed", " ", 
       "regardless", " ", "the", " ", 
       RowBox[{"angle", ".", " ", "The"}], " ", "error", " ", "is", " ", 
       "sourced", " ", "from", " ", "the", " ", "passive", " ", "noise", " ", 
       
       RowBox[{"only", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DurZX", "->", "0.5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Duration", " ", "of", " ", "the", " ", "sizzle", " ", "gate", " ", 
       "is", " ", "fixed", " ", "regardless", " ", "the", " ", "angle", " ", 
       "that", " ", "is", " ", "fixed", " ", "regardless", " ", "the", " ", 
       RowBox[{"angle", ".", " ", "The"}], " ", "error", " ", "is", " ", 
       "sourced", " ", "from", " ", "the", " ", "passive", " ", "noise", " ", 
       
       RowBox[{"only", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DurZZ", "->", "0.5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"switches", " ", "to", " ", 
       RowBox[{"turn", "/", "off"}], " ", "some", " ", "noise"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"StdPassiveNoise", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ZZPassiveNoise", "->", "True"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzE0og3EAx/HZDl6acpiLxUJrJgfZ8laGYqJobStpctiaWNYceCgrRWmm
UV5WKKUhF0xpNKzZdloOW41puahRW5uGjSch/98O3z63b7naINcyGQxGCQl2
OmWv7lSiXSQL0LC/LVN9Q5w7PmuGfdavbmjf2uiBHQPrSji/eKGCobyMGh76
TSMwrh+joPlzaQY+ausd0OqjLqFuYugZuuLsGJyM5KZh05OXhlWrMoGH6OZ5
GyC7N9ECKzwWCZTqNVLoDJd2wXRtDtdLPPjezar5W7PBMvnyFUy/rdzBYdP2
PfRbYjFISV/ikK+6TkFF6wLTR5ymZ/PhoNbIgYqpcx5U1kgqoW7fJYDjhpAQ
/kaKxPBHGGiEYfeoDYqjm3vwgTo9gVH6NmvQHmR9EI38ZAHkFDvqEu/kzzKJ
IFUoMieJ3KOdrP9KmQK4
  "],
 CellLabel->
  "In[629]:=",ExpressionUUID->"e9dc3b26-5b26-420f-a5fd-1da2300bc749"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.885895532132204*^9, 
  3.885895533603839*^9}},ExpressionUUID->"4e083e04-7fc0-4273-9ee1-\
c6824dc3a5de"],

Cell[CellGroupData[{

Cell["The exact solution", "Section",
 CellChangeTimes->{{3.885895535203059*^9, 
  3.885895540630796*^9}},ExpressionUUID->"014e4f6b-5bfd-497e-b9a8-\
8c2f20747113"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"molecule", " ", "distances"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"moldists", "=", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0.35", ",", "1.", ",", "0.04"}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1.", ",", "2.5", ",", "0.1"}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"2.5", ",", "5", ",", "0.25"}], "]"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8858960877847223`*^9, 3.885896106649102*^9}, {
  3.8858965057627993`*^9, 3.885896525153721*^9}, {3.885896914148196*^9, 
  3.88589691433283*^9}},
 CellLabel->
  "In[613]:=",ExpressionUUID->"1122bf72-a80c-49bf-9b7b-62199b9c92c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.35`", ",", "0.38999999999999996`", ",", "0.43`", ",", "0.47`", ",", 
   "0.51`", ",", "0.55`", ",", "0.59`", ",", "0.63`", ",", 
   "0.6699999999999999`", ",", "0.71`", ",", "0.75`", ",", "0.79`", ",", 
   "0.83`", ",", "0.87`", ",", "0.91`", ",", "0.95`", ",", "0.99`", ",", 
   "1.`", ",", "1.1`", ",", "1.2`", ",", "1.3`", ",", "1.4`", ",", "1.5`", 
   ",", "1.6`", ",", "1.7000000000000002`", ",", "1.8`", ",", "1.9`", ",", 
   "2.`", ",", "2.1`", ",", "2.2`", ",", "2.3`", ",", "2.4000000000000004`", 
   ",", "2.5`", ",", "2.75`", ",", "3.`", ",", "3.25`", ",", "3.5`", ",", 
   "3.75`", ",", "4.`", ",", "4.25`", ",", "4.5`", ",", "4.75`", ",", "5.`"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.885895546538678*^9, {3.885896092731844*^9, 3.8858961103281803`*^9}, {
   3.885896501924177*^9, 3.885896569437718*^9}, 3.88589665135717*^9, {
   3.88589691461103*^9, 3.885896935557048*^9}},
 CellLabel->
  "Out[613]=",ExpressionUUID->"529daf7d-1576-47e9-8fde-9d18b795aef6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"ground", " ", "states", " ", "of", " ", "H2"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"gsH2", "=", 
    RowBox[{"Table", "[", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"fname", "=", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<H2_hamiltonians/H2_``.txt\>\"", ",", " ", 
           RowBox[{"NumberForm", "[", 
            RowBox[{"dist", ",", " ", 
             RowBox[{"{", 
              RowBox[{"4", ",", " ", "2"}], "}"}]}], "]"}]}], "]"}]}]}], ";", 
       "\n", "       ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ham", ",", " ", "nterms", ",", " ", "nq"}], "}"}], " ", "=",
         " ", 
        RowBox[{"FormatHamiltonian", "[", "fname", "]"}]}], ";", "\n", " ", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<distance\>\"", "->", "dist"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<hamfile\>\"", "->", "fname"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<hamiltonian\>\"", "->", "ham"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<groundstate\>\"", "->", 
          RowBox[{"Min", "@", 
           RowBox[{"Eigenvalues", "@", 
            RowBox[{"CalcPauliStringMatrix", "@", "ham"}]}]}]}]}], 
        "\[IndentingNewLine]", "|>"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"dist", ",", "moldists"}], "}"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.8858961536761827`*^9, 3.8858962081508636`*^9}, {
  3.885896316100296*^9, 3.88589640671562*^9}, {3.885896620565353*^9, 
  3.885896663135996*^9}, {3.885896703129037*^9, 3.885896800120406*^9}},
 CellLabel->
  "In[614]:=",ExpressionUUID->"9b8249d1-f6d2-4eec-bbd2-0c9d1f49c209"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"gsH2", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<distance\>\"", ",", "\"\<groundstate\>\""}], "}"}]}], 
     "]"}], "]"}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<OpenMarkers\>\"", ",", "6"}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "->", "Dashed"}], ",", 
   RowBox[{"Joined", "->", "True"}], ",", 
   RowBox[{"Frame", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.885896864582025*^9, 3.885896921138859*^9}, {
  3.885896979083572*^9, 3.8858970150326138`*^9}, {3.885897063908493*^9, 
  3.885897125482252*^9}, {3.885897157457251*^9, 3.885897163768444*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"e8238a94-1d59-4f18-9cdf-9a3b41d20f98"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], Dashing[{Small, Small}],
       LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBmIQnQYG1+ytu5sfbXR8uf+rRkz/oa837KtXBV9Tnfxm
f+vrwB1yrbft165TmXnx37v9IuvcH1aJ3LN/Z98SfDLxw/4goOzrwAf23eXG
NlJsH/fPmgkCD+3PLXCsz6z+uB+oGKjjkb0CP7Pu4jMf92uCjNd4Yq/R65zx
hvHT/gJbruuLC57a/9s9sbta8dN+sHE7ntk/3+ugr2jwaT8DGLywvzCpftVC
w0/7PcAGvrRfcuF02SeNT/tBpsX0v7L/MnUPa7rEp/1Aw4Amvrbf9KKv9TLQ
fHmwB97aJwTtfr3i2cf9EP++s/d6HXed+8TH/WDvrHtvbzWBlfX5so9Q+z7Y
RzixnvefB/PPR3v1Uu9L8S4f9xuDwWd7qa3SfzJefNh/9gwIfLE/u7yyUn7C
B6j53+xNZHoXRdt/gJr3w97w7taX1z68h5r3095u0rczsyve7zcBm/fbXq1G
J+et6HuoeX/stxXMjzA5/g5q3j/7XQ7PF33sfAc1j8EhhIlvtkv0O6h6BgeJ
3iCHQIt3UPMZHWTqY+82ysH0MzmYta38uoz7HdQ+Zoc+8TTJf3/fQs1jcXjJ
3F+k+QXGZ3O4MEf3pv4zGJ/D4ZTDncf+D2B8LgeeZVM63t2F8Xkc1kkYXmSE
8/kc2vyZt6y8A+MLOLBcFTXogvMFHXLec4XWw/lCDv9rpfZUw/nCDkdkv0yv
gvNFHJZueWkP4gMAqaFDnw==
       "]]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], Dashing[{Small, Small}], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[{
           {GrayLevel[1], DiskBox[{0, 0}, Offset[{3., 3.}, {0., 0.}]]}, 
           {AbsoluteThickness[1.5], Dashing[{}], 
            CircleBox[{0, 0}, Offset[{3., 3.}, {0., 0.}]]}}],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[0.012833333333333334`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6], 
           Dashing[{Small, Small}]]}],
        TraditionalForm], {0., 0.}, Automatic, Scaled[9.75]], CompressedData["

1:eJxTTMoPSmVmYGDQBmJGIGYC4jQwuGZv3d38aKPjy/1fNWL6D329YV+9Kvia
6uQ3+1tfB+6Qa71tv3adysyL/97tF1nn/rBK5J79O/uW4JOJH/YHAWVfBz6w
7y43tpFi+7h/1kwQeGh/boFjfWb1x/1AxUAdj+wV+Jl1F5/5uF8TZLzGE3uN
XueMN4yf9hfYcl1fXPDU/t/uid3Vip/2g43b8cz++V4HfUWDT/sZwOCF/YVJ
9asWGn7a7wE28KX9kgunyz5pfNoPMi2m/5X9l6l7WNMlPu0HGgY08bX9phd9
rZeB5suDPfDWPiFo9+sVzz7uh/j3nb3X67jr3Cc+7gd7Z917e6sJrKzPl32E
2vfBPsKJ9bz/PJh/Ptqrl3pfinf5uN8YDD7bS22V/pPx4sP+s2dA4Iv92eWV
lfITPkDN/2ZvItO7KNr+A9S8H/aGd7e+vPbhPdS8n/Z2k76dmV3xfr8J2Lzf
9mo1OjlvRd9Dzftjv61gfoTJ8XdQ8/7Z73J4vuhj5zuoeQwOIUx8s12i30HV
MzhI9AY5BFq8g5rP6CBTH3u3UQ6mn8nBrG3l12Xc76D2MTv0iadJ/vv7Fmoe
i8NL5v4izS8wPpvDhTm6N/WfwfgcDqcc7jz2fwDjcznwLJvS8e4ujM/jsE7C
8CIjnM/n0ObPvGXlHRhfwIHlqqhBF5wv6JDzniu0Hs4XcvhfK7WnGs4Xdjgi
+2V6FZwv4rB0y0t7EB8AtnVDoQ==
      "]]}}, {{}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, -0.7699445215743421},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{405.23809523809496`, Automatic},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 5.}, {-1.1371170673457307`, -0.7892693924044133}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.08090169943749476]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.885896881313847*^9, 3.885896940172186*^9}, {
   3.885896985648836*^9, 3.8858970153181057`*^9}, {3.885897070674822*^9, 
   3.885897126204249*^9}, 3.8858971641671257`*^9},
 CellLabel->
  "Out[628]=",ExpressionUUID->"41cef740-5bf1-4798-affc-dc1b4e7b4534"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VQE on the virtual device using random ansatz methode", "Section",
 CellChangeTimes->{{3.8850232015764093`*^9, 3.8850232111750402`*^9}, {
   3.885380917310484*^9, 3.8853809207398357`*^9}, {3.885461739354005*^9, 
   3.885461739556319*^9}, {3.885574452673894*^9, 3.885574452835341*^9}, {
   3.885582864187624*^9, 3.885582874824149*^9}, {3.885892638269977*^9, 
   3.8858926462795362`*^9}, 3.885895053698411*^9, {3.885897324942552*^9, 
   3.885897331608717*^9}},ExpressionUUID->"e7ed13f6-e8d4-45d7-a1a9-\
02da9c9d873e"],

Cell["All measurements are perfect here.", "Text",
 CellChangeTimes->{{3.885897545369801*^9, 
  3.8858975527657022`*^9}},ExpressionUUID->"59f52579-3dc4-4b7d-a107-\
85e42907ae2c"],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["(1)",
  FontWeight->"Bold"],
 " Original noisy setting: H2onSQC0.mx"
}], "Subsection",
 CellChangeTimes->{{3.885895059858294*^9, 3.885895097696747*^9}, {
  3.8858952206753597`*^9, 3.885895225242703*^9}, {3.885897406965384*^9, 
  3.8858974094804792`*^9}, {3.885897535174815*^9, 
  3.8858975562740726`*^9}},ExpressionUUID->"dade9624-ccaa-4a01-8237-\
3f905ed7be70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H2onSQC0", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885897441496107*^9, 3.885897443657248*^9}, {
  3.8858976143083344`*^9, 3.885897614965187*^9}},
 CellLabel->
  "In[635]:=",ExpressionUUID->"7378b9b0-fa62-45c9-ae50-e1efc3fab2e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "distance", ",", "hamfile", ",", "hamiltonian", ",", "groundstate"}], 
      "}"}], "=", 
     RowBox[{"Values", "@", "data"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dev", "=", 
     RowBox[{"SuperconductingHub", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"conf", "=", 
     RowBox[{"DefaultConfig", "[", 
      RowBox[{"dev", ",", "hamiltonian"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"conf", "[", "\"\<groundstate\>\"", "]"}], "=", "groundstate"}], 
    ";", "\n", "   ", 
    RowBox[{"res", "=", 
     RowBox[{"VQEonVQD", "[", "conf", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "runtime", ",", "cost", ",", "Elist", ",", "ansatz", ",", 
       "\[Theta]vars", ",", "finmsg", ",", "ncycle", ",", "fev", ",", 
       "aborted", ",", "cycleres", ",", "elimmerge", ",", "elimbfsmall", ",", 
       "elimmetov", ",", "elimbf"}], "}"}], "=", "res"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"H2onSQC0", ",", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<runtime\>\"", "->", "runtime"}], ",", 
        RowBox[{"\"\<ansatz\>\"", "->", "ansatz"}], ",", 
        RowBox[{"\"\<\[Theta]vars\>\"", "->", "\[Theta]vars"}], ",", 
        RowBox[{"\"\<groundstate\>\"", "->", "groundstate"}], ",", 
        RowBox[{"\"\<cost\>\"", "->", "cost"}], ",", 
        RowBox[{"\"\<fev\>\"", "->", "fev"}]}], "|>"}]}], "]"}], ";", "\n", 
    RowBox[{"DumpSave", "[", 
     RowBox[{"\"\<H2onSQC0.mx\>\"", ",", "H2onSQC0"}], "]"}], ";", "\n", 
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<dist \>\"", ",", "distance", ",", "\"\< ; runtime \>\"", ",", 
      "runtime", ",", "\"\< ; \[Epsilon]=\>\"", ",", 
      RowBox[{
       RowBox[{"Last", "@", "Elist"}], "-", 
       RowBox[{"conf", "[", "\"\<groundstate\>\"", "]"}]}]}], "]"}], ";", 
    "\n", 
    RowBox[{"Print", "[", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"Elist", ",", 
       RowBox[{"ImageSize", "->", "300"}]}], "]"}], "]"}], ";", "\n", 
    RowBox[{"Print", "[", 
     RowBox[{"DrawCircuit", "[", 
      RowBox[{"ansatz", ",", "6"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"data", ",", "gsH2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8858974355064783`*^9, 3.885897524654879*^9}, {
  3.885897579323131*^9, 3.885897623176276*^9}, {3.885897662172024*^9, 
  3.8858977365305853`*^9}, {3.885897770504611*^9, 3.885897809832572*^9}, {
  3.885897852768749*^9, 3.885897870475275*^9}},
 CellLabel->
  "In[772]:=",ExpressionUUID->"a00d7257-2eda-44ca-96c1-91872a16e53b"],

Cell[BoxData["\<\"Compilation with automatically generated ansatz at Mon 20 \
Feb 2023 16:09:35 with grad NGAN\"\>"], "Print",
 CellChangeTimes->{3.8858978975451612`*^9, 3.88589811187074*^9, 
  3.885898175999363*^9},
 CellLabel->
  "During evaluation of \
In[772]:=",ExpressionUUID->"24d12a8b-58fd-4cac-a5a6-834ada6b3cfa"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.885897488921359*^9, 3.8858975026451883`*^9}, 
   3.885897921298388*^9, 3.885898123342065*^9, 3.885898184486527*^9},
 CellLabel->
  "Out[772]=",ExpressionUUID->"12142f5f-27f0-46bd-bf59-be74c766ce43"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1919, 1079},
WindowMargins->{{0.5, Automatic}, {Automatic, 0.5}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->"/home/cica/print.pdf"},
Magnification:>0.7 Inherited,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"169295be-b631-4600-b63e-85518ac5c274"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 324, 5, 102, "Title",ExpressionUUID->"46e2a614-73a5-4753-96e9-20a551b9dc09"],
Cell[907, 29, 317, 5, 53, "Text",ExpressionUUID->"1ccb639d-ecf0-4907-9136-7224a50e65c1"],
Cell[1227, 36, 431, 11, 54, "Input",ExpressionUUID->"8a9e8263-0781-49c6-b46d-dc48f0507ac0"],
Cell[1661, 49, 239, 4, 53, "Text",ExpressionUUID->"d8bc6e16-f96e-4c94-a693-6b23befed153"],
Cell[1903, 55, 1637, 27, 54, "Input",ExpressionUUID->"a4cd114b-0ea9-4c05-a15f-5d75ed5e4a1e"],
Cell[3543, 84, 513, 8, 53, "Text",ExpressionUUID->"082f5e06-2cf0-42c4-b066-3920ceb23b54"],
Cell[4059, 94, 794, 19, 77, "Text",ExpressionUUID->"fc86f3fc-0a99-4091-926c-6b67799ed040"],
Cell[4856, 115, 7701, 175, 656, "Input",ExpressionUUID->"e9dc3b26-5b26-420f-a5fd-1da2300bc749"],
Cell[12560, 292, 152, 3, 31, "Input",ExpressionUUID->"4e083e04-7fc0-4273-9ee1-c6824dc3a5de"],
Cell[CellGroupData[{
Cell[12737, 299, 163, 3, 69, "Section",ExpressionUUID->"014e4f6b-5bfd-497e-b9a8-8c2f20747113"],
Cell[CellGroupData[{
Cell[12925, 306, 806, 20, 55, "Input",ExpressionUUID->"1122bf72-a80c-49bf-9b7b-62199b9c92c6"],
Cell[13734, 328, 1022, 18, 35, "Output",ExpressionUUID->"529daf7d-1576-47e9-8fde-9d18b795aef6"]
}, Open  ]],
Cell[14771, 349, 1827, 44, 262, "Input",ExpressionUUID->"9b8249d1-f6d2-4eec-bbd2-0c9d1f49c209"],
Cell[CellGroupData[{
Cell[16623, 397, 795, 19, 31, "Input",ExpressionUUID->"e8238a94-1d59-4f18-9cdf-9a3b41d20f98"],
Cell[17421, 418, 3865, 85, 280, "Output",ExpressionUUID->"41cef740-5bf1-4798-affc-dc1b4e7b4534"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21335, 509, 521, 7, 69, "Section",ExpressionUUID->"e7ed13f6-e8d4-45d7-a1a9-02da9c9d873e"],
Cell[21859, 518, 178, 3, 36, "Text",ExpressionUUID->"59f52579-3dc4-4b7d-a107-85e42907ae2c"],
Cell[CellGroupData[{
Cell[22062, 525, 389, 9, 56, "Subsection",ExpressionUUID->"dade9624-ccaa-4a01-8237-3f905ed7be70"],
Cell[22454, 536, 293, 7, 31, "Input",ExpressionUUID->"7378b9b0-fa62-45c9-ae50-e1efc3fab2e5"],
Cell[CellGroupData[{
Cell[22772, 547, 2752, 64, 301, "Input",ExpressionUUID->"a00d7257-2eda-44ca-96c1-91872a16e53b"],
Cell[25527, 613, 322, 6, 27, "Print",ExpressionUUID->"24d12a8b-58fd-4cac-a5a6-834ada6b3cfa"],
Cell[25852, 621, 256, 4, 35, "Output",ExpressionUUID->"12142f5f-27f0-46bd-bf59-be74c766ce43"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)


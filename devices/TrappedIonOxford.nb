(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    225350,       4921]
NotebookOptionsPosition[    171030,       3961]
NotebookOutlinePosition[    217585,       4821]
CellTagsIndexPosition[    217542,       4818]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Trapped-Ions Oxford/Hub  virtual device", "Title",
 CellChangeTimes->{{3.866179584565133*^9, 3.866179602585011*^9}, {
  3.866740794334939*^9, 
  3.8667408151039267`*^9}},ExpressionUUID->"a51a1c00-1c1e-4809-99a7-\
9b45151e9214"],

Cell[CellGroupData[{

Cell["VQD setup", "Section",
 CellChangeTimes->{{3.895564711188003*^9, 
  3.895564736046365*^9}},ExpressionUUID->"4b33baa5-b934-4d77-847a-\
55ee63f4b597"],

Cell["Set the main directory as the current directory", "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.8528844215679693`*^9, 3.8528844367050333`*^9}, {3.895561738644601*^9, 
  3.895561955745701*^9}, {3.895565197806723*^9, 3.895565201167206*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c34d2386-44e3-4d12-8bcd-6e0adf0c59d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.872921462633623*^9, {3.895561958967956*^9, 3.895561969776804*^9}, {
   3.895564630836348*^9, 3.895564635452001*^9}, {3.895565208327444*^9, 
   3.89556521021968*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"4fb6ff86-df9c-4786-aab4-c5b29d03d1f8"],

Cell[TextData[{
 "Load the QuESTLink package",
 StyleBox["\nOne may also use the off-line questlink.m file, change it to the \
location of the local file",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.895555062959041*^9, 3.895555112315363*^9}, {3.8955551881974287`*^9, 
  3.895555260300796*^9}, {3.895555597085835*^9, 3.895555664673655*^9}, {
  3.895560998697385*^9, 3.895561075198522*^9}, {3.8955620885151787`*^9, 
  3.895562088990657*^9}, {3.8955621274003143`*^9, 3.8955621439683104`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c91ba40d-3b6c-42cd-bdae-10c38124ceab"],

Cell[BoxData[
 RowBox[{"Import", "[", "\"\<https://qtechtheory.org/questlink.m\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.82497505062926*^9, 3.8249750506297073`*^9}, 
   3.824994043627574*^9, 3.825001607792643*^9, {3.825001692867886*^9, 
   3.825001693910748*^9}, 3.825005541672139*^9, {3.8257703632332573`*^9, 
   3.8257703928999557`*^9}, {3.8257705549908867`*^9, 
   3.8257705572226887`*^9}, {3.827395402084569*^9, 3.827395414565299*^9}, 
   3.8273959879208593`*^9, {3.8273960394479303`*^9, 3.8273960853619223`*^9}, {
   3.8273961168062162`*^9, 3.827396123715522*^9}, {3.827396318549856*^9, 
   3.827396412632536*^9}, {3.8274045827011538`*^9, 3.82740458379325*^9}, {
   3.8278173564819393`*^9, 3.827817361228321*^9}, {3.830976734134877*^9, 
   3.8309767494625072`*^9}, {3.834480282684927*^9, 3.834480283538302*^9}, {
   3.834480426528635*^9, 3.834480438344689*^9}, {3.840643429673587*^9, 
   3.84064343214264*^9}, {3.840644090065632*^9, 3.840644110294639*^9}, {
   3.841376639126837*^9, 3.841376652890356*^9}, {3.852805051225027*^9, 
   3.852805051940732*^9}, 3.852866941489101*^9, 3.863433244574464*^9, {
   3.863444417946168*^9, 3.8634444207524557`*^9}, {3.863758485466724*^9, 
   3.8637585009226294`*^9}, {3.863763334072833*^9, 3.8637633356047773`*^9}, {
   3.875107822325452*^9, 3.8751078327815647`*^9}, {3.8833829933758574`*^9, 
   3.883382993547421*^9}, {3.8955550552579536`*^9, 3.8955550607116213`*^9}, {
   3.895555251924384*^9, 3.895555252843107*^9}, 3.895560933223365*^9, {
   3.895562150271586*^9, 3.895562151551223*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"df0ec05c-7c65-422e-9507-d63ba1cb5d39"],

Cell[TextData[{
 "This will download a binary file  ",
 StyleBox["quest_link",
  FontWeight->"Bold"],
 " if there is no such file found",
 StyleBox["\n",
  FontSlant->"Italic"],
 "Otherwise, use a locally-compiled that called ",
 StyleBox["quest_link*",
  FontWeight->"Bold"],
 " "
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.895555062959041*^9, 3.895555112315363*^9}, {3.8955551881974287`*^9, 
  3.895555260300796*^9}, {3.895555597085835*^9, 3.895555664673655*^9}, {
  3.895560998697385*^9, 3.895561075198522*^9}, {3.895562094495385*^9, 
  3.895562099994422*^9}, {3.8955621743068743`*^9, 3.89556218382623*^9}, {
  3.895562229085458*^9, 3.895562229999806*^9}, {3.8955623057350197`*^9, 
  3.895562353406741*^9}, {3.8955652259848747`*^9, 3.8955652439751587`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4cdfcc52-a76b-41a9-a1a1-9fcb87e78202"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Search", " ", "for", " ", "existing", " ", "files", " ", "that", " ", 
    "match", " ", "the", " ", "pattern", " ", "\"\<quest_link*\>\""}], " ", 
   "*)"}], "\n", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"questLinkFiles", "=", 
      RowBox[{"Sort", "@", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<quest_link*\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"NotebookDirectory", "[", "]"}], "}"}]}], "]"}]}]}], "}"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "questLinkFiles", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "one", " ", "or", " ", "more", " ", "matching", " ", 
          "files", " ", "are", " ", "found"}], ",", " ", 
         RowBox[{
         "use", " ", "the", " ", "first", " ", "one", " ", 
          "alphabetically"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Using the existing link file: \>\"", ",", 
          RowBox[{"First", "@", "questLinkFiles"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CreateLocalQuESTEnv", "[", 
         RowBox[{"First", "@", "questLinkFiles"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "If", " ", "no", " ", "matching", " ", "files", " ", "are", " ", 
          "found"}], ",", " ", 
         RowBox[{"download", " ", "the", " ", "link", " ", "file"}]}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<No link file found, download quest_link\>\"", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDownloadedQuESTEnv", "[", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.895562380629335*^9, 3.8955623806299543`*^9}, {
  3.8955642461170387`*^9, 3.895564576316752*^9}, {3.8955654013994617`*^9, 
  3.8955654071519136`*^9}, {3.895566987873014*^9, 3.8955670209948797`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"2b01d8d8-9e6a-499b-97d9-cfce04d9d721"],

Cell[TextData[{
 "Load the ",
 StyleBox["VQD",
  FontWeight->"Bold"],
 " package; must be loaded after QuESTlink is loaded"
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.8406416900502462`*^9, 3.840641698118609*^9}, {3.840641813367085*^9, 
  3.840641822804656*^9}, {3.853839759327433*^9, 3.853839762140107*^9}, {
  3.86344845184791*^9, 3.863448455324099*^9}, {3.8637680860803547`*^9, 
  3.863768086918572*^9}, {3.895562384490183*^9, 3.895562387907646*^9}, {
  3.895562552053419*^9, 3.8955625677886047`*^9}, {3.895565295097423*^9, 
  3.895565315981283*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"5f37c9ba-3582-4916-b8a6-b00b0ad21432"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<../vqd.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.840641143565943*^9, 3.840641172251192*^9}, {
   3.852799583306651*^9, 3.85279959973236*^9}, 3.8626416092550993`*^9, {
   3.8634335183180933`*^9, 3.863433525482596*^9}, {3.863433568660131*^9, 
   3.863433569874107*^9}, {3.863433692497489*^9, 3.863433694465293*^9}, {
   3.863445057138888*^9, 3.86344507880478*^9}, {3.863445347209435*^9, 
   3.8634453507921267`*^9}, {3.863445650432852*^9, 3.863445652815689*^9}, {
   3.863445897019453*^9, 3.8634458974688377`*^9}, {3.86344607759472*^9, 
   3.863446078099331*^9}, {3.863446143635272*^9, 3.863446143966124*^9}, {
   3.863446177367778*^9, 3.86344617796842*^9}, {3.8634467623389387`*^9, 
   3.863446816486045*^9}, {3.863446923713131*^9, 3.863446924990855*^9}, {
   3.863447604132453*^9, 3.8634476320572042`*^9}, {3.863448157317191*^9, 
   3.863448185412036*^9}, {3.86344848550739*^9, 3.863448486307929*^9}, {
   3.863730635263914*^9, 3.863730645543404*^9}, {3.863730806825498*^9, 
   3.863730825085904*^9}, {3.864798306500605*^9, 3.864798308030095*^9}, {
   3.864808339041327*^9, 3.864808339281568*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"fbda1cba-5510-430b-ae7f-72219c40e12c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set the default configuration of the virtual ion traps", "Section",
 CellChangeTimes->{{3.8955646672228727`*^9, 3.8955647020722857`*^9}, {
  3.895565504944984*^9, 
  3.895565506547858*^9}},ExpressionUUID->"6507264a-34a1-4c23-92d3-\
885063f7d4ab"],

Cell[TextData[{
 StyleBox["frequency unit: ",
  FontSlant->"Italic"],
 StyleBox["M",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Hz",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\ntime unit:",
  FontSlant->"Italic"],
 StyleBox[" \[Mu]s",
  FontWeight->"Bold",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
   3.8406416900502462`*^9, 3.840641698118609*^9}, {3.840641813367085*^9, 
   3.840641822804656*^9}, {3.853839759327433*^9, 3.853839762140107*^9}, {
   3.86344845184791*^9, 3.863448455324099*^9}, {3.8637680860803547`*^9, 
   3.863768086918572*^9}, {3.884321633494584*^9, 3.8843216654912567`*^9}, 
   3.8843217068262587`*^9, {3.884322736344953*^9, 3.884322736949984*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"01bbf5b7-efb5-4735-b44c-900b069c1b48"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "TrappedIonOxford", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "the", " ", "name", " ", "of", " ", "trap", " ", "nodes", " ", "name", 
      " ", "together", " ", "and", " ", "the", " ", "number", " ", "of", " ", 
      "ions", " ", "on", " ", "each", " ", "node"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Nodes", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "4"}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", "4"}]}], "|>"}]}], "\[IndentingNewLine]",
      ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"the", " ", "T1", " ", "time"}], ",", " ", 
       RowBox[{"exponential", " ", "decay"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", "9"]}]}], ",", " ", 
        RowBox[{"\"\<Bob\>\"", "->", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", "9"]}]}]}], "    ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"the", " ", "T2", "*", " ", "time"}], ",", " ", 
       RowBox[{"Gaussian", " ", "decay"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2s", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", 
         SuperscriptBox["10", "5"]}], ",", "  ", 
        RowBox[{"\"\<Bob\>\"", "->", 
         SuperscriptBox["10", "5"]}]}], "   ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Duration", " ", "for", " ", "moving", " ", 
        RowBox[{"operations", ":", " ", "Split"}]}], ",", " ", "Combine", ",",
        " ", 
       RowBox[{"and", " ", "physical", " ", "swap"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"DurMove", "->", "\[IndentingNewLine]", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", " ", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"Shutl", "->", "25"}], ",", " ", 
           RowBox[{"Splz", "->", "50"}], ",", " ", 
           RowBox[{"Comb", "->", "50"}], ",", " ", 
           RowBox[{"SWAPLoc", "->", "10"}]}], " ", "|>"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Bob\>\"", "->", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"Shutl", "->", "25"}], ",", " ", 
           RowBox[{"Splz", "->", "50"}], ",", " ", 
           RowBox[{"Comb", "->", "50"}], ",", " ", 
           RowBox[{"SWAPLoc", "->", "10"}]}], " ", "|>"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "fidelity", " ", "and", " ", "duration", " ", "of", " ", 
        "initialisation", " ", "on", " ", "each", " ", "qubit"}], ";", " ", 
       RowBox[{
       "the", " ", "initialisation", " ", "is", " ", "done", " ", 
        "simultaneously", " ", "on", " ", "all", " ", "ions"}]}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"FidInit", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "0.9999"}], ",", " ", 
        RowBox[{"\"\<Bob\>\"", "->", "0.9998"}]}], "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"DurInit", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "20"}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", "20"}]}], "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"readout", " ", "duration"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"DurRead", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "50"}], ",", " ", 
        RowBox[{"\"\<Bob\>\"", "->", "50"}]}], "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Symmetric", " ", "bit"}], "-", 
       RowBox[{"flip", " ", "eror", " ", "during", " ", "readout"}]}], "  ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ProbBFRead", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", 
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]]}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", 
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]]}]}], "|>"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Fidelity", " ", "of", " ", "single", " ", "x"}], "-", " ", 
        RowBox[{"and", " ", "y"}], "-", " ", "rotations"}], ";", " ", 
       RowBox[{"z", "-", 
        RowBox[{"rotation", " ", "is", " ", "instaneous", " ", 
         RowBox[{"(", 
          RowBox[{"noiseless", ",", " ", "virtual"}], ")"}]}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"FidSingleXY", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "0.99999"}], ",", " ", 
        RowBox[{"\"\<Bob\>\"", "->", "0.99999"}]}], "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"fraction", " ", "of", " ", 
       RowBox[{"depolarising", ":", 
        RowBox[{
         RowBox[{"dephasing", " ", "noise", " ", "of", " ", "the", " ", "x"}],
          "-", " ", 
         RowBox[{"and", " ", "y"}], "-", " ", "rotations"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"EFSingleXY", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}]}], "|>"}]}], "\[IndentingNewLine]",
      ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Rabi", " ", "frequency", " ", "on", " ", "single", " ", "rotations"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RabiFreq", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "10"}], ",", " ", 
        RowBox[{"\"\<Bob\>\"", "->", "10"}]}], " ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Frequency", " ", "of", " ", "CZ", " ", "operation"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FreqCZ", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "0.1"}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", "0.1"}]}], "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fidelity", " ", "of", " ", "CZ", " ", "operation"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidCZ", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "0.999"}], ",", " ", 
        RowBox[{"\"\<Bob\>\"", "->", "0.999"}]}], "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"fraction", " ", "of", " ", "two"}], "-", 
       RowBox[{"qubit", " ", 
        RowBox[{"depolarising", ":", 
         RowBox[{
         "dephasing", " ", "error", " ", "after", " ", "entanglement", " ", 
          "distillation"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"EFCZ", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.9"}], "}"}]}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.9"}], "}"}]}]}], "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "rate", " ", "of", " ", "heralded", " ", "remote", " ", "entanglement", 
       " ", "generation"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FreqEnt", "->", "0.1"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "fidelity", " ", "of", " ", "the", " ", "raw", " ", "bell", " ", 
       "pair"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidEnt", "->", "0.95"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "fraction", " ", "of", " ", "noise", " ", "on", " ", "the", " ", 
        "obtained", " ", "raw", " ", "bell", " ", "pair"}], ",", " ", 
       RowBox[{"2", "-", 
        RowBox[{"qubit", " ", 
         RowBox[{"depolarising", ":", "dephasing"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"EFEnt", "->", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.9"}], "}"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Switch", " ", 
       RowBox[{"on", "/", "off"}], " ", "the", " ", "standard", " ", 
       "passive", " ", 
       RowBox[{"noise", ":", " ", 
        RowBox[{"decays", " ", "T1", " ", "and", " ", "T2", "*"}]}]}], "  ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"StdPassiveNoise", "->", "True"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.866741525798813*^9, 3.8667415268823643`*^9}, {
   3.866741663432423*^9, 3.866741665522397*^9}, {3.866741745552545*^9, 
   3.86674175266329*^9}, {3.8667951940122232`*^9, 3.866795264671464*^9}, {
   3.86679558066088*^9, 3.866795620210507*^9}, {3.866795751852192*^9, 
   3.866795773983354*^9}, {3.866795889141552*^9, 3.866795931399184*^9}, 
   3.8667960054150743`*^9, {3.866796238217458*^9, 3.866796387720312*^9}, {
   3.866797546811494*^9, 3.8667975863855867`*^9}, {3.866797868437003*^9, 
   3.866797925147974*^9}, {3.866804302073353*^9, 3.8668043033454514`*^9}, {
   3.8668049823176613`*^9, 3.866804997766453*^9}, {3.8668054954071693`*^9, 
   3.866805501412159*^9}, {3.8672267922453127`*^9, 3.867226826078993*^9}, {
   3.86722755102808*^9, 3.867227619738082*^9}, {3.8672276764652348`*^9, 
   3.8672277171831093`*^9}, {3.8672278717818413`*^9, 3.867227877110051*^9}, {
   3.867228493899407*^9, 3.8672285328403187`*^9}, {3.867229396481929*^9, 
   3.8672293983037024`*^9}, 3.867235278678097*^9, {3.867235796126501*^9, 
   3.867235845448059*^9}, {3.867237137950498*^9, 3.8672371695811872`*^9}, {
   3.8672372036357193`*^9, 3.8672372235594378`*^9}, {3.867237623562272*^9, 
   3.867237643629908*^9}, {3.867237899531828*^9, 3.8672379111048193`*^9}, {
   3.8672385761871433`*^9, 3.867238580773076*^9}, {3.869213991025598*^9, 
   3.86921401005344*^9}, 3.869214111626649*^9, {3.86921415472738*^9, 
   3.869214186857623*^9}, {3.869214724170225*^9, 3.869214766542733*^9}, {
   3.869214798607539*^9, 3.8692147991185513`*^9}, {3.869214956910564*^9, 
   3.869215003816546*^9}, {3.869215064473733*^9, 3.869215079623447*^9}, {
   3.869215257338026*^9, 3.8692153217380466`*^9}, {3.869215369674582*^9, 
   3.8692153707769003`*^9}, {3.869218551089553*^9, 3.869218554105139*^9}, {
   3.873536137487809*^9, 3.873536157113378*^9}, {3.8737218269830513`*^9, 
   3.8737218942167397`*^9}, {3.873722023539997*^9, 3.873722078245874*^9}, {
   3.873722151005465*^9, 3.873722184832581*^9}, {3.873722262394095*^9, 
   3.873722299789385*^9}, {3.873727405456362*^9, 3.873727407667687*^9}, {
   3.873795067207028*^9, 3.873795083012207*^9}, 3.873801728693125*^9, {
   3.873803376445282*^9, 3.873803605099039*^9}, {3.873803936299101*^9, 
   3.873803985392705*^9}, {3.8738054296210938`*^9, 3.873805434739148*^9}, {
   3.8738081749509373`*^9, 3.873808189643832*^9}, {3.873808260543518*^9, 
   3.873808299197383*^9}, {3.8738086232761803`*^9, 3.8738086258360643`*^9}, {
   3.873809740474554*^9, 3.873809746170124*^9}, {3.873827989551094*^9, 
   3.873828046626005*^9}, {3.8738280918401623`*^9, 3.873828092823846*^9}, {
   3.873828868270315*^9, 3.873828878840913*^9}, {3.8738743930632133`*^9, 
   3.873874395974115*^9}, {3.8738744915832233`*^9, 3.873874499108654*^9}, {
   3.8738745608100157`*^9, 3.87387456531114*^9}, {3.873875747308943*^9, 
   3.873875786891082*^9}, {3.8738758454165497`*^9, 3.873875870793645*^9}, {
   3.873875905255966*^9, 3.873875913996315*^9}, {3.873875969049201*^9, 
   3.873875986036682*^9}, {3.873876056189313*^9, 3.873876103462187*^9}, {
   3.8738761385663*^9, 3.8738761771993837`*^9}, {3.873876472224475*^9, 
   3.873876487654408*^9}, {3.873883365596745*^9, 3.873883367431622*^9}, {
   3.873883431528206*^9, 3.873883433521964*^9}, {3.873883474136989*^9, 
   3.873883478808856*^9}, {3.8756901249387693`*^9, 3.8756901563944197`*^9}, {
   3.8756912977568398`*^9, 3.87569130899468*^9}, {3.875695695076517*^9, 
   3.8756957807834473`*^9}, {3.875697315448535*^9, 3.875697317226529*^9}, {
   3.8756990026610813`*^9, 3.875699006062674*^9}, {3.875783909784436*^9, 
   3.875783932509903*^9}, {3.8757839702434196`*^9, 3.875783991926955*^9}, {
   3.87578436190112*^9, 3.875784380902054*^9}, {3.87578443900996*^9, 
   3.8757844773945208`*^9}, {3.875784937308525*^9, 3.8757849415846767`*^9}, {
   3.875784987199074*^9, 3.875784988288704*^9}, {3.875810550708597*^9, 
   3.875810552776515*^9}, {3.8758197920102873`*^9, 3.875819792412874*^9}, 
   3.875821671365123*^9, {3.8762074814071903`*^9, 3.876207483622019*^9}, {
   3.876207525319086*^9, 3.876207527076189*^9}, {3.8769095900478888`*^9, 
   3.8769095943411417`*^9}, {3.876909653906137*^9, 3.876909655907584*^9}, {
   3.880187546317218*^9, 3.880187569387553*^9}, {3.8836353092981243`*^9, 
   3.883635318989584*^9}, {3.883643515674913*^9, 3.88364353193294*^9}, {
   3.883643742881509*^9, 3.883643762183663*^9}, {3.8836438359438868`*^9, 
   3.8836438363100348`*^9}, {3.883643883398198*^9, 3.8836438956169167`*^9}, {
   3.883644265128314*^9, 3.8836442664241734`*^9}, 3.883644561668241*^9, {
   3.88364577387563*^9, 3.883645779511386*^9}, {3.883648458100438*^9, 
   3.883648463754395*^9}, {3.883649022834107*^9, 3.883649025912264*^9}, {
   3.883649138391301*^9, 3.883649204038764*^9}, {3.883649241829829*^9, 
   3.883649244178939*^9}, {3.883649357764249*^9, 3.883649367223763*^9}, {
   3.883649516843505*^9, 3.8836495191985207`*^9}, {3.883649559382502*^9, 
   3.883649602092461*^9}, {3.883649647615107*^9, 3.8836496615221777`*^9}, {
   3.883734777484333*^9, 3.883734777735754*^9}, {3.884014878594007*^9, 
   3.884014925781691*^9}, {3.884023823178306*^9, 3.8840238256397867`*^9}, {
   3.884024774332857*^9, 3.8840247859359217`*^9}, {3.8840257321870203`*^9, 
   3.8840257357595453`*^9}, {3.8842513640567408`*^9, 
   3.8842513854108763`*^9}, {3.8948809172360353`*^9, 3.894880918645903*^9}, {
   3.8949635289967737`*^9, 3.894963532926544*^9}, 3.894965641175787*^9, {
   3.8949658885414343`*^9, 3.894965889040092*^9}, {3.894965972874528*^9, 
   3.89496597469978*^9}, {3.895562584140646*^9, 3.895562775204207*^9}, {
   3.895562845019167*^9, 3.895562966077805*^9}, {3.895563047110268*^9, 
   3.895563088523695*^9}, {3.895563120639615*^9, 3.895563249727819*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"786b6905-0c83-4785-9309-62848193302e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elementary guide", "Section",
 CellChangeTimes->{{3.8955656603988857`*^9, 
  3.895565664855155*^9}},ExpressionUUID->"ee76f947-9d17-462b-a234-\
af4aca63054c"],

Cell[CellGroupData[{

Cell["Native gates", "Subsection",
 CellChangeTimes->{{3.895565668363599*^9, 
  3.895565672293972*^9}},ExpressionUUID->"bcac4c86-b1e1-4542-b4fc-\
7ae6239c3320"],

Cell[TextData[{
 StyleBox["Operators ",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Initialisation and readout\n",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["Init", 
    RowBox[{"1", ",", "2", ",", "...", ",", "n"}]], TraditionalForm]],
  ExpressionUUID->"1d09064b-73a1-41da-b8f5-29bfdc8451dd"],
 "[node],  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Read", "q"], "[", "node", "]"}], TraditionalForm]],
  ExpressionUUID->"26a73222-1524-41dc-ae57-279f1797effa"],
 "\n\n",
 StyleBox["Single-qubit gates",
  FontSlant->"Italic"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Rx", "q"], "[", 
    RowBox[{"node", ",", "\[Theta]"}], "]"}], TraditionalForm]],
  ExpressionUUID->"1db64c5f-090c-48ec-a6e8-d4fa995044d0"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Ry", "q"], "[", 
    RowBox[{"node", ",", "\[Theta]"}], "]"}], TraditionalForm]],
  ExpressionUUID->"acad095c-9f40-4645-a4c4-5c00814aad30"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Rz", "q"], "[", 
    RowBox[{"node", ",", "\[Theta]"}], "]"}], TraditionalForm]],
  ExpressionUUID->"00f4c98c-9aee-4aee-be37-2c4fcc2ccbc9"],
 " \n\n",
 StyleBox["Two-qubit gates",
  FontSlant->"Italic"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["CZ", 
     RowBox[{"q1", ",", "q2"}]], "[", "node", "]"}], TraditionalForm]],
  ExpressionUUID->"300da055-2d4d-425a-9aa0-e20ad156cc5a"],
 "\n\n",
 StyleBox["Remote gates (create a remote Bell-pair)",
  FontSlant->"Italic"],
 "\nEnt[node1, node2]\n\n",
 StyleBox["Physical moves/shuttling",
  FontSlant->"Italic"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["SWAPLoc", 
     RowBox[{"q1", ",", "q2"}]], "[", "node", "]"}], TraditionalForm]],
  ExpressionUUID->"11ee6e8b-13b7-4f51-9da4-7f708fdd49d5"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Splz", 
     RowBox[{"q1", ",", "q2"}]], "[", 
    RowBox[{"node", ",", "zone_destination"}], "]"}], TraditionalForm]],
  ExpressionUUID->"e63a851d-9931-4bb8-9b61-8a9a985167ab"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["Comb", 
      RowBox[{"q1", ",", "q2"}]], "[", "node", "]"}], ","}], 
   TraditionalForm]],ExpressionUUID->"9d8ce3a4-b2bf-411d-8598-bf8974d855d7"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Comb", 
     RowBox[{"q1", ",", "q2"}]], "[", 
    RowBox[{"node", ",", "zone_destination"}], "]"}], TraditionalForm]],
  ExpressionUUID->"0d25bf03-7554-403e-9c84-b08d8ede164b"],
 "\n\n",
 StyleBox["others: doing nothing\n",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["Wait", "q"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6012f22d-795c-4751-a607-11111760e16d"],
 "[duration]\n\n",
 StyleBox["Zone and allowed operations",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Zone 1",
  FontWeight->"Bold"],
 " : Shutl, Init, Read, Splz, Comb, SWAPLoc\n",
 StyleBox["Zone 2",
  FontWeight->"Bold"],
 " : Shutl, Init, Read, Splz, Comb, SWAPLoc, Rx, Ry, Rz, CZ\n",
 StyleBox["Zone 3",
  FontWeight->"Bold"],
 " : Shutl, Init, Read, Splz, Comb, SWAPLoc, Rx, Ry, Rz, CZ\n",
 StyleBox["Zone 4",
  FontWeight->"Bold"],
 " : Shutl, Ent"
}], "Text",
 CellChangeTimes->{{3.8692122673836203`*^9, 3.869212288716358*^9}, {
   3.8732900821348667`*^9, 3.8732900892281*^9}, {3.873535234627952*^9, 
   3.8735352993376503`*^9}, 3.8735355903892736`*^9, {3.873535838903427*^9, 
   3.873535867433639*^9}, {3.873535943640603*^9, 3.873536051939383*^9}, {
   3.8737213853909492`*^9, 3.873721409511063*^9}, {3.873721675411847*^9, 
   3.87372167652286*^9}, {3.873721784879632*^9, 3.8737218004244747`*^9}, {
   3.873886462615952*^9, 3.8738864754993267`*^9}, {3.8835477479780693`*^9, 
   3.883547778908753*^9}, 3.883558706803985*^9, 3.883733935859179*^9, {
   3.895561124018421*^9, 3.8955612424709682`*^9}, {3.895561370610491*^9, 
   3.895561375643483*^9}, {3.895565715481627*^9, 3.895565773718214*^9}, {
   3.895566093199087*^9, 3.8955661878383408`*^9}, {3.895566337576305*^9, 
   3.895566360670906*^9}, {3.895566426697022*^9, 
   3.895566492900166*^9}},ExpressionUUID->"5f86b73e-5906-4bd6-a372-\
9b5e7579b57a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic operations to create remote entangled pair", "Subsection",
 CellChangeTimes->{{3.895561275579878*^9, 3.895561300230424*^9}, {
  3.895565637708406*^9, 
  3.895565641311281*^9}},ExpressionUUID->"df7f5adc-fabd-4e2d-8267-\
3eddc4da25ee"],

Cell[CellGroupData[{

Cell["Convenient modules", "Subsubsection",
 CellChangeTimes->{{3.895561306367607*^9, 
  3.895561309244854*^9}},ExpressionUUID->"cceafc11-93f6-4531-b5ac-\
663f410eb088"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Transformation", " ", "to", " ", "the", " ", "Bell", " ", "basis", " ", 
    "for", " ", "plotting"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mat2BellBasis", "[", "m_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"\[Sqrt]", "2"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "}"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"pinv", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"\[Sqrt]", "2"}]}], ")"}], "*", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}]}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"pinv", ".", "m", ".", "p"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8768885261541557`*^9, 3.8768885341943502`*^9}, {
  3.876888628227262*^9, 3.876888662182872*^9}, {3.8768886950472527`*^9, 
  3.8768886965816507`*^9}, {3.876889328642879*^9, 3.876889345422171*^9}, {
  3.876889439950932*^9, 3.8768895176394978`*^9}, {3.8837370150048923`*^9, 
  3.883737020901533*^9}, {3.8837394106095457`*^9, 3.883739491942389*^9}, {
  3.884085051725586*^9, 3.8840850592290993`*^9}, {3.895561323535149*^9, 
  3.8955613299464197`*^9}, {3.895566206407439*^9, 3.89556620712302*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"03e5b243-f124-4461-8871-1233f93d5b42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"chartbell", "[", 
      RowBox[{"label_", ":", "\"\<\>\""}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
       RowBox[{"BarSpacing", "\[Rule]", "0.1`"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "height", "}"}], ",", 
          RowBox[{"getcolor", "[", "height", "]"}]}], "]"}]}], ",", 
       RowBox[{"ChartElementFunction", "->", "\"\<Cube\>\""}], ",", 
       RowBox[{"ChartStyle", "->", 
        RowBox[{"EdgeForm", "[", "Thick", "]"}]}], ",", 
       RowBox[{"PlotTheme", "->", "\"\<Business\>\""}], ",", 
       RowBox[{"Ticks", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<\[CapitalPhi]+\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "\"\<\[CapitalPhi]-\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "\"\<\[CapitalPsi]+\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "\"\<\[CapitalPsi]-\>\""}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<\[CapitalPhi]+\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "\"\<\[CapitalPhi]-\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "\"\<\[CapitalPsi]+\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "\"\<\[CapitalPsi]-\>\""}], "}"}]}], "}"}], 
          ",", "Automatic"}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"Bold", ",", "14", ",", 
          RowBox[{"FontFamily", "->", "\"\<FreeSerif\>\""}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "->", 
        RowBox[{"Inset", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"label", ",", "16", ",", "Bold", ",", 
            RowBox[{"FontFamily", "->", "\"\<Serif\>\""}]}], "]"}], ",", 
          RowBox[{"ImageScaled", "[", 
           RowBox[{"{", 
            RowBox[{".3", ",", ".9"}], "}"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", "4.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "4.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"LabelingFunction", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"Rotate", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"#", ">=", "0.5"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", "5"}], "]"}], ",", "13", ",", 
                  RowBox[{"GrayLevel", "[", "0.82", "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", ">=", "0.001"}], ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{"#", "<", "0.5"}], ")"}]}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{"#", ",", "2"}], "]"}], ",", "10", ",", "Black"}], 
                 "]"}], ",", "\[IndentingNewLine]", "True", ",", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"ScientificForm", "[", 
                   RowBox[{"#", ",", "2"}], "]"}], ",", "10", ",", "Black"}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]",
               ",", 
              RowBox[{"90", " ", "Degree"}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#1", ">=", "0.5"}], ",", "Center", ",", "Above"}], 
             "]"}]}], "]"}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ViewAngle", "->", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FaceGrids", "->", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"BoxRatios", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "0.6"}], "}"}]}], ",", 
       RowBox[{"Axes", "->", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "False"}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getcolor", "[", "height_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"height", "<=", "0.5"}], ",", 
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<IslandColors\>\"", "]"}], "[", 
        RowBox[{"1", "+", 
         RowBox[{"0.1", 
          RowBox[{"Log10", "@", "height"}]}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"ColorData", "[", "\"\<RedBlueTones\>\"", "]"}], "[", 
        "height", "]"}]}], "]"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.876979560148282*^9, 3.876979727614102*^9}, {
   3.8769798068659153`*^9, 3.876979817516808*^9}, {3.8769798483459187`*^9, 
   3.876979861337391*^9}, {3.8769799765825357`*^9, 3.876980001171527*^9}, {
   3.876980035011529*^9, 3.8769802117504387`*^9}, {3.8769803173959923`*^9, 
   3.876980318549447*^9}, 3.876980354229821*^9, {3.876980392044441*^9, 
   3.876980392983427*^9}, {3.876981492300438*^9, 3.8769815209319773`*^9}, {
   3.876981553843145*^9, 3.876981555267664*^9}, {3.876981589466167*^9, 
   3.876981605261683*^9}, {3.87698199053374*^9, 3.876982108670127*^9}, {
   3.876982149405799*^9, 3.8769821943371058`*^9}, {3.876982227121867*^9, 
   3.876982324306407*^9}, {3.8769824123752327`*^9, 3.876982421030588*^9}, {
   3.876982642167547*^9, 3.876982898600312*^9}, {3.876983161410459*^9, 
   3.8769831871263247`*^9}, {3.8769832308550367`*^9, 3.876983244353763*^9}, {
   3.87698350263104*^9, 3.876983505027169*^9}, {3.876985229541142*^9, 
   3.8769852804139957`*^9}, {3.876985347020067*^9, 3.876985380525435*^9}, {
   3.876985422745286*^9, 3.8769854332777233`*^9}, {3.876986579906888*^9, 
   3.876986638004673*^9}, {3.876990648931119*^9, 3.876990658587611*^9}, {
   3.876990710602832*^9, 3.8769910973573303`*^9}, {3.876991147003462*^9, 
   3.8769911477804117`*^9}, {3.876991204480769*^9, 3.876991221131629*^9}, {
   3.8769912522462606`*^9, 3.876991253022316*^9}, {3.876991298027089*^9, 
   3.876991343572694*^9}, {3.876991388601252*^9, 3.8769913904147463`*^9}, 
   3.876991424523377*^9, {3.876991493567006*^9, 3.876991496836388*^9}, {
   3.876991650148239*^9, 3.876991701376438*^9}, {3.8769917788643723`*^9, 
   3.876991826752802*^9}, {3.876991868817513*^9, 3.8769918720622997`*^9}, {
   3.87699190455686*^9, 3.876991975185678*^9}, {3.8769920070529423`*^9, 
   3.876992034767621*^9}, {3.8769920756831627`*^9, 3.876992237092181*^9}, {
   3.876992326800829*^9, 3.876992362209342*^9}, {3.876992426570319*^9, 
   3.8769926748499603`*^9}, 3.876992708671*^9, {3.8769929596081667`*^9, 
   3.8769930276467123`*^9}, {3.8769931279324903`*^9, 3.876993148431003*^9}, {
   3.876993198352371*^9, 3.876993198911695*^9}, 3.876993321541947*^9, 
   3.8769933796337833`*^9, {3.8769934313006077`*^9, 3.876993431760426*^9}, {
   3.8769935025002604`*^9, 3.876993523725471*^9}, {3.876993583904016*^9, 
   3.876993660896109*^9}, {3.876993716002076*^9, 3.876993716091022*^9}, {
   3.876999921051279*^9, 3.8769999835741653`*^9}, {3.877000135451353*^9, 
   3.8770001367177134`*^9}, {3.8770002434122553`*^9, 
   3.8770002789390078`*^9}, {3.87700037136974*^9, 3.877000392989847*^9}, {
   3.877000520125592*^9, 3.877000536276731*^9}, {3.8770007286724777`*^9, 
   3.877000902662283*^9}, {3.8770009398885813`*^9, 3.87700094028021*^9}, {
   3.877000975545061*^9, 3.8770009875300007`*^9}, {3.877001018450697*^9, 
   3.877001139307369*^9}, {3.877001265602689*^9, 3.877001397036653*^9}, {
   3.87700145352922*^9, 3.877001480443802*^9}, {3.8770021755486383`*^9, 
   3.877002246436224*^9}, {3.877002322475328*^9, 3.8770023317738867`*^9}, {
   3.87700238386043*^9, 3.8770025975733347`*^9}, {3.877002651321547*^9, 
   3.877002651531856*^9}, {3.877002726050808*^9, 3.877002830436611*^9}, {
   3.877002961346847*^9, 3.877002963693899*^9}, {3.877003051266088*^9, 
   3.877003051639925*^9}, {3.877003308813829*^9, 3.87700330913456*^9}, {
   3.882433582294565*^9, 3.882433589058144*^9}, {3.8836354787933197`*^9, 
   3.883635539718422*^9}, {3.883635576179627*^9, 3.883635657808833*^9}, 
   3.883635701936564*^9, {3.883635741051195*^9, 3.8836357744559383`*^9}, {
   3.8836358470634327`*^9, 3.883636136997737*^9}, {3.8836362825177107`*^9, 
   3.8836362893571157`*^9}, {3.8836363247713327`*^9, 3.883636365011752*^9}, 
   3.883636396527158*^9, {3.883838507783781*^9, 3.8838385079349413`*^9}, {
   3.883838539725791*^9, 3.883838540524043*^9}, {3.88407260099117*^9, 
   3.8840726466794443`*^9}, 3.884072704849024*^9, {3.884072789009433*^9, 
   3.8840727894958887`*^9}, {3.8840733379600267`*^9, 
   3.8840733397226067`*^9}, {3.8840945978286037`*^9, 3.884094601267701*^9}, {
   3.8840946380775146`*^9, 3.884094641620801*^9}, {3.884094674859715*^9, 
   3.884094685118129*^9}, {3.884094718577693*^9, 3.8840947242847433`*^9}, {
   3.884094776267663*^9, 3.884094833483856*^9}, {3.884097065117519*^9, 
   3.884097065357122*^9}, {3.884261031209105*^9, 3.884261031486607*^9}, {
   3.884261739601471*^9, 3.884261739834772*^9}, {3.8842617878574038`*^9, 
   3.884261787987755*^9}, {3.8842623141704483`*^9, 3.8842623155317173`*^9}, {
   3.884262358366569*^9, 3.884262369452229*^9}, {3.884262494118169*^9, 
   3.884262497539809*^9}, {3.88426264526369*^9, 3.884262648529092*^9}, {
   3.884263294954376*^9, 3.884263569533229*^9}, {3.89555595322753*^9, 
   3.895555963350122*^9}, {3.895561317204116*^9, 3.8955613354508266`*^9}, {
   3.8955662087409487`*^9, 3.8955662127611113`*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"f60c26c3-9869-49be-9a0e-e82ee5d8c8a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demo", "Subsubsection",
 CellChangeTimes->{{3.8955613480609083`*^9, 
  3.8955613563133*^9}},ExpressionUUID->"0d09c75c-4336-4627-9372-bcfc748516ee"],

Cell[TextData[{
 "Shuttle the ions around and perform an entanglement : initial and final \
configuration is shown.\n\nThis will show the total scheduling, noise \
operation, and the final form in the simulation.\nSet the",
 StyleBox[" MapQubits->False",
  FontWeight->"Bold"],
 " and",
 StyleBox[" ReplaceAliases->True",
  FontWeight->"Bold"],
 " if you intended to do the density matrix simulation.\n",
 StyleBox["InsertCircuitNoise ",
  FontWeight->"Bold"],
 "will update the state of ",
 StyleBox["dev",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.895556051785534*^9, 3.895556084033701*^9}, {
  3.895556170703742*^9, 3.895556201605975*^9}, {3.895556442049294*^9, 
  3.8955564561516037`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"6fa19595-4692-4ad3-90b8-49f16d63a9af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dev", "=", 
   RowBox[{"TrappedIonOxford", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.894385392078011*^9, 3.894385395653379*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"e0e61e79-6b77-4564-adaf-086a02d5c273"],

Cell[BoxData[
 RowBox[{"dev", "[", "ShowNodes", "]"}]], "Input",
 CellChangeTimes->{{3.894385398272482*^9, 3.894385414046989*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"9021932c-26db-41f0-bdf1-498d426c4af5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"circ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["Init", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}]], "[", "\"\<Alice\>\"", 
      "]"}], ",", 
     RowBox[{
      SubscriptBox["Splz", 
       RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
     RowBox[{
      SubscriptBox["Splz", 
       RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
     RowBox[{
      SubscriptBox["Shutl", 
       RowBox[{"4", ",", "3"}]], "[", 
      RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["Shutl", 
       RowBox[{"4", ",", "3"}]], "[", 
      RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["Splz", 
       RowBox[{"3", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
     RowBox[{
      SubscriptBox["Splz", 
       RowBox[{"3", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
     RowBox[{
      SubscriptBox["Shutl", "4"], "[", 
      RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["Shutl", "4"], "[", 
      RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
     RowBox[{
      SubscriptBox["Ent", 
       RowBox[{"4", ",", "4"}]], "[", 
      RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzl1IU3EABfD5mRlTChRGo1SGBDZxe0nMwe6aQxnbw7AIHLobbUkgbnvp
OmYPirAGbYlmJMXMZtmgFSE5UNcEpZVgy2Kic5UwxeEuac4JFqP/uQ+HH4fz
cipvdOuMuTweT0QCfa0jsqKNFEVPSuRw9N0XJaxPCFoge/OWhtsf82houCzu
gcknSRu8PubQ1xDls/c5xyeyRvhJ/bYHRlae9UJ/evoB5DcNB+H3+dEQnIwe
hWH1yyxnn7O/S0xUKDxmGLvXNghFV/ReeKF9YR5u6e4uwmHluW+Qbnqzy+0q
dh+q1KFj6LXsZeHcnrWglthd8rwYmk7Kz0D6b0MC1hXatuHno1Yf84v8GOL7
4Y9S4Xk78ZrPw1nnvhMb/0365tk4lJRfMh/ksVSIMTCw0+S2w8B6VS9kvv5z
Qn9H1AVfnLA9glOdfzjbw45V+GrodAo2xCuepomuMdlrKBUm3kN7+Oo0zKQy
ISiwRsJQf6ApOSTumwYoKMpWq2Bw6acGXpzJ0cEkXcw50rjTvJXPUuLlj2oY
eKgt2ybajyOc5lMWCUwNRKXwNmOhoDY+qIBGZWCltpClPliCa/A/31gzLw==

  "],
 CellLabel->
  "In[227]:=",ExpressionUUID->"39334818-453d-4215-b01f-6ad2ed45ee64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"circ2", "=", 
   RowBox[{"CircTrappedIons", "[", 
    RowBox[{"circ", ",", "dev", ",", 
     RowBox[{"MapQubits", "->", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisycirc", "=", 
   RowBox[{"InsertCircuitNoise", "[", 
    RowBox[{"circ2", ",", "dev", ",", " ", 
     RowBox[{"ReplaceAliases", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dev", "[", "ShowNodes", "]"}]}], "Input",
 CellChangeTimes->{{3.894385791238966*^9, 3.894385832766262*^9}, {
  3.895556098422262*^9, 3.895556101135045*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"71410c7e-f05e-4826-825b-04095afafaf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"the", " ", "actual", " ", "circuit"}], "+", 
    RowBox[{
    "noise", " ", "that", " ", "is", " ", "run", " ", "on", " ", "the", " ", 
     "simulation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"DrawCircuit", "[", 
   RowBox[{"noisycirc", ",", "8"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8735365427377977`*^9, 3.873536635876189*^9}, {
   3.873539396712269*^9, 3.873539403859277*^9}, {3.875697389882848*^9, 
   3.8756973979789343`*^9}, {3.87569943733666*^9, 3.875699442348497*^9}, {
   3.875784066537302*^9, 3.875784074430694*^9}, {3.8757842173800793`*^9, 
   3.875784233763261*^9}, {3.8757843318838377`*^9, 3.875784355751664*^9}, {
   3.875784760266287*^9, 3.875784765461773*^9}, {3.875784957365838*^9, 
   3.875784998855071*^9}, {3.875790969089532*^9, 3.8757909796434193`*^9}, {
   3.8758184889942837`*^9, 3.8758184926305323`*^9}, 3.8837347098342876`*^9, 
   3.894110794363722*^9, 3.89488257736831*^9, 3.894882608746228*^9, 
   3.8955561358924913`*^9, {3.89555646689579*^9, 3.895556478825173*^9}, {
   3.895556510432971*^9, 3.895556524942173*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"d6f1e258-c049-4570-8952-bb2893609008"],

Cell["\<\
Check the arrangement of the circuit in the total density matrix. Here is \
completely serial within a node.
It does not update the device state, thus we cannot check the final position \
of ions.
The first half (from below) belongs to Alice and another half belongs to Bob\
\>", "Text",
 CellChangeTimes->{{3.8735358044989357`*^9, 3.8735358152137203`*^9}, {
   3.8735362827709*^9, 3.8735363463458776`*^9}, {3.873536412650112*^9, 
   3.873536440021015*^9}, 3.895556188483624*^9, {3.8955662522017384`*^9, 
   3.8955662748742647`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7dae8c7a-ebe8-4914-93d1-8e3024725605"],

Cell[BoxData[
 RowBox[{"DrawCircuit", "@", 
  RowBox[{"CircTrappedIons", "[", 
   RowBox[{"circ", ",", "dev", ",", 
    RowBox[{"MapQubits", "->", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8735356166506577`*^9, 3.8735356294032717`*^9}, {
   3.8735357581820583`*^9, 3.8735357592668552`*^9}, {3.87353625886707*^9, 
   3.873536259191338*^9}, {3.875697326741803*^9, 3.8756973294968157`*^9}, {
   3.8756994329139137`*^9, 3.875699433317068*^9}, 3.875784055766596*^9, {
   3.884081687243329*^9, 3.884081697548759*^9}, 3.894110786811555*^9, {
   3.8948827476793423`*^9, 3.894882774534812*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"797106b3-7c71-46e2-9680-68c6566ce39f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DestroyAllQuregs", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"CreateDensityQureg", "[", "8", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[233]:=",ExpressionUUID->"0e5d8bf2-f763-4d13-a0a8-6241d4c6798d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ApplyCircuit", "[", 
   RowBox[{"\[Rho]", ",", 
    RowBox[{"ExtractCircuit", "@", "noisycirc"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PlotDensityMatrix", "[", 
  RowBox[{
   RowBox[{"mat2BellBasis", "@", 
    RowBox[{"PartialTrace", "[", 
     RowBox[{
     "\[Rho]", ",", "0", ",", "1", ",", "2", ",", "4", ",", "5", ",", "6"}], 
     "]"}]}], ",", 
   RowBox[{"Sequence", "@@", 
    RowBox[{"chartbell", "[", "\"\<\>\"", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.873541681637575*^9, 3.873541751424814*^9}, {
   3.8757841205386143`*^9, 3.8757841294918327`*^9}, {3.8757842467170897`*^9, 
   3.875784337040402*^9}, {3.875784825198759*^9, 3.875784841719986*^9}, 
   3.875784875955913*^9, {3.875785077800418*^9, 3.875785105591632*^9}, {
   3.875821981083705*^9, 3.875821983105031*^9}, {3.883497350493561*^9, 
   3.883497396711956*^9}, {3.883736787115781*^9, 3.883736848601947*^9}, {
   3.884193207703971*^9, 3.884193290550873*^9}, {3.884193325691534*^9, 
   3.884193400978759*^9}, {3.884272868230268*^9, 3.884272871822279*^9}, {
   3.894965672666727*^9, 3.8949656778515778`*^9}, 3.895555907175069*^9},
 CellLabel->
  "In[235]:=",ExpressionUUID->"b16782ff-ea3f-4153-83cb-c675797578e7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Paper supplement", "Section",
 CellChangeTimes->{{3.8955565755419188`*^9, 
  3.895556579150084*^9}},ExpressionUUID->"4d518824-3f83-4b77-a8e8-\
2e70512d2626"],

Cell[TextData[{
 "4-ions entanglement distillation on each node for up to 3 rounds\n\n",
 StyleBox["0 = dephasing distillation\n1 = bitflip distillation",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.895556607010174*^9, 3.895556668409751*^9}},
 FontSize->18,ExpressionUUID->"05c61d37-69ab-4228-821a-8220f8441e07"],

Cell[CellGroupData[{

Cell["The modules", "Subsection",
 CellChangeTimes->{{3.875818684979363*^9, 3.875818696723239*^9}, {
   3.875818729119232*^9, 3.875818729561054*^9}, {3.8762080470437*^9, 
   3.8762080533448467`*^9}, {3.876213822279415*^9, 3.876213826446898*^9}, {
   3.8837383289332848`*^9, 3.883738331003879*^9}, {3.884079645705339*^9, 
   3.884079660895196*^9}, {3.884079870922406*^9, 3.8840798880285473`*^9}, 
   3.895556565648818*^9, {3.895556677082439*^9, 3.895556678665353*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"2346cce6-bd8a-4ae4-88e1-f897966b2804"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Bit", "-", 
    RowBox[{"Flip", " ", "distillation", " ", 
     RowBox[{"operation", ":", " ", 
      RowBox[{"The", " ", "CNOT", " ", "equivalent"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cx", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["Ry", "1"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["C", "0"], "[", 
        SubscriptBox["Z", "1"], "]"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "1"], "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Phase", "-", 
     RowBox[{"flip", " ", 
      RowBox[{"distillation", ":", " ", 
       RowBox[{"Alice", " ", "and", " ", "Bob"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pfa", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["Ry", "0"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["C", "0"], "[", 
        SubscriptBox["Z", "1"], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rx", "1"], "[", "\[Pi]", "]"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "1"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pfb", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["Ry", "0"], "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["C", "0"], "[", 
        SubscriptBox["Z", "1"], "]"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "1"], "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.883653975430418*^9, 3.883653985077478*^9}, {
   3.883654079944396*^9, 3.883654085269121*^9}, {3.88365415925456*^9, 
   3.88365423086073*^9}, {3.883654621752829*^9, 3.883654642255464*^9}, {
   3.883654969453896*^9, 3.883654978124701*^9}, {3.8837349450323963`*^9, 
   3.883734998802987*^9}, {3.88373504207271*^9, 3.883735065120805*^9}, 
   3.883735105132169*^9, {3.883836612826042*^9, 3.883836624257846*^9}, {
   3.883836661150372*^9, 3.8838367166955214`*^9}, {3.8838368900907993`*^9, 
   3.883836911376781*^9}, {3.883837179133024*^9, 3.88383723279764*^9}, {
   3.8838375989694777`*^9, 3.8838376062051983`*^9}, {3.88383821555481*^9, 
   3.8838382157349253`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"ac997f37-7bc1-4400-8f6f-8e60e3a8e708"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"heraldout", "::", "usage"}], "=", 
   "\"\<heraldout[outputs]. Check if all outputs 00 or 11 in all measurement \
outcomes.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"heraldout", "[", "out_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fout", "=", 
      RowBox[{"Flatten", "@", "out"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "fout"}], ">", "1"}], ",", 
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{"Equal", "@@@", 
         RowBox[{"Partition", "[", 
          RowBox[{"fout", ",", "2"}], "]"}]}], ")"}]}], ",", "True"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.883835043449711*^9, 3.883835070239751*^9}, {
   3.883837383857931*^9, 3.883837410957073*^9}, {3.883837625470355*^9, 
   3.8838376323750134`*^9}, {3.883837701134677*^9, 3.8838377368957663`*^9}, {
   3.883837814318387*^9, 3.883837815347845*^9}, {3.883837877413435*^9, 
   3.8838378840300627`*^9}, 3.883838222608015*^9, {3.884080736538555*^9, 
   3.884080784645895*^9}, {3.884081593524494*^9, 3.8840815939179688`*^9}, {
   3.884082001141953*^9, 3.884082001393683*^9}, {3.88409022039701*^9, 
   3.884090239470017*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"f4deb039-2160-42a2-8905-5af66b54d369"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"distcirc", "[", 
     RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"dephasing", " ", "distillation", " ", "sequence"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"0", "->", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["Ry", "p"], "[", 
           RowBox[{"\"\<Alice\>\"", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["Ry", "p"], "[", 
           RowBox[{"\"\<Bob\>\"", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["CZ", 
            RowBox[{"p", ",", "q"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
          RowBox[{
           SubscriptBox["CZ", 
            RowBox[{"p", ",", "q"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
          RowBox[{
           SubscriptBox["Ry", "q"], "[", 
           RowBox[{"\"\<Alice\>\"", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["Rx", "p"], "[", 
           RowBox[{"\"\<Alice\>\"", ",", "\[Pi]"}], "]"}], ",", 
          RowBox[{
           SubscriptBox["Ry", "q"], "[", 
           RowBox[{"\"\<Bob\>\"", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"bitflip", " ", "distillation", " ", "sequence"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"1", "->", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["Ry", "q"], "[", 
           RowBox[{"\"\<Alice\>\"", ",", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["Ry", "q"], "[", 
           RowBox[{"\"\<Bob\>\"", ",", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["CZ", 
            RowBox[{"p", ",", "q"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
          RowBox[{
           SubscriptBox["CZ", 
            RowBox[{"p", ",", "q"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
          RowBox[{
           SubscriptBox["Ry", "q"], "[", 
           RowBox[{"\"\<Alice\>\"", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ",", 
          RowBox[{
           SubscriptBox["Ry", "q"], "[", 
           RowBox[{"\"\<Bob\>\"", ",", 
            RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Distillation", " ", "on", " ", "4", " ", "ions", " ", "on", " ", "each", 
     " ", "nodes"}], ",", " ", 
    RowBox[{
    "up", " ", "to", " ", "3", " ", "rounds", " ", "of", " ", 
     "distillation"}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistCircTrappedIons4", "::", "usage"}], "=", 
   "\"\<DistillationOnTrappedIons4[sequence]. Distillation on 4-ions of two \
nodes. Works up to 3 rounds. Sequence contains 0 (dephasing) or 1 (bit-flip). \
Qubit 4 is always the final qubit.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistCircTrappedIons4", "[", 
    RowBox[{"sequence_", ":", 
     RowBox[{"{", "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"circ", ",", "nrounds"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nrounds", "=", 
       RowBox[{"Length", "@", "sequence"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"raw", " ", "entangled", " ", "pairs"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"circ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["Splz", 
           RowBox[{"3", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
         RowBox[{
          SubscriptBox["Splz", 
           RowBox[{"3", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
         RowBox[{
          SubscriptBox["Shutl", "4"], "[", 
          RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["Shutl", "4"], "[", 
          RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["Ent", 
           RowBox[{"4", ",", "4"}]], "[", 
          RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nrounds", ">=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"circ", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"circ", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["Shutl", "4"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "4"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"3", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"3", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Ent", 
               RowBox[{"3", ",", "3"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "4"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "4"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              RowBox[{"distcirc", "[", 
               RowBox[{"4", ",", "3"}], "]"}], "[", 
              RowBox[{"sequence", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Bob\>\"", "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nrounds", ">=", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{"circ", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"circ", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Ent", 
               RowBox[{"3", ",", "3"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"1", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"1", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"1", ",", "2"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"1", ",", "2"}]], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"2", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"2", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"3", ",", "2"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"2", ",", "3"}]], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Ent", 
               RowBox[{"2", ",", "2"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              RowBox[{"distcirc", "[", 
               RowBox[{"3", ",", "2"}], "]"}], "[", 
              RowBox[{"sequence", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "2"], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "2"], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              RowBox[{"distcirc", "[", 
               RowBox[{"4", ",", "3"}], "]"}], "[", 
              RowBox[{"sequence", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"1", ",", "4"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"1", ",", "4"}]], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Bob\>\"", "]"}]}], "}"}]}],
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nrounds", ">=", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{"circ", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"circ", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"1", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"1", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"1", ",", "4"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"1", ",", "4"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Ent", 
               RowBox[{"2", ",", "2"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"3", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Ent", 
               RowBox[{"3", ",", "3"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}], " ", ",", 
             
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              RowBox[{"distcirc", "[", 
               RowBox[{"2", ",", "3"}], "]"}], "[", 
              RowBox[{"sequence", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Ent", 
               RowBox[{"3", ",", "3"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "1"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "1"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"1", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"1", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"1", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"1", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "1"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "1"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"1", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"1", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"1", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["SWAPLoc", 
               RowBox[{"1", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "1"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "1"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "4"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Ent", 
               RowBox[{"1", ",", "1"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "\"\<Bob\>\""}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "1"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "1"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"3", ",", "1"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              RowBox[{"distcirc", "[", 
               RowBox[{"3", ",", "1"}], "]"}], "[", 
              RowBox[{"sequence", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "1"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"3", ",", "1"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "1"], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "1"], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              RowBox[{"distcirc", "[", 
               RowBox[{"2", ",", "3"}], "]"}], "[", 
              RowBox[{"sequence", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"2", ",", "3"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "2"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "3"], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "3"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "3"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"4", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Comb", 
               RowBox[{"4", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"4", ",", "2"}]], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", 
               RowBox[{"4", ",", "2"}]], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "2"}], "]"}], ",", 
             RowBox[{
              RowBox[{"distcirc", "[", 
               RowBox[{"4", ",", "2"}], "]"}], "[", 
              RowBox[{"sequence", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "2"}]], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Splz", 
               RowBox[{"4", ",", "2"}]], "[", "\"\<Bob\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "4"], "[", 
              RowBox[{"\"\<Alice\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Shutl", "4"], "[", 
              RowBox[{"\"\<Bob\>\"", ",", "1"}], "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "2"], "[", "\"\<Alice\>\"", "]"}], ",", 
             RowBox[{
              SubscriptBox["Read", "2"], "[", "\"\<Bob\>\"", "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "circ"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.87620792856719*^9, 3.876208001117175*^9}, {
   3.876215274728503*^9, 3.876215286554634*^9}, 3.876368572111559*^9, {
   3.876898388264534*^9, 3.876898407945396*^9}, {3.876899123274891*^9, 
   3.876899125520397*^9}, {3.8769003621229343`*^9, 3.876900570722139*^9}, {
   3.876901507655105*^9, 3.876901521012465*^9}, {3.876901562830941*^9, 
   3.876901700810974*^9}, {3.876901737290105*^9, 3.8769017745840597`*^9}, {
   3.8769029812159567`*^9, 3.876903130938057*^9}, {3.876903182766803*^9, 
   3.876903205359367*^9}, {3.876903386401197*^9, 3.8769034017393093`*^9}, {
   3.8769034423148613`*^9, 3.876903490562669*^9}, {3.876903658540641*^9, 
   3.876903659196698*^9}, {3.8769037564198303`*^9, 3.876903930751568*^9}, {
   3.8769039762085114`*^9, 3.876904162653749*^9}, 3.8769045632535877`*^9, {
   3.876904609290498*^9, 3.8769047284197617`*^9}, {3.876904959118281*^9, 
   3.87690498909181*^9}, {3.8769050776955853`*^9, 3.8769050930437813`*^9}, {
   3.876905135976798*^9, 3.876905201046363*^9}, {3.876905321801763*^9, 
   3.87690540383673*^9}, {3.876909092402619*^9, 3.87690909686765*^9}, 
   3.876909139837875*^9, {3.8769092234075317`*^9, 3.8769092484472227`*^9}, {
   3.8769094827920513`*^9, 3.8769094873521843`*^9}, {3.876909527992535*^9, 
   3.876909535818157*^9}, {3.876909721158576*^9, 3.8769097330445547`*^9}, {
   3.8769098464751*^9, 3.876909889513278*^9}, {3.8769099697651033`*^9, 
   3.8769100162364197`*^9}, {3.876910081894308*^9, 3.8769101831960993`*^9}, {
   3.876910226926647*^9, 3.876910227842403*^9}, {3.8769103787365713`*^9, 
   3.8769103877695723`*^9}, {3.87691124626353*^9, 3.8769112687363577`*^9}, {
   3.876914671943985*^9, 3.876914686028928*^9}, {3.876914722197845*^9, 
   3.8769148241894407`*^9}, {3.87691486099616*^9, 3.876914888800036*^9}, {
   3.8769778330094833`*^9, 3.876977898499495*^9}, {3.8769779423310337`*^9, 
   3.876977985867684*^9}, {3.876978068390196*^9, 3.8769780694235086`*^9}, 
   3.876978181222357*^9, {3.876978269161131*^9, 3.876978299375598*^9}, {
   3.876978336467092*^9, 3.8769783765719643`*^9}, {3.876978489696673*^9, 
   3.876978490368764*^9}, {3.876978526087816*^9, 3.87697852987707*^9}, {
   3.876978764813871*^9, 3.876978765028966*^9}, {3.876978859817518*^9, 
   3.876979024759413*^9}, {3.876979083679274*^9, 3.876979136998642*^9}, {
   3.87698337652905*^9, 3.876983387522605*^9}, {3.87699263664384*^9, 
   3.876992637215336*^9}, {3.8770634248050547`*^9, 3.877063480349205*^9}, {
   3.8770635429910393`*^9, 3.8770635462093267`*^9}, {3.877063582230268*^9, 
   3.877063671188808*^9}, {3.877063715631505*^9, 3.877063736113052*^9}, {
   3.8770637702654953`*^9, 3.8770638286021023`*^9}, {3.8770638628875313`*^9, 
   3.877063887626519*^9}, {3.877063931227439*^9, 3.877063975718758*^9}, {
   3.877064110023369*^9, 3.877064110547914*^9}, {3.87706423121316*^9, 
   3.877064311601922*^9}, {3.877064389302431*^9, 3.877064431811108*^9}, {
   3.877064486078033*^9, 3.8770644877445374`*^9}, {3.877064697923168*^9, 
   3.87706470542083*^9}, {3.8801834338661327`*^9, 3.880183444276075*^9}, {
   3.8801835301964197`*^9, 3.880183530887624*^9}, {3.880183734820613*^9, 
   3.880183805158581*^9}, {3.8801839034183817`*^9, 3.880184114067206*^9}, {
   3.880184263414304*^9, 3.8801845286422443`*^9}, {3.880184560974984*^9, 
   3.8801845725945044`*^9}, {3.880184619016617*^9, 3.880184706152402*^9}, {
   3.880184793232697*^9, 3.8801849051561604`*^9}, {3.8801850087660513`*^9, 
   3.8801850855951014`*^9}, {3.880185122161281*^9, 3.88018514642382*^9}, {
   3.8801852458905983`*^9, 3.880185280887958*^9}, {3.8801853743207197`*^9, 
   3.880185399585359*^9}, {3.880185636093677*^9, 3.88018565352122*^9}, {
   3.880185690414103*^9, 3.880185712727826*^9}, {3.880185753280694*^9, 
   3.880185754961944*^9}, 3.880186401320457*^9, {3.880186431464942*^9, 
   3.8801864692306623`*^9}, {3.880186524003654*^9, 3.8801865286296997`*^9}, {
   3.880186571864935*^9, 3.880186672724009*^9}, {3.880186738294354*^9, 
   3.8801868514194183`*^9}, {3.880186912485648*^9, 3.880187005540408*^9}, {
   3.8801870381971693`*^9, 3.880187041191223*^9}, {3.8801871962366867`*^9, 
   3.880187239511981*^9}, {3.88018727675572*^9, 3.8801874353264227`*^9}, {
   3.880188266050478*^9, 3.8801883218493357`*^9}, {3.883649758572068*^9, 
   3.883649893830846*^9}, 3.883738383471098*^9, {3.883738856847501*^9, 
   3.883738892346155*^9}, {3.8837402866956863`*^9, 3.883740295145094*^9}, 
   3.883740988080159*^9, {3.8838124152872868`*^9, 3.88381241789563*^9}, {
   3.883812448267826*^9, 3.8838124510715437`*^9}, {3.8838131555411243`*^9, 
   3.883813164429792*^9}, {3.883813204197668*^9, 3.883813318877781*^9}, {
   3.883813373571864*^9, 3.883813408929112*^9}, {3.883813440409885*^9, 
   3.8838134735687532`*^9}, {3.8838135049297543`*^9, 3.883813596590136*^9}, {
   3.883813656680788*^9, 3.883813714245866*^9}, {3.883813846098296*^9, 
   3.883814099949994*^9}, {3.8838145567025347`*^9, 3.8838145591809673`*^9}, {
   3.883814920421926*^9, 3.883814949033518*^9}, {3.8838152117398863`*^9, 
   3.883815214577798*^9}, {3.883815278985169*^9, 3.883815304255389*^9}, {
   3.8838154177788277`*^9, 3.883815426965074*^9}, {3.883815854080496*^9, 
   3.883815862003888*^9}, 3.8838159120034447`*^9, {3.883816038743217*^9, 
   3.883816049359736*^9}, {3.8838160842810698`*^9, 3.8838161714247503`*^9}, {
   3.883816233221674*^9, 3.883816245587707*^9}, {3.883817189994882*^9, 
   3.8838172224507713`*^9}, {3.883818739760007*^9, 3.883818754891959*^9}, 
   3.883818885599372*^9, {3.8838190862593603`*^9, 3.883819090037797*^9}, {
   3.883820035363268*^9, 3.883820042524913*^9}, {3.88382009946449*^9, 
   3.883820101889892*^9}, {3.883820335229772*^9, 3.8838203440469418`*^9}, {
   3.883820375357966*^9, 3.883820378956004*^9}, 3.883820442425919*^9, {
   3.883820497979906*^9, 3.883820521772489*^9}, {3.8838205705975437`*^9, 
   3.8838205753113317`*^9}, {3.88382060879078*^9, 3.883820847609994*^9}, {
   3.883820914500456*^9, 3.8838209413473787`*^9}, {3.883821038136866*^9, 
   3.883821079910884*^9}, {3.8838211583304577`*^9, 3.883821280245207*^9}, {
   3.883821319818029*^9, 3.8838214402617903`*^9}, {3.8838215204829273`*^9, 
   3.883821523830439*^9}, {3.883821608967332*^9, 3.883821610190332*^9}, 
   3.883825472987875*^9, {3.883825526702983*^9, 3.88382568153966*^9}, {
   3.883825720770731*^9, 3.883825856745634*^9}, {3.883826006924542*^9, 
   3.883826029463317*^9}, {3.8838260932242517`*^9, 3.8838261585895853`*^9}, {
   3.883826198943248*^9, 3.883826434118349*^9}, {3.883826469215946*^9, 
   3.883826585319373*^9}, {3.88382664303329*^9, 3.883826654781797*^9}, {
   3.883826693327004*^9, 3.8838267187537947`*^9}, {3.8838267785260887`*^9, 
   3.883826810108677*^9}, {3.883827047594154*^9, 3.883827059868754*^9}, {
   3.883827165329288*^9, 3.883827166151999*^9}, {3.883827468543154*^9, 
   3.883827661258276*^9}, {3.883827692123292*^9, 3.883827696378014*^9}, {
   3.8838325552488947`*^9, 3.88383256206841*^9}, {3.8838387341427727`*^9, 
   3.8838387826240873`*^9}, {3.883839578894528*^9, 3.883839596826798*^9}, {
   3.8840136514235697`*^9, 3.884013676450835*^9}, 3.884015155121134*^9, {
   3.884015187819789*^9, 3.884015268289258*^9}, {3.8840152993472652`*^9, 
   3.884015329482113*^9}, {3.88401541766511*^9, 3.88401541858711*^9}, {
   3.884015576597616*^9, 3.8840156528179817`*^9}, {3.8840157168952703`*^9, 
   3.884015725838128*^9}, {3.884015848087672*^9, 3.884015849735177*^9}, {
   3.8840159046144876`*^9, 3.884015913898958*^9}, {3.8840162947134027`*^9, 
   3.884016330907258*^9}, {3.884018212860681*^9, 3.88401831158992*^9}, {
   3.8840226045402*^9, 3.884022863984379*^9}, {3.884023403588883*^9, 
   3.884023405955585*^9}, {3.884023437405758*^9, 3.88402343844523*^9}, {
   3.884023664772504*^9, 3.884023665874771*^9}, {3.884078916119878*^9, 
   3.8840790022806187`*^9}, {3.8840790448825083`*^9, 3.88407907413173*^9}, {
   3.88407920683447*^9, 3.884079243849283*^9}, {3.884079277083838*^9, 
   3.88407934632056*^9}, 3.884079529414043*^9, {3.884079573255114*^9, 
   3.884079642813552*^9}, {3.884079934569656*^9, 3.884080026887967*^9}, {
   3.884080356689108*^9, 3.884080504906933*^9}, 3.88408085397488*^9, {
   3.884080932032104*^9, 3.884080937919712*^9}, 3.8840811033550873`*^9, {
   3.884081385009315*^9, 3.884081448235317*^9}, {3.884081563532221*^9, 
   3.884081567737132*^9}, 3.8840817049420967`*^9, {3.884081836102024*^9, 
   3.884081841771434*^9}, {3.884082043544448*^9, 3.8840820492865143`*^9}, {
   3.884082144079009*^9, 3.8840822915463676`*^9}, {3.884082408311798*^9, 
   3.884082487359342*^9}, {3.884082565603445*^9, 3.8840826209332523`*^9}, {
   3.884082668636178*^9, 3.88408273423881*^9}, {3.884082816829908*^9, 
   3.88408290700161*^9}, {3.8840829451700277`*^9, 3.8840830372137737`*^9}, {
   3.884083088029798*^9, 3.884083089013269*^9}, {3.884083273227541*^9, 
   3.8840832872871113`*^9}, {3.884083364407957*^9, 3.884083415590907*^9}, {
   3.8840835723745413`*^9, 3.8840842113893538`*^9}, 3.884084269499523*^9, {
   3.88408493596192*^9, 3.884084936991332*^9}, {3.884084994860001*^9, 
   3.88408504360075*^9}, {3.884185308506421*^9, 3.8841853442005577`*^9}, {
   3.894389498534193*^9, 3.894389550837973*^9}, {3.894389807526718*^9, 
   3.894389831520404*^9}, {3.894389945786174*^9, 3.894390084789009*^9}, {
   3.8943901363628187`*^9, 3.894390140569495*^9}, {3.8943905457606573`*^9, 
   3.894390553849627*^9}, {3.894390623181291*^9, 3.89439067726268*^9}, {
   3.894390801790567*^9, 3.8943909371822367`*^9}, {3.894390976983129*^9, 
   3.894391003023488*^9}, {3.8943910447117662`*^9, 3.894391108126068*^9}, {
   3.894391145900565*^9, 3.894391190367807*^9}, {3.8943912211785173`*^9, 
   3.894391405915073*^9}, {3.8943914467284803`*^9, 3.894391478371379*^9}, {
   3.89439158233222*^9, 3.8943916082220182`*^9}, {3.894391703532167*^9, 
   3.894391735902006*^9}, 3.8943917755640583`*^9, {3.894391815804783*^9, 
   3.894391922453916*^9}, {3.894391961553596*^9, 3.894391988444161*^9}, {
   3.894392057815938*^9, 3.894392115602552*^9}, {3.894392145961156*^9, 
   3.894392421879208*^9}, {3.8943924645195293`*^9, 3.894392745229598*^9}, 
   3.8943951383786182`*^9, {3.895556702357575*^9, 3.895556702716022*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"87274038-e121-4cf6-9854-097f3a94bf01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"circ", "=", 
   RowBox[{"DistCircTrappedIons4", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dev", "=", 
   RowBox[{"TrappedIonOxford", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circ2", "=", 
   RowBox[{"CircTrappedIons", "[", 
    RowBox[{"circ", ",", "dev", ",", 
     RowBox[{"MapQubits", "->", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisycirc", "=", 
   RowBox[{"InsertCircuitNoise", "[", 
    RowBox[{"circ2", ",", "dev", ",", " ", 
     RowBox[{"ReplaceAliases", "->", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"dev", "[", "ShowNodes", "]"}]}], "Input",
 CellChangeTimes->{{3.894389616925723*^9, 3.8943896323339767`*^9}, {
   3.894389683032153*^9, 3.894389791755445*^9}, 3.894389907585883*^9, 
   3.894389975015576*^9, {3.89439095029637*^9, 3.894390965184165*^9}, 
   3.8943917394571133`*^9, {3.894392004285318*^9, 3.8943920314263487`*^9}, {
   3.8943921567436743`*^9, 3.89439215712601*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"e2c13b9e-6493-4273-bffb-d347d86e3701"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Play around with the parameters ", "Subsection",
 CellChangeTimes->{{3.876985491179178*^9, 3.87698551374761*^9}, {
  3.876985561194066*^9, 3.876985567912353*^9}, {3.8769863863729887`*^9, 
  3.876986387563737*^9}, {3.883738649995586*^9, 3.88373867507825*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"b5ebd345-aa7c-4daf-9611-4bab62c48860"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TIonDist", "::", "usage"}], "=", 
   "\"\<TIonDist[\[Rho],sequence:{},device_option:{}]. Distillation \
simulation on trapped ions.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TIonDist", "[", 
   RowBox[{"\[Rho]_", ",", 
    RowBox[{"sequence_", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"devoptions_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dev", ",", "circ", ",", "noisysch", ",", "noisycirc", ",", "nions"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dev", "=", 
      RowBox[{"TrappedIonOxford", "[", 
       RowBox[{"Sequence", "@@", "devoptions"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nions", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Length", "/@", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"Values", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"dev", "[", "Nodes", "]"}]}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"circ", "=", 
      RowBox[{"DistCircTrappedIons4", "[", "sequence", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"noisysch", "=", 
      RowBox[{"InsertCircuitNoise", "[", 
       RowBox[{
        RowBox[{"CircTrappedIons", "[", 
         RowBox[{"circ", ",", "dev", ",", 
          RowBox[{"MapQubits", "->", "False"}]}], "]"}], ",", "dev", ",", 
        RowBox[{"ReplaceAliases", "->", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"noisycirc", "=", 
      RowBox[{"ExtractCircuit", "@", "noisysch"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"Not", "@", 
       RowBox[{"heraldout", "@", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{"\[Rho]", ",", "noisycirc"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "noisysch"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seqlabel", "[", "l_List", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"conv", "=", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "->", "\"\<ph\>\""}], ",", 
        RowBox[{"1", "->", "\"\<bf\>\""}]}], "|>"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "l"}], ">", "0"}], ",", 
      RowBox[{"StringRiffle", "[", 
       RowBox[{
        RowBox[{"conv", "/@", "l"}], ",", "\"\<,\>\""}], "]"}], ",", 
      "\"\<raw\>\""}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQHdSzdsal928cS5Z9BdPfzt5aAqIbxB+A6XXxS6+C
6O/rC6+BxVf63wPRq7xDwbROcvWmq0D61dTX20B0TNS0q9eA9JMXCrdB9KUO
X07tD28cbRYHgen8uTpOIPpBCq8riPZTtgsF0Se2TQfT55x020H0HF9bML1i
3q5+EN3g+ngiiP4qFHoCbJ5pFJhe5njiMYgW4mZ8AqJrF2o1GQDpe8F6rSBa
QadYzRtIi3i2GYJoJobFISA6489OMP3n3f03ILr+tedbEJ02jf0biJ5xw+YH
iJbynv0XRL95nv0PbM6ZN7w+IHPv7uAH0YcuPlMF0TnLTNVA9N8XfMUg+mrl
LjCtUjv/B4ie4pn/H0R/Sj5w0xdIF5Ux3gLRm1Z0ZHwB+fv/nBIQfSje/ake
21tHrvDPYBoAadPyCA==
  "],
 CellLabel->
  "In[250]:=",ExpressionUUID->"d3ef4b57-c915-44e7-a2dd-e988c9b334d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DestroyAllQuregs", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]8", "=", 
   RowBox[{"CreateDensityQureg", "[", "8", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.884080520117523*^9, 3.884080529969091*^9}, {
  3.8840808828844233`*^9, 3.884080886702765*^9}, {3.884252329713835*^9, 
  3.884252332653784*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"d48cda91-007d-4a92-a018-55359e2beb65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plot\[Rho]8", "[", 
   RowBox[{"label_", ",", 
    RowBox[{"raster_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"plot", "=", 
      RowBox[{"PlotDensityMatrix", "[", 
       RowBox[{
        RowBox[{"Chop", "@", 
         RowBox[{"mat2BellBasis", "[", 
          RowBox[{"PartialTrace", "[", 
           RowBox[{
           "\[Rho]8", ",", "0", ",", "1", ",", "2", ",", "4", ",", "5", ",", 
            "6"}], "]"}], "]"}]}], ",", 
        RowBox[{"ViewPoint", "->", 
         RowBox[{"{", 
          RowBox[{"\[Pi]", ",", 
           RowBox[{
            RowBox[{"-", "2"}], "\[Pi]"}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"chartbell", "[", "label", "]"}]}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"raster", ",", "\[IndentingNewLine]", 
      RowBox[{"Rasterize", "[", 
       RowBox[{"plot", ",", 
        RowBox[{"RasterSize", "->", "Full"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "raster"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.883840105600441*^9, 3.883840120331955*^9}, 
   3.884073126907152*^9, {3.884079803119749*^9, 3.8840798545223103`*^9}, {
   3.8842505757635813`*^9, 3.884250602039383*^9}, {3.884259584115641*^9, 
   3.884259592104947*^9}, {3.88426007828642*^9, 3.884260097614106*^9}, {
   3.884260133688654*^9, 3.884260134716859*^9}, {3.884261325015828*^9, 
   3.884261377370496*^9}, {3.884261419858343*^9, 3.884261462766596*^9}, {
   3.88476851647145*^9, 3.8847685936416187`*^9}, {3.884768938751589*^9, 
   3.884768964994402*^9}, {3.894392766946554*^9, 3.894392767673459*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"d7c1c783-cec8-462f-838c-0b4172fe2dec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"devoptions", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.884252497687302*^9, 3.8842525002318296`*^9}, {
   3.884260589817398*^9, 3.8842606043956423`*^9}, {3.88426080900776*^9, 
   3.8842608095091553`*^9}, {3.884260849128395*^9, 3.884260859695969*^9}, 
   3.884261045011009*^9, {3.8844252292273827`*^9, 3.8844252361916933`*^9}, {
   3.884427799152611*^9, 3.884427803959045*^9}, 3.8847684647337646`*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"bb61045a-5708-4fa8-8e50-1a90d6b07112"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Round 0-1\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"round1", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"round1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TIonDist", "[", 
           RowBox[{"\[Rho]8", ",", "#", ",", "devoptions"}], "]"}], ",", 
          RowBox[{"seqlabel", "@", "#"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"plot\[Rho]8", "[", 
       RowBox[{
        RowBox[{"seqlabel", "@", "#"}], ",", "True"}], "]"}]}], ")"}], "&"}], 
   "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.876983759899682*^9, 3.87698379497071*^9}, 
   3.876985488589458*^9, {3.876985524227214*^9, 3.876985555349738*^9}, 
   3.8769863950223417`*^9, {3.876986435955969*^9, 3.876986464965557*^9}, {
   3.8769865456430883`*^9, 3.876986545773653*^9}, {3.8770032151413603`*^9, 
   3.877003255082529*^9}, {3.88243346757747*^9, 3.8824334791260567`*^9}, {
   3.883644486989978*^9, 3.883644499083667*^9}, {3.883644606379937*^9, 
   3.883644646496933*^9}, {3.883644727628627*^9, 3.883644737742907*^9}, {
   3.8836447755040503`*^9, 3.883644778009343*^9}, {3.883644817780237*^9, 
   3.883644828396139*^9}, {3.883645491334634*^9, 3.8836454938018293`*^9}, {
   3.8836456248860617`*^9, 3.883645637821274*^9}, {3.883645690210877*^9, 
   3.883645702222929*^9}, {3.883645812784143*^9, 3.883645819130237*^9}, {
   3.883645884049765*^9, 3.883645906453459*^9}, {3.883646013708105*^9, 
   3.883646024401319*^9}, {3.883646072141158*^9, 3.883646082415362*^9}, {
   3.883646116929978*^9, 3.8836461681336184`*^9}, {3.883646223452014*^9, 
   3.883646225368339*^9}, {3.883646644317369*^9, 3.8836466487445107`*^9}, {
   3.883646903281111*^9, 3.883646905253477*^9}, {3.883647068588375*^9, 
   3.8836470707090683`*^9}, {3.883653341740408*^9, 3.883653437810686*^9}, {
   3.8837385410075893`*^9, 3.883738553468547*^9}, {3.8837387041686172`*^9, 
   3.8837387960125732`*^9}, {3.883738832292583*^9, 3.88373883266717*^9}, {
   3.883738908557166*^9, 3.883739059327589*^9}, {3.883821777363483*^9, 
   3.883821778276778*^9}, {3.883821826723984*^9, 3.883821828697918*^9}, {
   3.883821888492304*^9, 3.883822103230908*^9}, {3.883825869922744*^9, 
   3.8838259187282763`*^9}, {3.8838268239743013`*^9, 
   3.8838268656313667`*^9}, {3.883826926498542*^9, 3.883826958077415*^9}, {
   3.883827725404242*^9, 3.883827809466003*^9}, {3.8840248870129642`*^9, 
   3.884025016729622*^9}, {3.884025108445436*^9, 3.88402520098709*^9}, {
   3.8840255646256323`*^9, 3.8840255652593203`*^9}, {3.884076979251896*^9, 
   3.884076992355555*^9}, {3.884077023006154*^9, 3.884077024955639*^9}, {
   3.884077323161292*^9, 3.8840773350172977`*^9}, {3.884077377186109*^9, 
   3.884077384445868*^9}, {3.884077451694704*^9, 3.8840774633687572`*^9}, {
   3.8840797002629213`*^9, 3.8840797214912853`*^9}, {3.884080516377543*^9, 
   3.884080566178294*^9}, {3.8840809683877907`*^9, 3.884080971706333*^9}, {
   3.884081165369791*^9, 3.884081204456629*^9}, {3.884081288971588*^9, 
   3.884081315742487*^9}, {3.884081477481186*^9, 3.8840815215679693`*^9}, {
   3.884082111476204*^9, 3.8840821151609364`*^9}, {3.884082178898052*^9, 
   3.884082183178899*^9}, {3.88408304584219*^9, 3.884083046672*^9}, {
   3.884083097513237*^9, 3.884083124416521*^9}, {3.884083171169001*^9, 
   3.884083230842572*^9}, {3.884084219064098*^9, 3.884084219776917*^9}, {
   3.8840842796288977`*^9, 3.8840843008178997`*^9}, {3.8840845988067713`*^9, 
   3.884084604560667*^9}, {3.8840847092083073`*^9, 3.884084710952265*^9}, {
   3.884084804512784*^9, 3.884084843098172*^9}, {3.884085109775897*^9, 
   3.884085129078595*^9}, {3.884085177901042*^9, 3.884085203865506*^9}, {
   3.8840852877810993`*^9, 3.884085353356028*^9}, {3.8840854038826103`*^9, 
   3.884085409859557*^9}, {3.88408552824098*^9, 3.884085530729125*^9}, {
   3.884085713478037*^9, 3.8840857188309927`*^9}, {3.8841850562689342`*^9, 
   3.884185068356167*^9}, {3.8841869890758047`*^9, 3.8841869906556873`*^9}, {
   3.8841870750203238`*^9, 3.88418708072486*^9}, {3.884202516032529*^9, 
   3.8842025169519978`*^9}, {3.884238888827962*^9, 3.884238889181468*^9}, {
   3.8842523536024437`*^9, 3.8842523537904654`*^9}, {3.884252686523196*^9, 
   3.8842526893947372`*^9}, {3.884261482272582*^9, 3.884261483673614*^9}, {
   3.884425366762396*^9, 3.884425367682714*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"f0cc4e96-9a39-48b4-b95c-b540a2ea63f5"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Round 2\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"round2", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"round2", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TIonDist", "[", 
           RowBox[{"\[Rho]8", ",", "#", ",", "devoptions"}], "]"}], ",", 
          RowBox[{"seqlabel", "@", "#"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"plot\[Rho]8", "[", 
       RowBox[{
        RowBox[{"seqlabel", "@", "#"}], ",", "True"}], "]"}]}], ")"}], "&"}], 
   "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.884085723023406*^9, 3.8840857459568*^9}, {
  3.884186994446067*^9, 3.8841870100236053`*^9}, {3.884193912142407*^9, 
  3.8841939152531033`*^9}, {3.884202521452284*^9, 3.8842025227688932`*^9}, {
  3.884238894026556*^9, 3.884238894636732*^9}, {3.884261487566008*^9, 
  3.884261489387876*^9}, {3.884425371282292*^9, 3.8844253720285*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"fe995218-246c-4fee-aa17-401bf29eba72"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Round 3\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"round3", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot3", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"round3", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TIonDist", "[", 
           RowBox[{"\[Rho]8", ",", "#", ",", "devoptions"}], "]"}], ",", 
          RowBox[{"seqlabel", "@", "#"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"plot\[Rho]8", "[", 
       RowBox[{
        RowBox[{"seqlabel", "@", "#"}], ",", "True"}], "]"}]}], ")"}], "&"}], 
   "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.884085765740828*^9, 3.884085808342691*^9}, {
  3.884187029501848*^9, 3.8841870407236547`*^9}, {3.884193921274691*^9, 
  3.884193925358638*^9}, {3.884202527054818*^9, 3.884202527504093*^9}, {
  3.8842388996421556`*^9, 3.8842389000660467`*^9}, {3.8842614947564487`*^9, 
  3.884261495562191*^9}, {3.884425375777172*^9, 3.8844253766206083`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"ebc8df5a-99d7-46cc-8e7e-18544fab8380"],

Cell[TextData[StyleBox["The best-two strategy for the virtual device",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.884261134796404*^9, 3.8842611428557177`*^9}, {
  3.884261617012134*^9, 3.884261619170156*^9}, {3.884272831064361*^9, 
  3.884272831999352*^9}, {3.884768480324443*^9, 
  3.884768481568643*^9}},ExpressionUUID->"5b88e094-8202-4d6a-b4a7-\
8863f2549d92"],

Cell[BoxData[{
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"plot1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"plot1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"plot2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"plot3", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"Spacings", "->", "0."}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<dist_best.pdf\>\"", ",", "%"}], "]"}], "\[IndentingNewLine]",
    "*)"}]}]}], "Input",
 CellChangeTimes->{{3.88476836979751*^9, 3.884768387466543*^9}, {
   3.8847684206937847`*^9, 3.88476842814439*^9}, {3.884769025461142*^9, 
   3.884769050509899*^9}, 3.884769438962137*^9, 3.891279324905113*^9, 
   3.894876150292529*^9, {3.895556725175983*^9, 3.895556747643154*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"d23bce0c-c94e-4222-8c3c-d8d1cf4feb15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Varying", " ", "the", " ", "parameters", " ", "and", " ", "take", " ", 
     "the", " ", "best", " ", "fidelity", " ", "among", " ", "all", " ", 
     "trials", " ", "up", " ", "to", " ", "3"}], "-", 
    RowBox[{"rounds", " ", "of", " ", "distillation"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fullseq", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"varyParams", "[", 
     RowBox[{"\[Rho]_", ",", "func_", ",", "vars_", ",", 
      RowBox[{"sequences_", ":", "fullseq"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newfid", ",", "fid", ",", "bestfid", ",", "results"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"results", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seqlabel", "@", "#"}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TIonDist", "[", 
                 RowBox[{"\[Rho]", ",", "#", ",", 
                  RowBox[{"func", "[", "fid", "]"}]}], "]"}], ";", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"mat2BellBasis", "@", 
                    RowBox[{"PartialTrace", "[", 
                    RowBox[{
                    "\[Rho]", ",", "0", ",", "1", ",", "2", ",", "4", ",", 
                    "5", ",", "6"}], "]"}]}], ")"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "3"}], "]"}], "]"}], "//", "Re"}]}], 
               ")"}]}], "}"}], "&"}], "/@", "sequences"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"bestfid", "=", 
          RowBox[{"First", "@", 
           RowBox[{"results", "[", 
            RowBox[{"[", 
             RowBox[{"Ordering", "[", 
              RowBox[{
               RowBox[{"results", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"fid", ",", 
           RowBox[{"Sequence", "@@", "bestfid"}]}], "}"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"fid", ",", "vars"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.884433702380515*^9, 3.884433834616086*^9}, {
   3.884433882640354*^9, 3.8844339074582787`*^9}, {3.884434001598508*^9, 
   3.884434438487933*^9}, {3.88443448037461*^9, 3.884434528106463*^9}, 
   3.884435057035913*^9, {3.884435088716258*^9, 3.884435149985196*^9}, {
   3.884435855542631*^9, 3.88443587226934*^9}, {3.8844360033515873`*^9, 
   3.884436034831912*^9}, {3.8844360835608253`*^9, 3.884436098149726*^9}, {
   3.88443629007281*^9, 3.884436291373188*^9}, {3.884436634672605*^9, 
   3.8844366508212147`*^9}, {3.8844366892645197`*^9, 
   3.8844367030987177`*^9}, {3.884438101029834*^9, 3.884438125189793*^9}, {
   3.884438186030245*^9, 3.884438203948101*^9}, {3.8844382384319563`*^9, 
   3.884438252432403*^9}, {3.884439126319199*^9, 3.884439198437841*^9}, {
   3.884439846041917*^9, 3.884439854890163*^9}, {3.8845096546563673`*^9, 
   3.884509738812911*^9}},
 CellLabel->
  "In[267]:=",ExpressionUUID->"40a5e3e9-6aeb-4401-81fb-30579028eaec"],

Cell[BoxData[
 RowBox[{"fids", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["1.5", 
        RowBox[{"-", "#"}]]}], ")"}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"6", ",", "35", ",", "0.5"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.884440987430429*^9, 3.884441069953128*^9}, {
  3.884441863640518*^9, 3.884441863827091*^9}, {3.8844423181725492`*^9, 
  3.88444231840948*^9}, {3.8844423687096357`*^9, 3.88444238514538*^9}, {
  3.8844424244235163`*^9, 3.8844425418101883`*^9}, {3.884509764192595*^9, 
  3.884509776966977*^9}, {3.884509876116819*^9, 3.884509889168647*^9}, {
  3.884516514352813*^9, 3.8845165436452427`*^9}, {3.894369141334062*^9, 
  3.894369142055457*^9}, {3.8943691975082197`*^9, 3.894369197845867*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"9239bfde-225f-433c-bcb1-7600c98e278a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fsxy", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FidSingleXY", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "#"}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", "#"}]}], "|>"}]}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fcz", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FidCZ", "->", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<Alice\>\"", "->", "#"}], ",", 
        RowBox[{"\"\<Bob\>\"", "->", "#"}]}], "|>"}]}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fent", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"FidEnt", "->", "#"}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fsxycz", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FidSingleXY", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Alice\>\"", "->", "#"}], ",", 
         RowBox[{"\"\<Bob\>\"", "->", "#"}]}], "|>"}]}], ",", 
      RowBox[{"FidCZ", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Alice\>\"", "->", "#"}], ",", 
         RowBox[{"\"\<Bob\>\"", "->", "#"}]}], "|>"}]}]}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fsxyent", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FidSingleXY", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Alice\>\"", "->", "#"}], ",", 
         RowBox[{"\"\<Bob\>\"", "->", "#"}]}], "|>"}]}], ",", 
      RowBox[{"FidEnt", "->", "#"}]}], "}"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fczent", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FidCZ", "->", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Alice\>\"", "->", "#"}], ",", 
         RowBox[{"\"\<Bob\>\"", "->", "#"}]}], "|>"}]}], ",", 
      RowBox[{"FidEnt", "->", "#"}]}], "}"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.884439682692505*^9, 3.884439683605513*^9}, {
  3.884440519290341*^9, 3.884440596908709*^9}, {3.884442946376223*^9, 
  3.884442947606924*^9}, {3.884691043151946*^9, 3.884691149285693*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"a6d599fc-d587-4710-b29e-3d6d554fc408"],

Cell["\<\
ressxy = varyParams[\[Rho]8, fsxy, fids];
rescz = varyParams[\[Rho]8, fcz, fids];
resent = varyParams[\[Rho]8, fent, fids];
rsxycz = varyParams[\[Rho]8, fsxycz, fids];
rsxyent = varyParams[\[Rho]8, fsxyent, fids];
rczent = varyParams[\[Rho]8, fczent, fids];
fidvars = {\"Rx,Ry\" -> ressxy, \"CZ\" -> rescz, \"Ent\" -> resent, \
\"Rx,Ry,CZ\" -> rsxycz, \"Rx,Ry,Ent\" -> rsxyent, \"CZ,Ent\" -> rczent};\
\>", "CodeText",
 CellChangeTimes->{{3.884434446251329*^9, 3.884434463003044*^9}, 
   3.884435066944887*^9, {3.884435892113399*^9, 3.884435906731529*^9}, {
   3.8844366642554626`*^9, 3.884436665764512*^9}, {3.884436824987363*^9, 
   3.8844368290426188`*^9}, {3.8844368599716263`*^9, 3.884436909891922*^9}, {
   3.884436959932452*^9, 3.8844369825790873`*^9}, {3.8844375196903877`*^9, 
   3.8844375201954*^9}, {3.8844392100948477`*^9, 3.884439211316442*^9}, {
   3.884439315413377*^9, 3.8844393185029707`*^9}, 3.8844395888219748`*^9, {
   3.884439631820965*^9, 3.884439673280079*^9}, {3.884439721469962*^9, 
   3.884439722242716*^9}, {3.884439761136059*^9, 3.8844398150076723`*^9}, 
   3.88444433374375*^9, {3.8845097868667383`*^9, 3.884509857592202*^9}, 
   3.884509930239984*^9, 3.88452371030536*^9, {3.884691039307732*^9, 
   3.884691041861652*^9}, {3.88469115377709*^9, 3.884691233149499*^9}, 
   3.884755310096434*^9, 3.8847770388103*^9, {3.894878695817163*^9, 
   3.894878700052429*^9}},ExpressionUUID->"b85a9973-7bc5-4b44-9ccd-\
a70961042840"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"load", " ", "pre"}], "-", 
     RowBox[{"run", " ", "data"}]}], ",", " ", 
    RowBox[{
    "otherwise", " ", "run", " ", "the", " ", "code", " ", "above", " ", "to",
      " ", "reproduce", " ", "the", " ", "data"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fidvars", 
    RowBox[{
    "<<", "\"\<supplement/DistillationOnTrappedIons/fidvars.mx\>\""}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.8948786124590483`*^9, 3.8948786887013187`*^9}, {
  3.895556768009326*^9, 3.895556802983254*^9}, {3.895673056983721*^9, 
  3.895673057270666*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"71bc1a0a-e577-47b7-9c9a-ae87bc85dd8e"],

Cell[BoxData[
 RowBox[{"fidvars", "//", "Keys"}]], "Input",
 CellChangeTimes->{{3.884779312471287*^9, 3.884779322984024*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"fa5e7bdc-88e3-427c-bf80-99959d759f7a"],

Cell[BoxData[
 RowBox[{"fplot1", "=", 
  RowBox[{"ListLogLogPlot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"5", ";;"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Values", "[", "fidvars", "]"}]}], ",", 
    RowBox[{"PlotRange", "->", "All"}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"FrameStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
    RowBox[{"PlotMarkers", "->", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", " ", "12"}], "}"}]}], ",", 
    RowBox[{"BaseStyle", "->", 
     RowBox[{"{", 
      RowBox[{"17", ",", 
       RowBox[{"FontFamily", "->", "\"\<Sans Serif\>\""}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "->", "0.6"}], ",", 
    RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Fidelity of the operator(s) in the legend\>\"", ",", 
       "\"\<Bell pair fidelity\>\""}], "}"}]}], ",", 
    RowBox[{"ImageSize", "->", "500"}], ",", 
    RowBox[{"Joined", "->", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"False", ",", 
         RowBox[{"Length", "@", "fidvars"}]}], "]"}], ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"True", ",", 
         RowBox[{"Length", "@", "fidvars"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "->", "Dashed"}], ",", 
    RowBox[{"PlotLegends", "->", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"LineLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Rx,Ry\>\"", ",", "\"\<CZ\>\"", ",", "\"\<Ent\>\"", ",", 
           "\"\<Rx,Ry,CZ\>\"", ",", "\"\<Rx,Ry,Ent\>\"", ",", 
           "\"\<CZ,Ent\>\""}], "}"}], ",", 
         RowBox[{"Spacings", "->", "0."}], ",", 
         RowBox[{"LegendFunction", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Framed", "[", 
             RowBox[{"#", ",", 
              RowBox[{"FrameStyle", "->", 
               RowBox[{"(", 
                RowBox[{"Antialiasing", "->", "False"}], ")"}]}], ",", 
              RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", 
              RowBox[{"Background", "->", "White"}]}], "]"}], "&"}], 
           ")"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.89", ",", "0.2"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"GridLines", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "0.95", "}"}]}], "}"}]}], ",", 
    RowBox[{"GridLinesStyle", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Red"}], "}"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.884437407432144*^9, 3.884437408478819*^9}, {
   3.884437661634602*^9, 3.884437724515233*^9}, {3.884440212262121*^9, 
   3.884440278878039*^9}, {3.8844403232639112`*^9, 3.884440337592362*^9}, {
   3.884440391050621*^9, 3.88444041766433*^9}, {3.884440612639896*^9, 
   3.884440746636726*^9}, {3.884440939156205*^9, 3.884440958215629*^9}, {
   3.884441442741459*^9, 3.8844414640304956`*^9}, {3.8844416357450933`*^9, 
   3.884441660914229*^9}, {3.8844417531246433`*^9, 3.884441852623362*^9}, {
   3.884442306197207*^9, 3.884442308278021*^9}, {3.884444166274457*^9, 
   3.8844442000739307`*^9}, {3.884444399690482*^9, 3.884444469659536*^9}, 
   3.8844445456298656`*^9, {3.884508188543632*^9, 3.884508189101247*^9}, {
   3.884508276320068*^9, 3.8845082778642797`*^9}, {3.884508615892975*^9, 
   3.884508657588213*^9}, {3.8845087161788263`*^9, 3.884508890658443*^9}, {
   3.884508927439196*^9, 3.884509029618328*^9}, {3.8845093232391663`*^9, 
   3.88450945270551*^9}, {3.8845095198164883`*^9, 3.8845095481115847`*^9}, {
   3.8845095850401163`*^9, 3.884509585431872*^9}, 3.8845227788692617`*^9, {
   3.884523013035804*^9, 3.884523161063169*^9}, {3.884523296124238*^9, 
   3.8845233354073973`*^9}, {3.884523368005604*^9, 3.8845233737387733`*^9}, {
   3.884523537429639*^9, 3.884523665146882*^9}, {3.8846926265895348`*^9, 
   3.884692663146945*^9}, {3.88469664755029*^9, 3.884696648164784*^9}, {
   3.884696678449306*^9, 3.884696722320299*^9}, {3.884751551397209*^9, 
   3.884751735906925*^9}, 3.8847517732341967`*^9, {3.884754748345634*^9, 
   3.884754749301606*^9}, {3.8847548209884157`*^9, 3.884754882191918*^9}, {
   3.884754919702256*^9, 3.884755049225357*^9}, {3.88475507983328*^9, 
   3.884755096768564*^9}, {3.88475516257789*^9, 3.884755242921239*^9}, {
   3.8847769625439367`*^9, 3.884776963607922*^9}, {3.8847786725043983`*^9, 
   3.884778689548504*^9}, {3.884778784137938*^9, 3.884778858009326*^9}, {
   3.884779170364292*^9, 3.884779173583446*^9}, {3.89487670643356*^9, 
   3.8948767815446978`*^9}, {3.895563273818582*^9, 3.895563296098666*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"d639a4b0-d054-48ab-be36-34eeeb89e9f3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<tions_vars.pdf\>\"", ",", "fplot1"}], "]"}], "*)"}]], "Input",\

 CellChangeTimes->{{3.884523669372581*^9, 3.8845236828844833`*^9}, 
   3.884751790007187*^9, 3.884755103012903*^9, 3.884776939817153*^9, {
   3.8847788136685057`*^9, 3.88477881567624*^9}, 3.8847788656725483`*^9, 
   3.894393091413356*^9, 3.894876157668687*^9, 3.894876746479233*^9, {
   3.895556814236793*^9, 3.895556817800377*^9}},
 CellLabel->
  "In[279]:=",ExpressionUUID->"9523d609-5184-43cd-a526-9a9227181714"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Timing and time profiling on each operations", "Subsection",
 CellChangeTimes->{{3.884193830102346*^9, 3.884193832885457*^9}, {
  3.884194680906012*^9, 3.884194689924513*^9}, {3.884246675633849*^9, 
  3.884246682317671*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"3f783393-ac8c-4ab4-a534-ae0c5bd4afff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"totaltime", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Last", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", "round1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"Last", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", "round2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", 
          RowBox[{"Last", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", "round3"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88419347197855*^9, 3.884193554774762*^9}, {
   3.884193691067872*^9, 3.884193883418623*^9}, {3.884193935029613*^9, 
   3.8841939760250177`*^9}, 3.884194704670659*^9, {3.894369676779674*^9, 
   3.89436967851173*^9}, {3.8955615027690783`*^9, 3.895561505123527*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"7358bde7-d760-48d2-a30e-a9d7b2f005e4"],

Cell["\<\
Plot all the total time for all possible configuration of the distillationsf \
or up to 3 rounds\
\>", "Text",
 CellChangeTimes->{{3.895561531945798*^9, 3.8955615666583557`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"97b80097-e3fc-4199-a26e-1b9a93f8c2b2"],

Cell[BoxData[{
 RowBox[{"ListPlot", "[", 
  RowBox[{"totaltime", ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<distillation round\>\"", ",", "\"\<total time (\[Mu]s)\>\""}], 
     "}"}]}], ",", 
   RowBox[{"ScalingFunctions", "->", "\"\<Log\>\""}], ",", 
   RowBox[{"FrameTicks", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "None"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"FrameStyle", "->", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
   RowBox[{"BaseStyle", "->", 
    RowBox[{"{", 
     RowBox[{"13", ",", 
      RowBox[{"FontFamily", "->", "\"\<Sans Serif\>\""}]}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<OpenMarkers\>\"", ",", " ", "Small"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "->", "330"}], ",", 
   RowBox[{"AspectRatio", "->", "0.6"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<tions_totaltime.pdf\>\"", ",", "%"}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.884193977961104*^9, 3.8841944013575068`*^9}, {
   3.884194463130657*^9, 3.8841945262389812`*^9}, {3.884194615203252*^9, 
   3.88419464207542*^9}, {3.884238985267003*^9, 3.884238985612734*^9}, {
   3.884265985427348*^9, 3.884265996480935*^9}, {3.8842660750602083`*^9, 
   3.884266122267807*^9}, 3.8842662094059467`*^9, {3.895556874596855*^9, 
   3.8955568764031363`*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"df2979d7-6aea-44c5-b924-a9814fe7a265"],

Cell[BoxData["totaltime"], "Input",
 CellChangeTimes->{{3.884266214095786*^9, 3.8842662150457487`*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"b1d09550-43c2-47bd-9fe0-461e02505612"],

Cell["Create time profile on each operator", "Text",
 CellChangeTimes->{{3.895561597827038*^9, 3.895561664365715*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"a5df5110-0fd0-4f59-95af-b87d1cde141d"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"getTime", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getTime", "[", 
   RowBox[{"gate_", ",", "lopt_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "g", ",", "node", ",", "moves", ",", "sgate", ",", "\[Theta]", ",", 
      RowBox[{"opt", "=", 
       RowBox[{"Association", "[", "lopt", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", "node"}], "}"}], "=", 
      RowBox[{"gate", "/.", 
       RowBox[{
        RowBox[{
         SubscriptBox["gg_", "__"], "[", 
         RowBox[{"n_", ",", "___"}], "]"}], ":>", 
        RowBox[{"{", 
         RowBox[{"gg", ",", "n"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"moves", "=", 
      RowBox[{"{", 
       RowBox[{"Splz", ",", "Comb", ",", "SWAPLoc", ",", "Shutl"}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sgate", "=", 
      RowBox[{"{", 
       RowBox[{"Rx", ",", "Ry"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"moves", ",", "g"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"opt", "[", "DurMove", "]"}], "[", "node", "]"}], "[", "g", 
        "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"sgate", ",", "g"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]", "=", 
         RowBox[{"gate", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             SubscriptBox["_", "_"], "[", 
             RowBox[{"_", ",", "t_"}], "]"}], ":>", "t"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Abs", "[", "\[Theta]", "]"}], "/", 
         RowBox[{
          RowBox[{"opt", "[", "RabiFreq", "]"}], "[", "node", "]"}]}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"g", "===", "CZ"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]", "/", 
        RowBox[{
         RowBox[{"opt", "[", "FreqCZ", "]"}], "[", "node", "]"}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"g", "===", "Ent"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Pi]", "/", 
        RowBox[{"opt", "[", "FreqEnt", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"g", "===", "Init"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"opt", "[", "DurInit", "]"}], "[", "node", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "===", "Read"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"opt", "[", "DurRead", "]"}], "[", "node", "]"}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "0"}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.88419573095161*^9, 3.884196047123104*^9}, {
  3.884196601747437*^9, 3.8841966117475643`*^9}, {3.8841966440505857`*^9, 
  3.884196646050846*^9}, {3.88419900963748*^9, 3.884199054213985*^9}, {
  3.884199997718644*^9, 3.884200126143897*^9}, {3.884200164953903*^9, 
  3.8842003010447807`*^9}, {3.884200362487685*^9, 3.884200383996241*^9}, {
  3.8842006191657953`*^9, 3.884200645923131*^9}, {3.884203412489668*^9, 
  3.8842034271559343`*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"5622a493-a0b4-436f-bfc2-16b8b98fbbb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeProfile", "[", 
   RowBox[{"circ_", ",", "opt_", ",", 
    RowBox[{"keys_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"time", ",", "gid", ",", "nodes", ",", "node", ",", "tkeys"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nodes", "=", 
      RowBox[{"Keys", "[", 
       RowBox[{
        RowBox[{"<|", "opt", "|>"}], "[", "Nodes", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tkeys", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "keys"}], "<", "1"}], ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"circ", "/.", 
          RowBox[{
           RowBox[{
            SubscriptBox["g_", "__"], "[", 
            RowBox[{"n_", ",", "___"}], "]"}], ":>", "g"}]}], "]"}], ",", 
        "keys"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"time", "=", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "->", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"tkeys", "->", "0"}], "]"}]}], "&"}], "/@", "nodes"}], 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gid", ",", "node"}], "}"}], "=", 
         RowBox[{"gate", "/.", 
          RowBox[{
           RowBox[{
            SubscriptBox["g_", "__"], "[", 
            RowBox[{"n_", ",", "___"}], "]"}], ":>", 
           RowBox[{"{", 
            RowBox[{"g", ",", "n"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gid", "===", "Ent"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"time", "[", "#", "]"}], "[", "gid", "]"}], "+=", 
             RowBox[{"getTime", "[", 
              RowBox[{"gate", ",", "opt"}], "]"}]}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"gate", "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["Ent", "__"], "[", 
               RowBox[{"n1_", ",", "n2_"}], "]"}], ":>", 
              RowBox[{"{", 
               RowBox[{"n1", ",", "n2"}], "}"}]}]}], ")"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"time", "[", "node", "]"}], "[", "gid", "]"}], "+=", 
           RowBox[{"getTime", "[", 
            RowBox[{"gate", ",", "opt"}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"gate", ",", "circ"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"time", "[", "n", "]"}], ",", "Wait"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nodes"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8841953376428957`*^9, 3.8841953462223463`*^9}, {
   3.884195684665182*^9, 3.884195728240932*^9}, {3.884200329207313*^9, 
   3.8842003324840603`*^9}, {3.884200421608254*^9, 3.884200449377894*^9}, {
   3.884200491569158*^9, 3.8842005948011093`*^9}, {3.884200940669631*^9, 
   3.884201121232777*^9}, {3.884201162909505*^9, 3.884201166202427*^9}, {
   3.884201204391123*^9, 3.884201298229692*^9}, {3.884201344765958*^9, 
   3.884201507556099*^9}, {3.884202007650378*^9, 3.884202013837904*^9}, {
   3.884202125099784*^9, 3.884202226924253*^9}, {3.884202264572123*^9, 
   3.884202392462596*^9}, {3.8842034317402067`*^9, 3.884203496334087*^9}, {
   3.884203571300365*^9, 3.8842036162036343`*^9}, {3.884238376642931*^9, 
   3.884238379451604*^9}, {3.884238418302991*^9, 3.884238437847207*^9}, {
   3.884238494255528*^9, 3.884238534821761*^9}, 3.884253005693596*^9},
 CellLabel->
  "In[285]:=",ExpressionUUID->"5d25a051-a48d-413a-91e9-9803893a2ce4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"countProfile", "[", 
   RowBox[{"circ_", ",", "opt_", ",", 
    RowBox[{"keys_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"count", ",", "gid", ",", "nodes", ",", "node", ",", "tkeys"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nodes", "=", 
      RowBox[{"Keys", "[", 
       RowBox[{
        RowBox[{"<|", "opt", "|>"}], "[", "Nodes", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tkeys", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "keys"}], "<", "1"}], ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"circ", "/.", 
          RowBox[{
           RowBox[{
            SubscriptBox["g_", "__"], "[", 
            RowBox[{"n_", ",", "___"}], "]"}], ":>", "g"}]}], "]"}], ",", 
        "keys"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"count", "=", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "->", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"tkeys", "->", "0"}], "]"}]}], "&"}], "/@", "nodes"}], 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"gid", ",", "node"}], "}"}], "=", 
         RowBox[{"gate", "/.", 
          RowBox[{
           RowBox[{
            SubscriptBox["g_", "__"], "[", 
            RowBox[{"n_", ",", "___"}], "]"}], ":>", 
           RowBox[{"{", 
            RowBox[{"g", ",", "n"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gid", "===", "Ent"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"count", "[", "#", "]"}], "[", "gid", "]"}], "+=", 
             "1"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"gate", "/.", 
             RowBox[{
              RowBox[{
               SubscriptBox["Ent", "__"], "[", 
               RowBox[{"n1_", ",", "n2_"}], "]"}], ":>", 
              RowBox[{"{", 
               RowBox[{"n1", ",", "n2"}], "}"}]}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"count", "[", "node", "]"}], "[", "gid", "]"}], "+=", 
           "1"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"gate", ",", "circ"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"n", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"count", "[", "n", "]"}], ",", "Wait"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "nodes"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.884252903862183*^9, 3.884252962631558*^9}, 
   3.884253002913574*^9},
 CellLabel->
  "In[286]:=",ExpressionUUID->"a1d9d6fe-4d77-465f-8d38-897f12b65ea7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"timeprofileplot", "[", 
    RowBox[{"node_", ",", "data_", ",", "keys_", ",", "title_", ",", 
     RowBox[{"legend_", ":", "True"}], ",", 
     RowBox[{"opt_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"BarChart", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "node"}], "]"}], "]"}], ",", 
     RowBox[{"ChartLabels", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Rotate", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "3"}]}], "]"}], "&"}], "/@", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "None"}], "}"}]}], 
     ",", 
     RowBox[{"Sequence", "@@", "opt"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"FrameStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "Thick"}], "]"}]}], ",", 
     RowBox[{"ChartLayout", "->", "\"\<Percentile\>\""}], ",", 
     RowBox[{"ChartStyle", "->", "\"\<ThermometerColors\>\""}], ",", 
     RowBox[{"ImageSize", "->", "330"}], ",", 
     RowBox[{"BarSpacing", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0.3"}], "}"}]}], ",", 
     RowBox[{"BaseStyle", "->", 
      RowBox[{"{", 
       RowBox[{"12", ",", 
        RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"None", ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"None", ",", "title"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"If", "[", 
      RowBox[{"legend", ",", 
       RowBox[{"ChartLegends", "->", 
        RowBox[{"Placed", "[", 
         RowBox[{"keys", ",", "Right"}], "]"}]}], ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"{", "}"}]}]}], "]"}], ",", 
     RowBox[{"AspectRatio", "->", "1"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.884200978606414*^9, 3.884200978891589*^9}, {
   3.8842017755714912`*^9, 3.8842019763162518`*^9}, {3.8842024296206703`*^9, 
   3.8842024591630573`*^9}, 3.884202562412114*^9, {3.884202610664961*^9, 
   3.884202730814192*^9}, {3.884202820537224*^9, 3.8842028650397043`*^9}, {
   3.884202957137307*^9, 3.884203033402257*^9}, {3.884203106444951*^9, 
   3.884203169614521*^9}, {3.88420330566665*^9, 3.8842033397052603`*^9}, {
   3.88423866866844*^9, 3.8842386845188293`*^9}, {3.884238728247113*^9, 
   3.884238765718355*^9}, {3.884239019085681*^9, 3.8842391281651373`*^9}, {
   3.8842393032721443`*^9, 3.884239545547587*^9}, {3.884239608936722*^9, 
   3.884239622848134*^9}, {3.8842467210634727`*^9, 3.884246914315319*^9}, {
   3.884247502911468*^9, 3.884247511974662*^9}, {3.8842531635953407`*^9, 
   3.8842531718674*^9}, {3.88425320914505*^9, 3.8842532108299847`*^9}, {
   3.88425404750469*^9, 3.884254079203536*^9}, {3.8842542028355913`*^9, 
   3.8842542298272448`*^9}, {3.8842542669490957`*^9, 
   3.8842542713616257`*^9}, {3.884254305660129*^9, 3.884254328828581*^9}, {
   3.8842543653471737`*^9, 3.884254385059705*^9}, {3.8842544168623257`*^9, 
   3.884254417288169*^9}, {3.884254547852838*^9, 3.8842545709014053`*^9}, {
   3.884254622983549*^9, 3.8842546232185926`*^9}, {3.884254682504016*^9, 
   3.884254730014736*^9}, {3.8842547675581913`*^9, 3.884254772464737*^9}, {
   3.884254861945013*^9, 3.884254872731379*^9}, {3.884255287696927*^9, 
   3.884255306381734*^9}, {3.88425537029603*^9, 3.884255394961102*^9}, {
   3.884265723991352*^9, 3.8842657899557333`*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"766981d0-25ba-4bb3-8b17-25440479f9ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"keys", "=", 
   RowBox[{"{", 
    RowBox[{
    "Splz", ",", "Comb", ",", "Shutl", ",", "SWAPLoc", ",", "Ent", ",", "CZ", 
     ",", "Ry", ",", "Rx", ",", "Read"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8842035288987007`*^9, 3.884203545316606*^9}, {
   3.884238797312797*^9, 3.884238805286482*^9}, 3.884239009487337*^9, {
   3.8842530469855137`*^9, 3.88425306049085*^9}, 3.884253095750471*^9, {
   3.884253964259162*^9, 3.884253966531497*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"680ebf8a-8cf5-4300-8287-82272cc75fdd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"datatime", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"seqlabel", "[", "#", "]"}], ",", 
       RowBox[{"timeProfile", "[", 
        RowBox[{
         RowBox[{"DistCircTrappedIons4", "[", "#", "]"}], ",", 
         RowBox[{"Options", "@", "TrappedIonOxford"}], ",", "keys"}], "]"}]}],
       "}"}], "&"}], "/@", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datacount", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"seqlabel", "[", "#", "]"}], ",", 
       RowBox[{"countProfile", "[", 
        RowBox[{
         RowBox[{"DistCircTrappedIons4", "[", "#", "]"}], ",", 
         RowBox[{"Options", "@", "TrappedIonOxford"}], ",", "keys"}], "]"}]}],
       "}"}], "&"}], "/@", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot1", "=", 
   RowBox[{"timeprofileplot", "[", 
    RowBox[{
    "\"\<Alice\>\"", ",", "datacount", ",", "keys", ",", 
     "\"\<Operation count(%)\>\"", ",", "False", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImagePadding", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"20", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"55", ",", "30"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "220"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot2", "=", 
   RowBox[{"timeprofileplot", "[", 
    RowBox[{
    "\"\<Alice\>\"", ",", "datatime", ",", "keys", ",", 
     "\"\<Time spent on operations(%)\>\"", ",", "True", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ImagePadding", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"55", ",", "30"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "200"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.884239131788101*^9, 3.8842391412144003`*^9}, {
   3.8842395599901323`*^9, 3.8842395606545677`*^9}, {3.8842396297242413`*^9, 
   3.884239641233392*^9}, {3.88425330224993*^9, 3.884253312455241*^9}, {
   3.884254096356619*^9, 3.8842540971468782`*^9}, {3.884254280974514*^9, 
   3.884254295389752*^9}, {3.884254738772092*^9, 3.8842547400244207`*^9}, {
   3.884254961003327*^9, 3.884255009254133*^9}, 3.884255326420559*^9, {
   3.884265801459724*^9, 3.884265801622497*^9}, {3.884266441474372*^9, 
   3.884266442367032*^9}, {3.884266571502346*^9, 3.884266624610157*^9}, {
   3.884267547449481*^9, 3.884267564644059*^9}, {3.8844255131132183`*^9, 
   3.8844255136830893`*^9}, {3.8943949966917343`*^9, 3.8943950103585787`*^9}},
 
 CellLabel->
  "In[289]:=",ExpressionUUID->"8c96a286-281a-47fc-9d53-8318ea8fb1d2"],

Cell[BoxData[{
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"plot1", ",", "plot2"}], "}"}], "}"}], ",", 
   RowBox[{"Spacings", "->", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<tions_timeprofile.pdf\>\"", ",", "%"}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.88425410237294*^9, 3.884254114032976*^9}, {
   3.8842550707211447`*^9, 3.884255248202712*^9}, {3.884255350656245*^9, 
   3.884255352169009*^9}, {3.884266496675157*^9, 3.884266514708044*^9}, {
   3.88442552624632*^9, 3.884425555287006*^9}, 3.894876165869726*^9, 
   3.895556886127554*^9},
 CellLabel->
  "In[293]:=",ExpressionUUID->"caefc5f7-ee4e-475c-9600-a66654fd7769"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Print the step-by-step distillation process + animation", "Section",
 CellChangeTimes->{{3.88373840369119*^9, 3.88373842780586*^9}, {
  3.884014690771544*^9, 3.884014694461878*^9}, {3.88408325686007*^9, 
  3.884083258899022*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"c3f2ea48-ae1d-4efa-8bf6-1368070e1557"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AnimateDistillation", "::", "usage"}], "=", 
   "\"\<AnimateDistillation[sequence, device_options]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AnimateDistillation", "[", 
   RowBox[{
    RowBox[{"sequence_", ":", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"devoptions_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dev", ",", "circ", ",", "ccirc", ",", 
      RowBox[{"show", "=", 
       RowBox[{"{", "}"}]}], ",", "format", ",", "noisy", ",", "fulltime", 
      ",", 
      RowBox[{"step", "=", "1"}], ",", "nions"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"format", "[", 
       RowBox[{"zones_", ",", "noise_", ",", "t_", ",", "s_"}], "]"}], ":=", 
      RowBox[{"Framed", "[", 
       RowBox[{"Row", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Column", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<(\>\"", "<>", 
               RowBox[{"ToString", "[", "s", "]"}], "<>", "\"\<) t=\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"t", ",", "TraditionalForm"}], "]"}], "<>", 
               "\"\<\[Mu]s\>\""}], ",", 
              RowBox[{"Rasterize", "[", 
               RowBox[{"zones", ",", 
                RowBox[{"RasterSize", "->", "500"}], ",", 
                RowBox[{"ImageSize", "->", "200"}]}], "]"}]}], "}"}], ",", 
            "Center"}], "]"}], ",", 
          RowBox[{"Pane", "[", 
           RowBox[{"noise", ",", "280"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dev", "=", 
      RowBox[{"TrappedIonOxford", "[", 
       RowBox[{"Sequence", "@@", "devoptions"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nions", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Length", "/@", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"Values", "@", 
          RowBox[{"Values", "@", 
           RowBox[{"dev", "[", "Nodes", "]"}]}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"circ", "=", 
      RowBox[{"DistCircTrappedIons4", "[", "sequence", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ccirc", "=", 
      RowBox[{"CircTrappedIons", "[", 
       RowBox[{"circ", ",", "dev", ",", 
        RowBox[{"MapQubits", "->", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"fulltime", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"N", "@", "#"}], ",", 
          RowBox[{"FormatType", "->", "TraditionalForm"}]}], "]"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"InsertCircuitNoise", "[", 
           RowBox[{"ccirc", ",", 
            RowBox[{"TrappedIonOxford", "[", 
             RowBox[{"Sequence", "@@", "devoptions"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"OptionValue", "[", 
           RowBox[{"TrappedIonOxford", ",", "DurInit"}], "]"}], "[", 
          "\"\<Alice\>\"", "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"show", ",", 
       RowBox[{"format", "[", 
        RowBox[{
         RowBox[{"dev", "[", "ShowNodes", "]"}], ",", 
         RowBox[{"DrawCircuit", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              SubscriptBox["Init", "#"], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "5"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["Damp", "#"], "[", "1.", "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "5"}], "]"}]}]}], "}"}], "]"}], ",", 
         "\"\<0\>\"", ",", 
         RowBox[{"step", "++"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"noisy", "=", 
         RowBox[{"InsertCircuitNoise", "[", 
          RowBox[{
           RowBox[{"ccirc", "[", 
            RowBox[{"[", "c", "]"}], "]"}], ",", "dev"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"show", ",", "\[IndentingNewLine]", 
          RowBox[{"format", "[", 
           RowBox[{
            RowBox[{"dev", "[", "ShowNodes", "]"}], ",", 
            RowBox[{"DrawCircuit", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"noisy", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
              RowBox[{"dev", "[", "NumTotalQubits", "]"}]}], "]"}], ",", 
            RowBox[{"fulltime", "[", 
             RowBox[{"[", "c", "]"}], "]"}], ",", 
            RowBox[{"step", "++"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
        "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"Length", "@", "ccirc"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "show"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8837383987963953`*^9, 3.883738401478146*^9}, {
  3.883738439977435*^9, 3.883738443439444*^9}, {3.8838142075526867`*^9, 
  3.8838142302616053`*^9}, {3.884084486895398*^9, 3.884084509819927*^9}, {
  3.884084948602293*^9, 3.884084950544751*^9}, {3.8842451878567266`*^9, 
  3.8842451893902893`*^9}, {3.884245257784618*^9, 3.884245261099375*^9}, {
  3.884245500614362*^9, 3.884245504009781*^9}, {3.884246242804329*^9, 
  3.8842462446564417`*^9}, {3.884246389236019*^9, 3.884246396622761*^9}, {
  3.895556897546755*^9, 3.8955569067668133`*^9}, {3.895560266571727*^9, 
  3.895560363248682*^9}, {3.8955604351950006`*^9, 3.895560436979712*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"2dc02453-c30c-4171-84c2-3faa7e72a7d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Print", " ", "distillation", " ", "step", " ", "by", " ", "step"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PrintDistillation", "[", 
    RowBox[{
     RowBox[{"sequence_", ":", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"devoptions_", ":", 
      RowBox[{"{", "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dev", ",", "circ", ",", "ccirc", ",", 
       RowBox[{"show", "=", 
        RowBox[{"{", "}"}]}], ",", "format", ",", "noisy", ",", "fulltime", 
       ",", 
       RowBox[{"step", "=", "0"}], ",", "nions"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"format", "[", 
        RowBox[{"zones_", ",", "c_", ",", "t_", ",", "s_"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<(\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"s", ",", 
                RowBox[{"FormatType", "->", "TraditionalForm"}]}], "]"}], 
              "<>", "\"\<)t=\>\"", "<>", "t", "<>", "\"\<\[Mu]s\>\""}], ",", 
             RowBox[{"StringRiffle", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"FormatType", "->", "TraditionalForm"}]}], "]"}], 
                "&"}], "/@", "c"}], "]"}]}], "}"}], ",", "Left"}], "]"}], ",", 
         RowBox[{"Rasterize", "[", 
          RowBox[{"zones", ",", 
           RowBox[{"RasterSize", "->", "Full"}], ",", 
           RowBox[{"ImageSize", "->", "150"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dev", "=", 
       RowBox[{"TrappedIonOxford", "[", 
        RowBox[{"Sequence", "@@", "devoptions"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nions", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"Length", "/@", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"Values", "@", 
           RowBox[{"Values", "@", 
            RowBox[{"dev", "[", "Nodes", "]"}]}]}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"circ", "=", 
       RowBox[{"DistCircTrappedIons4", "[", "sequence", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ccirc", "=", 
       RowBox[{"CircTrappedIons", "[", 
        RowBox[{"circ", ",", "dev", ",", 
         RowBox[{"MapQubits", "->", "False"}]}], "]"}]}], ";", 
      RowBox[{"fulltime", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"N", "[", "#", "]"}], ",", 
           RowBox[{"FormatType", "->", "TraditionalForm"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"InsertCircuitNoise", "[", 
            RowBox[{"ccirc", ",", 
             RowBox[{"TrappedIonOxford", "[", 
              RowBox[{"Sequence", "@@", "devoptions"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"OptionValue", "[", 
            RowBox[{"TrappedIonOxford", ",", "DurInit"}], "]"}], "[", 
           "\"\<Alice\>\"", "]"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"show", ",", 
        RowBox[{"format", "[", 
         RowBox[{
          RowBox[{"dev", "[", "ShowNodes", "]"}], ",", 
          RowBox[{"{", "\"\<Initialisation\>\"", "}"}], ",", "\"\<0\>\"", ",", 
          RowBox[{"step", "++"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"noisy", "=", 
          RowBox[{"InsertCircuitNoise", "[", 
           RowBox[{
            RowBox[{"ccirc", "[", 
             RowBox[{"[", "c", "]"}], "]"}], ",", "dev"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"show", ",", "\[IndentingNewLine]", 
           RowBox[{"format", "[", 
            RowBox[{
             RowBox[{"dev", "[", "ShowNodes", "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"ccirc", "[", 
                  RowBox[{"[", "c", "]"}], "]"}]}], "<", "1"}], ",", 
               "\"\<End\>\"", ",", 
               RowBox[{"ccirc", "[", 
                RowBox[{"[", "c", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"fulltime", "[", 
              RowBox[{"[", "c", "]"}], "]"}], ",", 
             RowBox[{"step", "++"}]}], "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", 
          RowBox[{"Length", "@", "ccirc"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "show"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.884083255260201*^9, {3.8840843891400547`*^9, 3.8840844168932247`*^9}, {
   3.884084473583014*^9, 3.8840844791168537`*^9}, {3.884084952200265*^9, 
   3.8840849545012903`*^9}, {3.8840981583650627`*^9, 3.88409816391471*^9}, {
   3.884112663043187*^9, 3.884112721965434*^9}, {3.884112767442245*^9, 
   3.884112779825338*^9}, {3.884112814098063*^9, 3.884112816655801*^9}, {
   3.8841128924379873`*^9, 3.8841129050375013`*^9}, {3.884244939309087*^9, 
   3.884245158417738*^9}, {3.8842452361550903`*^9, 3.88424523988433*^9}, {
   3.884245304299273*^9, 3.8842453839593678`*^9}, {3.8842454951618023`*^9, 
   3.884245497519697*^9}, {3.884245597908057*^9, 3.884245601291613*^9}, {
   3.8842456637135963`*^9, 3.884245664619246*^9}, {3.884245696267889*^9, 
   3.884245803151679*^9}, {3.884245909940916*^9, 3.8842459218713207`*^9}, 
   3.884246169626212*^9, {3.884246214052054*^9, 3.884246214225501*^9}, {
   3.8842462700488234`*^9, 3.884246272754129*^9}, 3.884246350981153*^9, {
   3.8842464116287727`*^9, 3.884246412694035*^9}, {3.8842464611604567`*^9, 
   3.884246517032501*^9}, {3.8842465554943666`*^9, 3.8842466414701633`*^9}, {
   3.884271711182177*^9, 3.8842717115905457`*^9}, {3.8842718277370977`*^9, 
   3.884271840553648*^9}, {3.895556920879602*^9, 3.895556924173203*^9}, {
   3.895560246322966*^9, 3.895560252542842*^9}, {3.895560690512376*^9, 
   3.895560722085918*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"83c7d16c-2505-409f-bf3e-e1247161be48"],

Cell["\<\
Use the code below to render details of the distillation steps into GIF \
animation  \
\>", "Text",
 CellChangeTimes->{{3.87706348871129*^9, 3.877063523331842*^9}, {
   3.877063624751903*^9, 3.8770636394484177`*^9}, {3.8770636844535418`*^9, 
   3.8770636847284603`*^9}, {3.877064470203786*^9, 3.8770644712416*^9}, {
   3.877064720429151*^9, 3.87706472179109*^9}, {3.880183327151959*^9, 
   3.880183328373454*^9}, {3.880183761081605*^9, 3.880183762738824*^9}, {
   3.8801839218959723`*^9, 3.880183922918253*^9}, {3.880184340087482*^9, 
   3.8801843409323273`*^9}, {3.880187617128743*^9, 3.8801876202893667`*^9}, {
   3.880188089384716*^9, 3.880188090402269*^9}, {3.883497219171834*^9, 
   3.883497264048298*^9}, {3.8837391017430143`*^9, 3.883739101743507*^9}, {
   3.8837391558741713`*^9, 3.883739156525214*^9}, {3.8837392062881613`*^9, 
   3.883739217522626*^9}, 3.88382215984439*^9, {3.883839867118671*^9, 
   3.883839867277421*^9}, {3.883841121842902*^9, 3.883841122222978*^9}, {
   3.884014221939262*^9, 3.884014242834508*^9}, {3.884084521781345*^9, 
   3.884084527440505*^9}, {3.884246309364716*^9, 3.88424632179012*^9}, 
   3.894963752783873*^9, {3.895557005774547*^9, 3.895557007597662*^9}, {
   3.895557253618062*^9, 3.895557290842434*^9}, {3.895557420428977*^9, 
   3.89555742698827*^9}, 3.895560726968339*^9, {3.8955608408027973`*^9, 
   3.895560853834944*^9}, {3.895673324716834*^9, 3.8956733514525223`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"453edd7e-2e6c-43ba-9600-7935556a2771"],

Cell["\<\
picts = AnimateDistillation[{0, 0, 0}];
Export[\"distillation.gif\", picts, AnimationRepetitions -> 1, \
\"DisplayDurations\" -> ConstantArray[1, Length@picts], RasterSize -> 600];
Import[\"distillation.gif\", \"AnimatedImage\"]
\
\>", "CodeText",
 CellChangeTimes->{{3.895560386899509*^9, 3.895560393191949*^9}, {
   3.895560729018448*^9, 3.895560730968114*^9}, {3.8955608279097843`*^9, 
   3.895560834093438*^9}, 
   3.895560884843493*^9},ExpressionUUID->"4f062133-6618-46f6-964e-\
749e76969d7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"steps", "=", 
   RowBox[{"PrintDistillation", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8840981241090603`*^9, 3.8840981390481253`*^9}, {
   3.884112386853908*^9, 3.884112389164328*^9}, {3.884112622782976*^9, 
   3.884112624204894*^9}, {3.884112730031098*^9, 3.8841127317307777`*^9}, {
   3.884245562143355*^9, 3.884245562607004*^9}, {3.884271630558909*^9, 
   3.884271631565483*^9}, 3.8943950399933367`*^9, 3.894395146135405*^9, {
   3.8955574789908047`*^9, 3.895557486867035*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"1e69bf1f-4d11-4841-8973-cbedf4861bd8"],

Cell[BoxData[
 RowBox[{"steps", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.884271633412875*^9, 3.884271635941741*^9}, 
   3.8955598148558493`*^9, {3.8955598826125507`*^9, 3.8955598857822123`*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"91c99e6e-02e8-436d-a484-ebb28c3d6da4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "uncomment", " ", "to", " ", "produce", " ", "the", " ", "steps", " ", 
    "shown", " ", "in", " ", "the", " ", "appendix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"\"\<distillation_steps1.pdf\>\"", ",", 
      RowBox[{"TableForm", "@", 
       RowBox[{"steps", "[", 
        RowBox[{"[", 
         RowBox[{";;", "19"}], "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<distillation_steps2.pdf\>\"", ",", 
      RowBox[{"TableForm", "@", 
       RowBox[{"steps", "[", 
        RowBox[{"[", 
         RowBox[{"20", ";;", "38"}], "]"}], "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<distillation_steps3.pdf\>\"", ",", 
      RowBox[{"TableForm", "@", 
       RowBox[{"steps", "[", 
        RowBox[{"[", 
         RowBox[{"39", ";;", "54"}], "]"}], "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<distillation_steps4.pdf\>\"", ",", 
      RowBox[{"TableForm", "@", 
       RowBox[{"steps", "[", 
        RowBox[{"[", 
         RowBox[{"55", ";;", "75"}], "]"}], "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<distillation_steps5.pdf\>\"", ",", 
      RowBox[{"TableForm", "@", 
       RowBox[{"steps", "[", 
        RowBox[{"[", 
         RowBox[{"76", ";;", "93"}], "]"}], "]"}]}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<distillation_steps6.pdf\>\"", ",", 
      RowBox[{"TableForm", "@", 
       RowBox[{"steps", "[", 
        RowBox[{"[", 
         RowBox[{"94", ";;"}], "]"}], "]"}]}]}], "]"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.8841556028717833`*^9, 3.884155611991144*^9}, {
   3.884184994561389*^9, 3.884184997687602*^9}, {3.8842451748855867`*^9, 
   3.884245176422241*^9}, {3.8842461800552073`*^9, 3.884246187260393*^9}, {
   3.8842463389451113`*^9, 3.884246365068429*^9}, {3.884271644571347*^9, 
   3.8842716662751513`*^9}, {3.884271904914489*^9, 3.884271966845827*^9}, {
   3.884272019804768*^9, 3.884272063939602*^9}, {3.884272110456765*^9, 
   3.884272110701501*^9}, {3.88427226489459*^9, 3.88427229176966*^9}, 
   3.8847555044334097`*^9, {3.894395172588539*^9, 3.894395187534746*^9}, {
   3.8943952218613787`*^9, 3.894395264793414*^9}, {3.894395475193595*^9, 
   3.894395475508522*^9}, {3.894395525015252*^9, 3.894395532776243*^9}, 
   3.8946945519772673`*^9, {3.895130170765864*^9, 3.8951302655893507`*^9}, {
   3.895130452868525*^9, 3.895130453043643*^9}, {3.8951304846123037`*^9, 
   3.895130505879727*^9}, {3.895130547188085*^9, 3.895130571652936*^9}, {
   3.895130641331992*^9, 3.89513065122647*^9}, {3.895130732246525*^9, 
   3.895130759751184*^9}, {3.895130810892275*^9, 3.895130828052638*^9}, 
   3.895131125532432*^9, {3.895556940349175*^9, 3.895556955286913*^9}, {
   3.8955608961912823`*^9, 3.895560912282556*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"b7dac390-543d-424a-8cc7-15acb1e3dc15"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1296., 801.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
DockedCells->{
  Cell[
   BoxData[
    DynamicModuleBox[{LinterUIDockedCell`Private`notebook$$}, 
     GraphicsBox[{
       InsetBox[
        TemplateBox[{
          PaneBox[
           StyleBox[
           "\"Code Analysis\"", FontColor -> GrayLevel[0.4], FontFamily -> 
            "Source Sans Pro", FontWeight -> Plain, FontSize -> 13, 
            StripOnInput -> False], 
           BaselinePosition -> (Baseline -> Scaled[0.65])], 
          TemplateBox[{8}, "Spacer1"], 
          PaneBox[
           
           PaneSelectorBox[{{False, False} -> 
             TemplateBox[{0}, "Spacer1"], {True, False} -> 
             TemplateBox[{0}, "Spacer1"], {True, True} -> PaneBox[
               InterpretationBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEExpressions", "PercolateAnimator"][Medium]], 
                ProgressIndicator[Appearance -> "Percolate"], 
                BaseStyle -> {"Deploy"}], BaselinePosition -> Scaled[0.05]], {
              False, True} -> 
             DynamicModuleBox[{
               CodeInspector`LinterUI`Private`tracker$$ = 
                CodeInspector`LinterUI`Private`DynamicTriggers`\
dockedCellLintCounts}, 
               DynamicWrapperBox[
                DynamicBox[
                 ToBoxes[
                 CodeInspector`LinterUI`Private`tracker$$; 
                  LinterUIDockedCell`Private`dockedCellSeverityCountsButton[
                   LinterUIDockedCell`Private`notebook$$], TraditionalForm], 
                 TrackedSymbols :> {
                  CodeInspector`LinterUI`Private`tracker$$}], 
                If[
                CodeInspector`LinterUI`Private`tracker$$ =!= 
                 CodeInspector`LinterUI`Private`DynamicTriggers`\
dockedCellLintCounts, CodeInspector`LinterUI`Private`tracker$$ = 
                 CodeInspector`LinterUI`Private`DynamicTriggers`\
dockedCellLintCounts]], DynamicModuleValues :> {}]}, 
            Dynamic[FEPrivate`EvaluatorStatus["Local"]; {
               CodeInspector`LinterUI`Private`varValue[
               LinterUIDockedCell`Private`notebook$$, "AnalysisInProgressQ"], 
               
               TrueQ[
                CodeInspector`LinterUI`Private`varValue[
                LinterUIDockedCell`Private`notebook$$, 
                 "DockedCellPresentQ"]]}], ImageSize -> Automatic], 
           BaselinePosition -> Scaled[0.15]]}, "Row", 
         DisplayFunction -> (PaneBox[
           RowBox[{
             TemplateSlotSequence[1, "\[InvisibleSpace]"]}], Alignment -> 
           Baseline]& ), InterpretationFunction -> (RowBox[{"Row", "[", 
            RowBox[{
              RowBox[{"{", 
                TemplateSlotSequence[1, ","], "}"}], ",", 
              RowBox[{"Alignment", "\[Rule]", "Baseline"}]}], "]"}]& )], 
        Offset[{8, 0}, {-1, 0}], {-1, 0}], 
       InsetBox[
        PaneSelectorBox[{
         True -> DynamicModuleBox[{
            CodeInspector`LinterUI`Private`hoverQ$$ = False, 
             CodeInspector`LinterUI`Private`mouseDownQ$$ = False, 
             CodeInspector`LinterUI`Private`fontColor$$}, 
            ButtonBox[
             DynamicWrapperBox[
              TemplateBox[{
                DynamicWrapperBox[
                 StyleBox[
                  PaneBox[
                  "\"Reanalyze Notebook\"", ContentPadding -> True, 
                   FrameMargins -> None, BaselinePosition -> Baseline], 
                  FontColor -> 
                  Dynamic[CodeInspector`LinterUI`Private`fontColor$$], 
                  FontColor -> GrayLevel[0.2], FontFamily -> 
                  "Source Sans Pro", FontWeight -> Plain, FontSize -> 14, 
                  StripOnInput -> False], 
                 CodeInspector`LinterUI`Private`fontColor$$ = Which[
                   TrueQ[
                    Not[
                    
                    OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "ActiveQ"]]], 
                   
                   OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "TextInactiveColor"], 
                   CodeInspector`LinterUI`Private`hoverQ$$, 
                   
                   OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "TextHoverColor"], True, 
                   
                   OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "TextColor"]]], ContentPadding -> False, 
                FrameMargins -> {{9, 9}, {0, 0}}, 
                Alignment -> {Center, Center}, ImageSize -> {Automatic, 19}, 
                RoundingRadius -> 3, FrameStyle -> Dynamic[
                  Directive[
                   AbsoluteThickness[0.5], 
                   Which[
                    TrueQ[
                    Not[
                    
                    OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "ActiveQ"]]], 
                    
                    OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "EdgeInactiveColor"], 
                    CodeInspector`LinterUI`Private`hoverQ$$, 
                    
                    OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "EdgeHoverColor"], True, 
                    
                    OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "EdgeColor"]]]], Background -> Dynamic[
                  Which[
                   TrueQ[
                    Not[
                    
                    OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "ActiveQ"]]], 
                   
                   OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "BackInactiveColor"], 
                   And[
                   CodeInspector`LinterUI`Private`hoverQ$$, 
                    CodeInspector`LinterUI`Private`mouseDownQ$$], 
                   
                   OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "BackMouseDownColor"], 
                   CodeInspector`LinterUI`Private`hoverQ$$, 
                   
                   OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "BackHoverColor"], True, 
                   
                   OptionValue[{
                    ImageSize -> {Automatic, 19}, 
                    FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                    Baseline, Alignment -> {Center, Center}, Method -> 
                    "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                    "TextHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                    "BackHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                    CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                    "EdgeHoverColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                    CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, 
                    "BackColor"]]]}, "Highlighted"], 
              CodeInspector`LinterUI`Private`hoverQ$$ = 
               CurrentValue["MouseOver"]; 
              CodeInspector`LinterUI`Private`mouseDownQ$$ = 
               CurrentValue["MouseButtonTest"]], 
             Appearance -> {
              "Default" -> 
               Image[RawArray["UnsignedInteger8",{{{255, 255, 255, 255}, {0, 
                  0, 0, 255}, {255, 255, 255, 255}}, {{0, 0, 0, 255}, {0, 0, 
                  0, 0}, {0, 0, 0, 255}}, {{255, 255, 255, 255}, {0, 0, 0, 
                  255}, {255, 255, 255, 255}}}], "Byte", ColorSpace -> "RGB", 
                 ImageResolution -> {72, 72}, Interleaving -> True], "Hover" -> 
               Image[RawArray["UnsignedInteger8",{{{255, 255, 255, 255}, {0, 
                  0, 0, 255}, {255, 255, 255, 255}}, {{0, 0, 0, 255}, {0, 0, 
                  0, 0}, {0, 0, 0, 255}}, {{255, 255, 255, 255}, {0, 0, 0, 
                  255}, {255, 255, 255, 255}}}], "Byte", ColorSpace -> "RGB", 
                 ImageResolution -> {72, 72}, Interleaving -> True], 
               "Pressed" -> 
               Image[RawArray["UnsignedInteger8",{{{255, 255, 255, 255}, {0, 
                  0, 0, 255}, {255, 255, 255, 255}}, {{0, 0, 0, 255}, {0, 0, 
                  0, 0}, {0, 0, 0, 255}}, {{255, 255, 255, 255}, {0, 0, 0, 
                  255}, {255, 255, 255, 255}}}], "Byte", ColorSpace -> "RGB", 
                 ImageResolution -> {72, 72}, Interleaving -> True]}, 
             BaselinePosition -> Baseline, 
             ButtonFunction :> (
              If[OptionValue[{
                  ImageSize -> {Automatic, 19}, 
                   FrameMargins -> {9 {1, 1}, 0 {1, 1}}, BaselinePosition -> 
                   Baseline, Alignment -> {Center, Center}, Method -> 
                   "Preemptive", "ActiveQ" -> True, "TextColor" -> 
                   CodeInspector`LinterUI`Private`colorData["ButtonText"], 
                   "TextHoverColor" -> 
                   CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextHover"], "TextInactiveColor" -> 
                   CodeInspector`LinterUI`Private`colorData[
                    "ButtonTextInactive"], "BackColor" -> 
                   CodeInspector`LinterUI`Private`colorData["ButtonBack"], 
                   "BackHoverColor" -> 
                   CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackHover"], "BackMouseDownColor" -> 
                   CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackMouseDown"], "BackInactiveColor" -> 
                   CodeInspector`LinterUI`Private`colorData[
                    "ButtonBackInactive"], "EdgeColor" -> 
                   CodeInspector`LinterUI`Private`colorData["ButtonEdge"], 
                   "EdgeHoverColor" -> 
                   CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeHover"], "EdgeInactiveColor" -> 
                   CodeInspector`LinterUI`Private`colorData[
                    "ButtonEdgeInactive"]}, {Method -> "Queued"}, "ActiveQ"] =!= 
                False, 
                CodeInspector`LinterUI`Private`attachAnalysisAction[
                 EvaluationNotebook[]]]; 
              CodeInspector`LinterUI`Private`mouseDownQ$$ = False), 
             ContentPadding -> False, Evaluator -> Automatic, Method -> 
             "Queued"], DynamicModuleValues :> {}], False -> ButtonBox[
            TemplateBox[{
              StyleBox[
              "\"Analyze Notebook\"", FontColor -> GrayLevel[0.2], FontFamily -> 
               "Source Sans Pro", FontWeight -> Plain, FontSize -> 14, 
               StripOnInput -> False], ImageSize -> {Automatic, 19}, 
              FrameMargins -> {{9, 9}, {0, 0}}, BaselinePosition -> Baseline, 
              Alignment -> {Center, Center}, Background -> GrayLevel[1], 
              FrameStyle -> Dynamic[
                If[
                 CurrentValue["MouseOver"], 
                 Hue[0.55, 0.82, 0.87], 
                 GrayLevel[0.8]]]}, "Highlighted"], 
            Appearance -> {
             "Default" -> 
              Image[RawArray["UnsignedInteger8",{{{255, 255, 255, 255}, {0, 0,
                  0, 255}, {255, 255, 255, 255}}, {{0, 0, 0, 255}, {0, 0, 0, 
                 0}, {0, 0, 0, 255}}, {{255, 255, 255, 255}, {0, 0, 0, 255}, {
                 255, 255, 255, 255}}}], "Byte", ColorSpace -> "RGB", 
                ImageResolution -> {72, 72}, Interleaving -> True], "Hover" -> 
              Image[RawArray["UnsignedInteger8",{{{255, 255, 255, 255}, {0, 0,
                  0, 255}, {255, 255, 255, 255}}, {{0, 0, 0, 255}, {0, 0, 0, 
                 0}, {0, 0, 0, 255}}, {{255, 255, 255, 255}, {0, 0, 0, 255}, {
                 255, 255, 255, 255}}}], "Byte", ColorSpace -> "RGB", 
                ImageResolution -> {72, 72}, Interleaving -> True], "Pressed" -> 
              Image[RawArray["UnsignedInteger8",{{{255, 255, 255, 255}, {0, 0,
                  0, 255}, {255, 255, 255, 255}}, {{0, 0, 0, 255}, {0, 0, 0, 
                 0}, {0, 0, 0, 255}}, {{255, 255, 255, 255}, {0, 0, 0, 255}, {
                 255, 255, 255, 255}}}], "Byte", ColorSpace -> "RGB", 
                ImageResolution -> {72, 72}, Interleaving -> True]}, 
            ButtonFunction :> (CurrentValue[
                EvaluationNotebook[], DockedCells] = 
              With[{LinterUIDockedCell`Private`dockedCells = CurrentValue[
                   EvaluationNotebook[], DockedCells]}, 
                Pick[LinterUIDockedCell`Private`dockedCells, 
                 Map[Quiet[
                    Options[#, CellTags]] =!= {
                   CellTags -> "CodeAnalysisDockedCell"}& , 
                  LinterUIDockedCell`Private`dockedCells]]]; 
             Needs["CodeInspector`"]; 
             CodeInspector`AttachAnalysis[
              LinterUIDockedCell`Private`notebook$$]), Evaluator -> Automatic,
             Method -> "Queued"]}, 
         Dynamic[FEPrivate`EvaluatorStatus["Local"]; TrueQ[
            CodeInspector`LinterUI`Private`varValue[
            LinterUIDockedCell`Private`notebook$$, "DockedCellPresentQ"]]], 
         ImageSize -> Automatic], 
        Offset[{-26, 0}, {1, 0}], {1, 0}], 
       TagBox[
        TagBox[
         TooltipBox[{{
            GrayLevel[0.6], 
            DiskBox[
             Offset[{-11, 0}, {1, 0}], 
             Offset[6]]}, {
            GrayLevel[0.97], 
            AbsoluteThickness[1.5], 
            CapForm["Round"], 
            LineBox[{{
               Offset[{-13, 2}, {1, 0}], 
               Offset[{-9, -2}, {1, 0}]}, {
               Offset[{-13, -2}, {1, 0}], 
               Offset[{-9, 2}, {1, 0}]}}]}}, "\"Close analysis\"", 
          TooltipDelay -> 0, TooltipStyle -> "TextStyling"], 
         Annotation[#, "Close analysis", "Tooltip"]& ], 
        EventHandlerTag[{"MouseClicked" :> (Map[NotebookDelete, 
             Flatten[
              CodeInspector`LinterUI`Private`varValue[
              LinterUIDockedCell`Private`notebook$$, All, 
               "UIAttachedCells"]]]; Map[NotebookDelete, 
             Flatten[
              CodeInspector`LinterUI`Private`varValue[
              LinterUIDockedCell`Private`notebook$$, All, 
               "CleanCellBracketMarker"]]]; CurrentValue[
              EvaluationNotebook[], DockedCells] = 
            With[{LinterUIDockedCell`Private`dockedCells = CurrentValue[
                 EvaluationNotebook[], DockedCells]}, 
              Pick[LinterUIDockedCell`Private`dockedCells, 
               Map[Quiet[
                  Options[#, CellTags]] =!= {
                 CellTags -> "CodeAnalysisDockedCell"}& , 
                LinterUIDockedCell`Private`dockedCells]]]; 
           CodeInspector`LinterUI`Private`applyToVar[Remove, {
              EvaluationNotebook[], All}]; 
           CodeInspector`LinterUI`Private`varSet[{
             LinterUIDockedCell`Private`notebook$$, "DockedCellPresentQ"}, 
             False]), Method -> "Preemptive", PassEventsDown -> Automatic, 
          PassEventsUp -> True}]]}, AspectRatio -> Full, 
      ImageSize -> {Full, 23}, PlotRange -> {{-1, 1}, {-1, 1}}], 
     Deinitialization :> 
     CodeInspector`LinterUI`Private`varSet[{
       LinterUIDockedCell`Private`notebook$$, "DockedCellPresentQ"}, False], 
     DynamicModuleValues :> {}, 
     Initialization :> ({
       LinterUIDockedCell`Private`dockedCellSeverityCountsButton[
          Pattern[LinterUIDockedCell`Private`notebook, 
           Blank[NotebookObject]]] := 
        With[{LinterUIDockedCell`Private`formatIcon = 
           Show[#, ImageSize -> {13, 9}, BaselinePosition -> Scaled[-0.2]]& }, 
          ActionMenu[
           Highlighted[
            Row[{
              CodeInspector`LinterUI`Private`lintSeverityCountsIconRow[
              LinterUIDockedCell`Private`notebook, "exclamSize" -> 12, 
               FontSize -> 14, FontWeight -> Plain], 
              Spacer[2], 
              LinterUIDockedCell`Private`formatIcon[
               CodeInspector`LinterUI`Private`iconData["DownChevron"][
                CodeInspector`LinterUI`Private`colorData["UIDark"]]]}], 
            ImageSize -> {Automatic, 19}, BaselinePosition -> Baseline, 
            Background -> White, Frame -> True, FrameStyle -> Dynamic[
              If[
               CurrentValue["MouseOver"], 
               Hue[0.55, 0.82, 0.87], 
               GrayLevel[0.8]]], FrameMargins -> {6 {1, 1}, {1, 1}}, 
            Alignment -> {Center, Baseline}], 
           Map[
           LinterUIDockedCell`Private`dockedCellMenuItem[
            LinterUIDockedCell`Private`notebook, #]& , 
            CodeInspector`LinterUI`Private`varValue[
            LinterUIDockedCell`Private`notebook, All, "Cell"]], Appearance -> 
           None]], LinterUIDockedCell`Private`dockedCellMenuItem[
          Pattern[LinterUIDockedCell`Private`notebook, 
           Blank[NotebookObject]], 
          Pattern[LinterUIDockedCell`Private`cell, 
           Blank[CellObject]]] := With[{}, Graphics[{
             Inset[
              With[{LinterUIDockedCell`Private`expressionString = First[
                  FrontEndExecute[
                   FrontEnd`ExportPacket[
                    First[
                    CodeInspector`LinterUI`Private`varValue[
                    LinterUIDockedCell`Private`notebook, 
                    LinterUIDockedCell`Private`cell, "CellContents"]], 
                    "InputText"]]]}, {
               LinterUIDockedCell`Private`noLineBreaks = 
                StringReplace[
                 LinterUIDockedCell`Private`expressionString, "\n" -> " "]}, {
               LinterUIDockedCell`Private`previewString = 
                StringTake[LinterUIDockedCell`Private`noLineBreaks, {1, 
                   UpTo[LinterUIDockedCell`Private`$previewLength]}]}, 
               CodeInspector`LinterUI`Private`styleData["FixedWidth"][
                If[
                StringLength[LinterUIDockedCell`Private`expressionString] > 
                 LinterUIDockedCell`Private`$previewLength, 
                 StringDrop[LinterUIDockedCell`Private`previewString, -1] <> 
                 "\[Ellipsis]", 
                 LinterUIDockedCell`Private`previewString]]], {-1, 0}, {-1, 
              0}], 
             Inset[
              CodeInspector`LinterUI`Private`lintSeverityCountsIconRow[
              LinterUIDockedCell`Private`cell], {1, 0}, {1, 0}]}, 
            ImageSize -> {300, 25}, AspectRatio -> Full, 
            PlotRange -> {{-1, 1}, {-1, 1}}, ImagePadding -> None] :> (
           SelectionMove[LinterUIDockedCell`Private`cell, All, Cell]; 
           With[{
             LinterUIDockedCell`Private`nb = 
              ParentNotebook[LinterUIDockedCell`Private`cell]}, 
             FrontEndExecute[
              FrontEnd`FrontEndToken[
              LinterUIDockedCell`Private`nb, "OpenSelectionParents"]]]; 
           SelectionMove[LinterUIDockedCell`Private`cell, After, Cell])], 
        LinterUIDockedCell`Private`$previewLength = 28, 
        CodeInspector`LinterUI`Private`applyToVar[
          Pattern[CodeInspector`LinterUI`Private`function, 
           Blank[]], {
           Pattern[CodeInspector`LinterUI`Private`notebook, 
            Blank[NotebookObject]], All, 
           Pattern[CodeInspector`LinterUI`Private`name, 
            Blank[String]]}, 
          Pattern[CodeInspector`LinterUI`Private`args, 
           BlankNullSequence[]]] := 
        Map[Apply[CodeInspector`LinterUI`Private`function, 
           Join[
            ToHeldExpression[#], 
            Hold[CodeInspector`LinterUI`Private`args]]]& , 
          
          Names[(CodeInspector`LinterUI`Private`varNameString[
             CodeInspector`LinterUI`Private`notebook] <> "*") <> 
           CodeInspector`LinterUI`Private`name]], Null, 
        CodeInspector`LinterUI`Private`applyToVar[
          Pattern[CodeInspector`LinterUI`Private`function, 
           Blank[]], {
           Pattern[CodeInspector`LinterUI`Private`nameArguments, 
            BlankSequence[]], 
           Pattern[CodeInspector`LinterUI`Private`name, 
            Blank[String]]}, 
          Pattern[CodeInspector`LinterUI`Private`args, 
           BlankNullSequence[]]] := 
        Apply[CodeInspector`LinterUI`Private`function, 
          Join[
           ToHeldExpression[
            CodeInspector`LinterUI`Private`varNameString[
            CodeInspector`LinterUI`Private`nameArguments]], 
           Hold[CodeInspector`LinterUI`Private`args]]], Null, 
        CodeInspector`LinterUI`Private`applyToVar[
          Pattern[CodeInspector`LinterUI`Private`function, 
           Blank[]], {
           Pattern[CodeInspector`LinterUI`Private`nameArguments, 
            BlankSequence[]], All}, 
          Pattern[CodeInspector`LinterUI`Private`args, 
           BlankNullSequence[]]] := 
        Map[Apply[CodeInspector`LinterUI`Private`function, 
           Join[
            ToHeldExpression[#], 
            Hold[CodeInspector`LinterUI`Private`args]]]& , 
          Names[
          CodeInspector`LinterUI`Private`varNameString[
            CodeInspector`LinterUI`Private`nameArguments] <> "*"]], 
        CodeInspector`LinterUI`Private`varValue[
          Pattern[CodeInspector`LinterUI`Private`notebook, 
           Blank[NotebookObject]], All, 
          Pattern[CodeInspector`LinterUI`Private`name, 
           Blank[String]]] := Map[Symbol, 
          
          Names[(CodeInspector`LinterUI`Private`varNameString[
             CodeInspector`LinterUI`Private`notebook] <> "*") <> 
           CodeInspector`LinterUI`Private`name]], Null, 
        CodeInspector`LinterUI`Private`varValue[
          Pattern[CodeInspector`LinterUI`Private`nameArguments, 
           BlankSequence[]], 
          Pattern[CodeInspector`LinterUI`Private`name, 
           Blank[String]]] := Symbol[
          CodeInspector`LinterUI`Private`varNameString[
          CodeInspector`LinterUI`Private`nameArguments, 
           CodeInspector`LinterUI`Private`name]], Null, 
        CodeInspector`LinterUI`Private`varValue[
          Pattern[CodeInspector`LinterUI`Private`nameArguments, 
           BlankSequence[]], All] := Map[Symbol, 
          Names[
          CodeInspector`LinterUI`Private`varNameString[
            CodeInspector`LinterUI`Private`nameArguments] <> "*"]], 
        CodeInspector`LinterUI`Private`varSet[{
           Pattern[CodeInspector`LinterUI`Private`nameArguments, 
            BlankSequence[]]}, 
          Pattern[CodeInspector`LinterUI`Private`value, 
           Blank[]]] := Apply[Set, 
          Append[
           ToHeldExpression[
            CodeInspector`LinterUI`Private`varNameString[
            CodeInspector`LinterUI`Private`nameArguments]], 
           CodeInspector`LinterUI`Private`value]], 
        CodeInspector`LinterUI`Private`varNameString[
          Pattern[CodeInspector`LinterUI`Private`notebook, 
           Blank[NotebookObject]]] := ((
           "CodeInspector`LinterUI`Private`Vars`" <> "$$") <> 
          With[{CodeInspector`LinterUI`Private`nbID = 
             Last[CodeInspector`LinterUI`Private`notebook]}, 
            If[
             StringQ[CodeInspector`LinterUI`Private`nbID], 
             StringReplace[CodeInspector`LinterUI`Private`nbID, "-" -> "$"], 
             ToString[CodeInspector`LinterUI`Private`nbID]]]) <> "$$", Null, 
        CodeInspector`LinterUI`Private`varNameString[
          Pattern[CodeInspector`LinterUI`Private`cell, 
           Blank[CellObject]]] := (
          CodeInspector`LinterUI`Private`varNameString[
            Replace[
             ParentNotebook[CodeInspector`LinterUI`Private`cell], $Failed -> 
             EvaluationNotebook[]]] <> 
          With[{CodeInspector`LinterUI`Private`cellID = 
             First[CodeInspector`LinterUI`Private`cell]}, 
            If[
             StringQ[CodeInspector`LinterUI`Private`cellID], 
             StringReplace[CodeInspector`LinterUI`Private`cellID, "-" -> "$"], 
             ToString[CodeInspector`LinterUI`Private`cellID]]]) <> "$$", Null,
         CodeInspector`LinterUI`Private`varNameString[
          Pattern[CodeInspector`LinterUI`Private`notebook, 
           Blank[NotebookObject]], 
          Pattern[CodeInspector`LinterUI`Private`cell, 
           Blank[CellObject]]] := (
          CodeInspector`LinterUI`Private`varNameString[
           CodeInspector`LinterUI`Private`notebook] <> 
          With[{CodeInspector`LinterUI`Private`cellID = 
             First[CodeInspector`LinterUI`Private`cell]}, 
            If[
             StringQ[CodeInspector`LinterUI`Private`cellID], 
             StringReplace[CodeInspector`LinterUI`Private`cellID, "-" -> "$"], 
             ToString[CodeInspector`LinterUI`Private`cellID]]]) <> "$$", Null,
         CodeInspector`LinterUI`Private`varNameString[
          Pattern[CodeInspector`LinterUI`Private`notebook, 
           Blank[NotebookObject]], 
          Pattern[CodeInspector`LinterUI`Private`name, 
           Blank[String]]] := 
        CodeInspector`LinterUI`Private`varNameString[
          CodeInspector`LinterUI`Private`notebook] <> 
         CodeInspector`LinterUI`Private`name, Null, 
        CodeInspector`LinterUI`Private`varNameString[
          Pattern[CodeInspector`LinterUI`Private`cell, 
           Blank[CellObject]], 
          Pattern[CodeInspector`LinterUI`Private`name, 
           Blank[String]]] := 
        CodeInspector`LinterUI`Private`varNameString[
          CodeInspector`LinterUI`Private`cell] <> 
         CodeInspector`LinterUI`Private`name, Null, 
        CodeInspector`LinterUI`Private`varNameString[
          Pattern[CodeInspector`LinterUI`Private`notebook, 
           Blank[NotebookObject]], 
          Pattern[CodeInspector`LinterUI`Private`cell, 
           Blank[CellObject]], 
          Pattern[CodeInspector`LinterUI`Private`name, 
           Blank[String]]] := 
        CodeInspector`LinterUI`Private`varNameString[
          CodeInspector`LinterUI`Private`notebook, 
           CodeInspector`LinterUI`Private`cell] <> 
         CodeInspector`LinterUI`Private`name, Null, 
        CodeInspector`LinterUI`Private`varNameString[
          Pattern[CodeInspector`LinterUI`Private`nameArguments, 
           BlankSequence[]], 
          Pattern[CodeInspector`LinterUI`Private`lint, 
           Blank[CodeInspector`InspectionObject]], 
          Pattern[CodeInspector`LinterUI`Private`name, 
           Blank[String]]] := ((
           CodeInspector`LinterUI`Private`varNameString[
            CodeInspector`LinterUI`Private`nameArguments] <> Apply[Sequence, 
             Riffle[
              Map[StringDelete[
                ToString[#], 
                Alternatives["[", "]", "{", "}", ",", " "]]& , 
               CodeInspector`LinterUI`Private`extractFirstList[
                Last[CodeInspector`LinterUI`Private`lint][
                CodeParser`Source]]], "$"]]) <> "$$") <> 
         CodeInspector`LinterUI`Private`name, 
        CodeInspector`LinterUI`Private`extractFirstList[
          Pattern[CodeInspector`LinterUI`Private`expr, 
           Blank[]]] := FirstCase[CodeInspector`LinterUI`Private`expr, 
          Blank[List], {}, {0, Infinity}]}; 
      LinterUIDockedCell`Private`notebook$$ = EvaluationNotebook[]), 
     UnsavedVariables :> {LinterUIDockedCell`Private`notebook$$}]], 
   CellFrame -> {{0, 0}, {1, 1}}, CellFrameMargins -> {{0, 0}, {0, 0}}, 
   CellFrameColor -> GrayLevel[0.85], Background -> GrayLevel[0.97], CellTags -> 
   "CodeAnalysisDockedCell"]},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->"/home/cica/VQD/Doc/TrappedIonOxford.pdf"},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification->1.,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e52760b8-8500-448b-90cc-ef24d0d0a26e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 233, 4, 98, "Title",ExpressionUUID->"a51a1c00-1c1e-4809-99a7-9b45151e9214"],
Cell[CellGroupData[{
Cell[838, 30, 154, 3, 67, "Section",ExpressionUUID->"4b33baa5-b934-4d77-847a-55ee63f4b597"],
Cell[995, 35, 374, 5, 51, "Text",ExpressionUUID->"c34d2386-44e3-4d12-8bcd-6e0adf0c59d5"],
Cell[1372, 42, 396, 9, 30, "Input",ExpressionUUID->"4fb6ff86-df9c-4786-aab4-c5b29d03d1f8"],
Cell[1771, 53, 649, 12, 74, "Text",ExpressionUUID->"c91ba40d-3b6c-42cd-bdae-10c38124ceab"],
Cell[2423, 67, 1622, 24, 30, "Input",ExpressionUUID->"df0ec05c-7c65-422e-9507-d63ba1cb5d39"],
Cell[4048, 93, 897, 20, 74, "Text",ExpressionUUID->"4cdfcc52-a76b-41a9-a1a1-9fcb87e78202"],
Cell[4948, 115, 2366, 57, 296, "Input",ExpressionUUID->"2b01d8d8-9e6a-499b-97d9-cfce04d9d721"],
Cell[7317, 174, 689, 14, 51, "Text",ExpressionUUID->"5f37c9ba-3582-4916-b8a6-b00b0ad21432"],
Cell[8009, 190, 1226, 18, 30, "Input",ExpressionUUID->"fbda1cba-5510-430b-ae7f-72219c40e12c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9272, 213, 252, 4, 67, "Section",ExpressionUUID->"6507264a-34a1-4c23-92d3-885063f7d4ab"],
Cell[9527, 219, 857, 22, 74, "Text",ExpressionUUID->"01bbf5b7-efb5-4735-b44c-900b069c1b48"],
Cell[10387, 243, 15109, 310, 1248, "Input",ExpressionUUID->"786b6905-0c83-4785-9309-62848193302e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25533, 558, 163, 3, 67, "Section",ExpressionUUID->"ee76f947-9d17-462b-a234-af4aca63054c"],
Cell[CellGroupData[{
Cell[25721, 565, 160, 3, 54, "Subsection",ExpressionUUID->"bcac4c86-b1e1-4542-b4fc-7ae6239c3320"],
Cell[25884, 570, 4173, 126, 565, "Text",ExpressionUUID->"5f86b73e-5906-4bd6-a372-9b5e7579b57a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30094, 701, 245, 4, 54, "Subsection",ExpressionUUID->"df7f5adc-fabd-4e2d-8267-3eddc4da25ee"],
Cell[CellGroupData[{
Cell[30364, 709, 169, 3, 45, "Subsubsection",ExpressionUUID->"cceafc11-93f6-4531-b5ac-663f410eb088"],
Cell[30536, 714, 2377, 57, 122, "Input",ExpressionUUID->"03e5b243-f124-4461-8871-1233f93d5b42"],
Cell[32916, 773, 10333, 198, 400, "Input",ExpressionUUID->"f60c26c3-9869-49be-9a0e-e82ee5d8c8a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43286, 976, 153, 2, 45, "Subsubsection",ExpressionUUID->"0d09c75c-4336-4627-9372-bcfc748516ee"],
Cell[43442, 980, 803, 20, 143, "Text",ExpressionUUID->"6fa19595-4692-4ad3-90b8-49f16d63a9af"],
Cell[44248, 1002, 257, 6, 30, "Input",ExpressionUUID->"e0e61e79-6b77-4564-adaf-086a02d5c273"],
Cell[44508, 1010, 213, 4, 30, "Input",ExpressionUUID->"9021932c-26db-41f0-bdf1-498d426c4af5"],
Cell[44724, 1016, 2050, 54, 55, "Input",ExpressionUUID->"39334818-453d-4215-b01f-6ad2ed45ee64"],
Cell[46777, 1072, 675, 17, 75, "Input",ExpressionUUID->"71410c7e-f05e-4826-825b-04095afafaf7"],
Cell[47455, 1091, 1218, 22, 52, "Input",ExpressionUUID->"d6f1e258-c049-4570-8952-bb2893609008"],
Cell[48676, 1115, 639, 12, 97, "Text",ExpressionUUID->"7dae8c7a-ebe8-4914-93d1-8e3024725605"],
Cell[49318, 1129, 679, 12, 30, "Input",ExpressionUUID->"797106b3-7c71-46e2-9680-68c6566ce39f"],
Cell[50000, 1143, 286, 7, 52, "Input",ExpressionUUID->"0e5d8bf2-f763-4d13-a0a8-6241d4c6798d"],
Cell[50289, 1152, 1243, 25, 52, "Input",ExpressionUUID->"b16782ff-ea3f-4153-83cb-c675797578e7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51593, 1184, 163, 3, 67, "Section",ExpressionUUID->"4d518824-3f83-4b77-a8e8-2e70512d2626"],
Cell[51759, 1189, 324, 6, 116, "Text",ExpressionUUID->"05c61d37-69ab-4228-821a-8220f8441e07"],
Cell[CellGroupData[{
Cell[52108, 1199, 561, 8, 70, "Subsection",ExpressionUUID->"2346cce6-bd8a-4ae4-88e1-f897966b2804"],
Cell[52672, 1209, 2642, 72, 116, "Input",ExpressionUUID->"ac997f37-7bc1-4400-8f6f-8e60e3a8e708"],
Cell[55317, 1283, 1360, 32, 52, "Input",ExpressionUUID->"f4deb039-2160-42a2-8905-5af66b54d369"],
Cell[56680, 1317, 38054, 788, 1243, "Input",ExpressionUUID->"87274038-e121-4cf6-9854-097f3a94bf01"],
Cell[94737, 2107, 1190, 29, 117, "Input",ExpressionUUID->"e2c13b9e-6493-4273-bffb-d347d86e3701"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95964, 2141, 358, 5, 70, "Subsection",ExpressionUUID->"b5ebd345-aa7c-4daf-9611-4bab62c48860"],
Cell[96325, 2148, 3138, 82, 264, "Input",ExpressionUUID->"d3ef4b57-c915-44e7-a2dd-e988c9b334d5"],
Cell[99466, 2232, 453, 10, 52, "Input",ExpressionUUID->"d48cda91-007d-4a92-a018-55359e2beb65"],
Cell[99922, 2244, 1862, 42, 161, "Input",ExpressionUUID->"d7c1c783-cec8-462f-838c-0b4172fe2dec"],
Cell[101787, 2288, 545, 10, 30, "Input",ExpressionUUID->"bb61045a-5708-4fa8-8e50-1a90d6b07112"],
Cell[102335, 2300, 4653, 78, 75, "Input",ExpressionUUID->"f0cc4e96-9a39-48b4-b95c-b540a2ea63f5"],
Cell[106991, 2380, 1416, 37, 96, "Input",ExpressionUUID->"fe995218-246c-4fee-aa17-401bf29eba72"],
Cell[108410, 2419, 1756, 45, 96, "Input",ExpressionUUID->"ebc8df5a-99d7-46cc-8e7e-18544fab8380"],
Cell[110169, 2466, 395, 7, 35, "Text",ExpressionUUID->"5b88e094-8202-4d6a-b4a7-8863f2549d92"],
Cell[110567, 2475, 1093, 28, 94, "Input",ExpressionUUID->"d23bce0c-c94e-4222-8c3c-d8d1cf4feb15"],
Cell[111663, 2505, 4529, 110, 222, "Input",ExpressionUUID->"40a5e3e9-6aeb-4401-81fb-30579028eaec"],
Cell[116195, 2617, 895, 19, 32, "Input",ExpressionUUID->"9239bfde-225f-433c-bcb1-7600c98e278a"],
Cell[117093, 2638, 2239, 70, 137, "Input",ExpressionUUID->"a6d599fc-d587-4710-b29e-3d6d554fc408"],
Cell[119335, 2710, 1460, 24, 164, "CodeText",ExpressionUUID->"b85a9973-7bc5-4b44-9ccd-a70961042840"],
Cell[120798, 2736, 738, 20, 52, "Input",ExpressionUUID->"71bc1a0a-e577-47b7-9c9a-ae87bc85dd8e"],
Cell[121539, 2758, 208, 4, 30, "Input",ExpressionUUID->"fa5e7bdc-88e3-427c-bf80-99959d759f7a"],
Cell[121750, 2764, 5113, 110, 165, "Input",ExpressionUUID->"d639a4b0-d054-48ab-be36-34eeeb89e9f3"],
Cell[126866, 2876, 552, 11, 30, "Input",ExpressionUUID->"9523d609-5184-43cd-a526-9a9227181714"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127455, 2892, 324, 5, 70, "Subsection",ExpressionUUID->"3f783393-ac8c-4ab4-a534-ae0c5bd4afff"],
Cell[127782, 2899, 1889, 52, 116, "Input",ExpressionUUID->"7358bde7-d760-48d2-a30e-a9d7b2f005e4"],
Cell[129674, 2953, 284, 6, 51, "Text",ExpressionUUID->"97b80097-e3fc-4199-a26e-1b9a93f8c2b2"],
Cell[129961, 2961, 1813, 45, 99, "Input",ExpressionUUID->"df2979d7-6aea-44c5-b924-a9814fe7a265"],
Cell[131777, 3008, 186, 3, 30, "Input",ExpressionUUID->"b1d09550-43c2-47bd-9fe0-461e02505612"],
Cell[131966, 3013, 214, 3, 51, "Text",ExpressionUUID->"a5df5110-0fd0-4f59-95af-b87d1cde141d"],
Cell[132183, 3018, 3526, 82, 567, "Input",ExpressionUUID->"5622a493-a0b4-436f-bfc2-16b8b98fbbb0"],
Cell[135712, 3102, 4201, 103, 360, "Input",ExpressionUUID->"5d25a051-a48d-413a-91e9-9803893a2ce4"],
Cell[139916, 3207, 3199, 90, 296, "Input",ExpressionUUID->"a1d9d6fe-4d77-465f-8d38-897f12b65ea7"],
Cell[143118, 3299, 3805, 82, 116, "Input",ExpressionUUID->"766981d0-25ba-4bb3-8b17-25440479f9ad"],
Cell[146926, 3383, 570, 12, 30, "Input",ExpressionUUID->"680ebf8a-8cf5-4300-8287-82272cc75fdd"],
Cell[147499, 3397, 3673, 99, 140, "Input",ExpressionUUID->"8c96a286-281a-47fc-9d53-8318ea8fb1d2"],
Cell[151175, 3498, 746, 18, 52, "Input",ExpressionUUID->"caefc5f7-ee4e-475c-9600-a66654fd7769"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151970, 3522, 329, 5, 71, "Section",ExpressionUUID->"c3f2ea48-ae1d-4efa-8bf6-1368070e1557"],
Cell[152302, 3529, 6065, 148, 505, "Input",ExpressionUUID->"2dc02453-c30c-4171-84c2-3faa7e72a7d0"],
Cell[158370, 3679, 6533, 149, 477, "Input",ExpressionUUID->"83c7d16c-2505-409f-bf3e-e1247161be48"],
Cell[164906, 3830, 1524, 23, 51, "Text",ExpressionUUID->"453edd7e-2e6c-43ba-9600-7935556a2771"],
Cell[166433, 3855, 508, 11, 101, "CodeText",ExpressionUUID->"4f062133-6618-46f6-964e-749e76969d7a"],
Cell[166944, 3868, 676, 13, 30, "Input",ExpressionUUID->"1e69bf1f-4d11-4841-8973-cbedf4861bd8"],
Cell[167623, 3883, 286, 5, 30, "Input",ExpressionUUID->"91c99e6e-02e8-436d-a484-ebb28c3d6da4"],
Cell[167912, 3890, 3090, 67, 158, "Input",ExpressionUUID->"b7dac390-543d-424a-8cc7-15acb1e3dc15"]
}, Open  ]]
}, Open  ]]
}
]
*)


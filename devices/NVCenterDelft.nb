(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    135186,       3085]
NotebookOptionsPosition[    126368,       2955]
NotebookOutlinePosition[    126873,       2974]
CellTagsIndexPosition[    126830,       2971]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["NV-center qubits", "Title",
 CellChangeTimes->{{3.8250058175043*^9, 3.825005854301442*^9}, {
  3.825006152419363*^9, 3.825006172060075*^9}, {3.825680827842572*^9, 
  3.8256808389487886`*^9}, {3.825701169183799*^9, 3.825701169340406*^9}, {
  3.826958311226933*^9, 3.826958327332601*^9}, {3.8416873769652023`*^9, 
  3.8416873816744013`*^9}, {3.874399170443549*^9, 
  3.874399173841239*^9}},ExpressionUUID->"d15a831b-a7a9-4c44-9fc8-\
632f14beb7e9"],

Cell[TextData[{
 StyleBox["This virtual quantum device is inspired by devices reported by the \
Delft team",
  FontSlant->"Italic"],
 " ",
 StyleBox[" ",
  FontWeight->"Bold"]
}], "Subtitle",
 CellChangeTimes->{{3.826958436240924*^9, 3.82695870921028*^9}, {
   3.826958746200656*^9, 3.826958748636915*^9}, {3.8269589094382772`*^9, 
   3.826958914251007*^9}, {3.826958951579002*^9, 3.826958954435522*^9}, {
   3.8269590097304707`*^9, 3.826959014248453*^9}, {3.826960919158531*^9, 
   3.826960922263524*^9}, {3.827395161984859*^9, 3.8273951859009943`*^9}, {
   3.827395229711132*^9, 3.827395234035915*^9}, {3.834479944833457*^9, 
   3.834479986961046*^9}, {3.8344801203580437`*^9, 3.834480142706661*^9}, {
   3.8406210641930523`*^9, 3.840621091644374*^9}, {3.840628127190097*^9, 
   3.8406281499484463`*^9}, {3.84168740096542*^9, 3.8416874088126173`*^9}, {
   3.841687497082028*^9, 3.841687505930637*^9}, {3.84168774400422*^9, 
   3.841687756123467*^9}, 3.841713473156818*^9, {3.841716840880055*^9, 
   3.841716841058804*^9}, {3.841717533373096*^9, 3.841717544431862*^9}, {
   3.841718923859845*^9, 3.841718936706002*^9}, {3.841824445344933*^9, 
   3.841824448382442*^9}, {3.8432007891831427`*^9, 3.8432008059778957`*^9}, {
   3.8782095961611423`*^9, 3.878209596781719*^9}, {3.8952152043825397`*^9, 
   3.8952152486073627`*^9}, {3.895591013275625*^9, 
   3.895591014416366*^9}},ExpressionUUID->"86b6ae0c-b31f-476a-8cfd-\
71aa29495616"],

Cell[CellGroupData[{

Cell["VQD setup", "Section",
 CellChangeTimes->{{3.895564711188003*^9, 
  3.895564736046365*^9}},ExpressionUUID->"2ac9a657-8798-4d2d-b923-\
97964512c847"],

Cell["Set the main directory as the current directory", "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.8528844215679693`*^9, 3.8528844367050333`*^9}, {3.895561738644601*^9, 
  3.895561955745701*^9}, {3.895565197806723*^9, 3.895565201167206*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"3304fd8a-d7dc-4a75-8cf8-3d33d0cf0751"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.872921462633623*^9, {3.895561958967956*^9, 3.895561969776804*^9}, {
   3.895564630836348*^9, 3.895564635452001*^9}, {3.895565208327444*^9, 
   3.89556521021968*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"aed5bfe1-5767-4439-be35-1e2df05d494a"],

Cell[TextData[{
 "Load the QuESTLink package",
 StyleBox["\nOne may also use the off-line questlink.m file, change it to the \
location of the local file",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.895555062959041*^9, 3.895555112315363*^9}, {3.8955551881974287`*^9, 
  3.895555260300796*^9}, {3.895555597085835*^9, 3.895555664673655*^9}, {
  3.895560998697385*^9, 3.895561075198522*^9}, {3.8955620885151787`*^9, 
  3.895562088990657*^9}, {3.8955621274003143`*^9, 3.8955621439683104`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"ce76efab-251b-412c-b6a3-02c0d0c36601"],

Cell[BoxData[
 RowBox[{"Import", "[", "\"\<https://qtechtheory.org/questlink.m\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.82497505062926*^9, 3.8249750506297073`*^9}, 
   3.824994043627574*^9, 3.825001607792643*^9, {3.825001692867886*^9, 
   3.825001693910748*^9}, 3.825005541672139*^9, {3.8257703632332573`*^9, 
   3.8257703928999557`*^9}, {3.8257705549908867`*^9, 
   3.8257705572226887`*^9}, {3.827395402084569*^9, 3.827395414565299*^9}, 
   3.8273959879208593`*^9, {3.8273960394479303`*^9, 3.8273960853619223`*^9}, {
   3.8273961168062162`*^9, 3.827396123715522*^9}, {3.827396318549856*^9, 
   3.827396412632536*^9}, {3.8274045827011538`*^9, 3.82740458379325*^9}, {
   3.8278173564819393`*^9, 3.827817361228321*^9}, {3.830976734134877*^9, 
   3.8309767494625072`*^9}, {3.834480282684927*^9, 3.834480283538302*^9}, {
   3.834480426528635*^9, 3.834480438344689*^9}, {3.840643429673587*^9, 
   3.84064343214264*^9}, {3.840644090065632*^9, 3.840644110294639*^9}, {
   3.841376639126837*^9, 3.841376652890356*^9}, {3.852805051225027*^9, 
   3.852805051940732*^9}, 3.852866941489101*^9, 3.863433244574464*^9, {
   3.863444417946168*^9, 3.8634444207524557`*^9}, {3.863758485466724*^9, 
   3.8637585009226294`*^9}, {3.863763334072833*^9, 3.8637633356047773`*^9}, {
   3.875107822325452*^9, 3.8751078327815647`*^9}, {3.8833829933758574`*^9, 
   3.883382993547421*^9}, {3.8955550552579536`*^9, 3.8955550607116213`*^9}, {
   3.895555251924384*^9, 3.895555252843107*^9}, 3.895560933223365*^9, {
   3.895562150271586*^9, 3.895562151551223*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"6e693605-cc17-45f2-9601-2db93546cf18"],

Cell[TextData[{
 "This will download a binary file  ",
 StyleBox["quest_link",
  FontWeight->"Bold"],
 " if there is no such file found",
 StyleBox["\n",
  FontSlant->"Italic"],
 "Otherwise, use a locally-compiled that called ",
 StyleBox["quest_link*",
  FontWeight->"Bold"],
 " "
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.895555062959041*^9, 3.895555112315363*^9}, {3.8955551881974287`*^9, 
  3.895555260300796*^9}, {3.895555597085835*^9, 3.895555664673655*^9}, {
  3.895560998697385*^9, 3.895561075198522*^9}, {3.895562094495385*^9, 
  3.895562099994422*^9}, {3.8955621743068743`*^9, 3.89556218382623*^9}, {
  3.895562229085458*^9, 3.895562229999806*^9}, {3.8955623057350197`*^9, 
  3.895562353406741*^9}, {3.8955652259848747`*^9, 3.8955652439751587`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"de033515-a5bc-4ab2-8f5f-0a6afdcdab37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Search", " ", "for", " ", "existing", " ", "files", " ", "that", " ", 
    "match", " ", "the", " ", "pattern", " ", "\"\<quest_link*\>\""}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"questLinkFiles", "=", 
       RowBox[{"Sort", "@", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<quest_link*\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"NotebookDirectory", "[", "]"}], "}"}]}], "]"}]}]}], "}"}],
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "questLinkFiles", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "If", " ", "one", " ", "or", " ", "more", " ", "matching", " ", 
           "files", " ", "are", " ", "found"}], ",", " ", 
          RowBox[{
          "use", " ", "the", " ", "first", " ", "one", " ", 
           "alphabetically"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Using the existing link file: \>\"", ",", 
           RowBox[{"First", "@", "questLinkFiles"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"CreateLocalQuESTEnv", "[", 
          RowBox[{"First", "@", "questLinkFiles"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "If", " ", "no", " ", "matching", " ", "files", " ", "are", " ", 
           "found"}], ",", " ", 
          RowBox[{"download", " ", "the", " ", "link", " ", "file"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<No link file found, download quest_link\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"CreateDownloadedQuESTEnv", "[", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.895562380629335*^9, 3.8955623806299543`*^9}, {
  3.8955642461170387`*^9, 3.895564576316752*^9}, {3.8955654013994617`*^9, 
  3.8955654071519136`*^9}, {3.8955668835199842`*^9, 3.895566963802331*^9}, {
  3.895567025375177*^9, 3.895567027172988*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"2b6af876-686f-4f13-a448-c8adbd2fd37b"],

Cell[TextData[{
 "Load the ",
 StyleBox["VQD",
  FontWeight->"Bold"],
 " package; must be loaded after QuESTlink is loaded"
}], "Text",
 CellChangeTimes->{{3.8344802680745296`*^9, 3.83448027667835*^9}, {
  3.8406416900502462`*^9, 3.840641698118609*^9}, {3.840641813367085*^9, 
  3.840641822804656*^9}, {3.853839759327433*^9, 3.853839762140107*^9}, {
  3.86344845184791*^9, 3.863448455324099*^9}, {3.8637680860803547`*^9, 
  3.863768086918572*^9}, {3.895562384490183*^9, 3.895562387907646*^9}, {
  3.895562552053419*^9, 3.8955625677886047`*^9}, {3.895565295097423*^9, 
  3.895565315981283*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1a57288f-5674-4f4e-a47b-92ef1e42b7c2"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<../vqd.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.840641143565943*^9, 3.840641172251192*^9}, {
   3.852799583306651*^9, 3.85279959973236*^9}, 3.8626416092550993`*^9, {
   3.8634335183180933`*^9, 3.863433525482596*^9}, {3.863433568660131*^9, 
   3.863433569874107*^9}, {3.863433692497489*^9, 3.863433694465293*^9}, {
   3.863445057138888*^9, 3.86344507880478*^9}, {3.863445347209435*^9, 
   3.8634453507921267`*^9}, {3.863445650432852*^9, 3.863445652815689*^9}, {
   3.863445897019453*^9, 3.8634458974688377`*^9}, {3.86344607759472*^9, 
   3.863446078099331*^9}, {3.863446143635272*^9, 3.863446143966124*^9}, {
   3.863446177367778*^9, 3.86344617796842*^9}, {3.8634467623389387`*^9, 
   3.863446816486045*^9}, {3.863446923713131*^9, 3.863446924990855*^9}, {
   3.863447604132453*^9, 3.8634476320572042`*^9}, {3.863448157317191*^9, 
   3.863448185412036*^9}, {3.86344848550739*^9, 3.863448486307929*^9}, {
   3.863730635263914*^9, 3.863730645543404*^9}, {3.863730806825498*^9, 
   3.863730825085904*^9}, {3.864798306500605*^9, 3.864798308030095*^9}, {
   3.864808339041327*^9, 3.864808339281568*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"0bca19ed-8b53-40a5-b274-5d8948466e3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["User device configuration", "Section",
 CellChangeTimes->{{3.8249929152945337`*^9, 3.8249929237992496`*^9}, {
   3.824993158202837*^9, 3.8249931583687563`*^9}, 3.8278173822354846`*^9, {
   3.84062160567876*^9, 3.840621607684407*^9}, {3.8408643100669107`*^9, 
   3.8408643141143847`*^9}},ExpressionUUID->"0a272559-54f5-4241-a2ef-\
952b0c75bf12"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
     StyleBox["Qubit",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox["0",
      FontWeight->"Bold"], " ", "indicates", " ", 
     StyleBox["electron", "Item",
      FontSlant->"Italic"], " ", "spin"}], "Item",
    FontSlant->"Italic"], 
   StyleBox[",", "Item",
    FontSlant->"Italic"], 
   RowBox[{
    RowBox[{
     StyleBox["and", "Item",
      FontSlant->"Italic"], 
     StyleBox[" ", "Item",
      FontSlant->"Italic"], 
     StyleBox["the", "Item",
      FontSlant->"Italic"], 
     StyleBox[" ", "Item",
      FontSlant->"Italic"], 
     StyleBox["rest", "Item",
      FontSlant->"Italic"], 
     StyleBox[" ", "Item",
      FontSlant->"Italic"], 
     StyleBox["are", "Item",
      FontSlant->"Italic"], 
     StyleBox[" ", "Item",
      FontSlant->"Italic"], 
     StyleBox["nuclear", "Item",
      FontSlant->"Italic"], 
     StyleBox[" ", "Item",
      FontSlant->"Italic"], 
     StyleBox["spins", "Item",
      FontSlant->"Italic"], 
     StyleBox["  ", "Item",
      FontSlant->"Italic"], 
     SuperscriptBox[
      StyleBox["C", "Item",
       FontSlant->"Italic"], "13"], " ", "and", " ", 
     SuperscriptBox["N", "14"]}], " ", "-", " ", 
    RowBox[{"if", " ", "applicable"}]}]}],
  FontSlant->"Italic"], "\[IndentingNewLine]", 
 RowBox[{
  StyleBox[
   StyleBox["Time", "Item"],
   FontSlant->"Italic"], 
  StyleBox[
   StyleBox[" ", "Item"],
   FontSlant->"Italic"], 
  StyleBox[
   StyleBox["unit", "Item"],
   FontSlant->"Italic"], 
  StyleBox[
   StyleBox[" ", "Item"],
   FontSlant->"Italic"], 
  StyleBox[
   StyleBox["is", "Item"],
   FontSlant->"Italic"], 
  StyleBox[
   StyleBox[" ", "Item"],
   FontSlant->"Italic"], 
  StyleBox["second",
   FontWeight->"Bold",
   FontSlant->"Italic"], 
  StyleBox[" ",
   FontWeight->"Bold"], 
  StyleBox[
   RowBox[{"(", "s", ")"}],
   FontWeight->"Bold"]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   StyleBox["Frequency", "Item"], 
   StyleBox[" ", "Item"], 
   StyleBox[
    RowBox[{
     StyleBox["un", "Item",
      FontSlant->"Italic"], 
     StyleBox["it", "Item"]}]], 
   StyleBox[" ", "Item",
    FontSlant->"Italic"], 
   StyleBox[
    StyleBox[
     StyleBox["i", "Item",
      FontSlant->"Italic"], "Item",
     FontSlant->"Italic"], "Item",
    FontSlant->"Italic"], 
   StyleBox["s", "Item",
    FontSlant->"Italic"], 
   StyleBox[
    StyleBox[
     RowBox[{
      StyleBox[
       StyleBox[" ", "Item",
        FontSlant->"Italic"], "Item",
       FontSlant->"Italic"], " "}]], "Item"], 
   StyleBox["Hertz", "Item",
    FontWeight->"Bold",
    FontSlant->"Italic"], 
   StyleBox[" ", "Item",
    FontWeight->"Bold"], 
   RowBox[{
    StyleBox["(", "Item",
     FontWeight->"Bold"], 
    StyleBox["Hz", "Item",
     FontWeight->"Bold"], 
    StyleBox[")", "Item",
     FontWeight->"Bold"]}]}],
  FontSlant->"Italic"]}], "Text",
 CellChangeTimes->{
  3.841715637216041*^9, {3.8417156773106003`*^9, 3.8417157656788816`*^9}, {
   3.841716249254241*^9, 3.8417162652260838`*^9}, {3.84171947754889*^9, 
   3.841719504723343*^9}, {3.843028251258917*^9, 3.843028268550901*^9}, {
   3.843028500736265*^9, 3.843028521325233*^9}, {3.843068845586892*^9, 
   3.8430688793558073`*^9}, {3.8743991864639606`*^9, 
   3.8743991875176783`*^9}, {3.874656631352333*^9, 3.874656637623746*^9}, {
   3.8955910399617968`*^9, 3.895591052217523*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"e73935be-87b8-409b-a155-d15789a0d941"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NVCenterDelft", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"QubitNum", "\[Rule]", "6"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"T1", " ", "of", " ", "each", " ", "qubit"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", " ", "3600"}], ",", 
        RowBox[{"1", "\[Rule]", "60"}], ",", 
        RowBox[{"2", "\[Rule]", "60"}], ",", 
        RowBox[{"3", "\[Rule]", "60"}], ",", 
        RowBox[{"4", "\[Rule]", "60"}], ",", 
        RowBox[{"5", "\[Rule]", "60"}]}], " ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"T2", " ", "of", " ", "each", " ", "qubit"}], ";", " ", 
       RowBox[{
       "we", " ", "assume", " ", "dynamical", " ", "decoupling", " ", "is", 
        " ", "actively", " ", "applied"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"T2", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", " ", "1.5"}], ",", 
        RowBox[{"1", "\[Rule]", "10"}], ",", 
        RowBox[{"2", "\[Rule]", "10"}], ",", 
        RowBox[{"3", "\[Rule]", "10"}], ",", 
        RowBox[{"4", "\[Rule]", "9"}], ",", 
        RowBox[{"5", "\[Rule]", "9"}]}], "|>"}]}], "\[IndentingNewLine]", ",",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "dipolar", " ", "interaction", " ", "among", " ", "nuclear", " ", 
       RowBox[{"spins", ":", " ", 
        RowBox[{"cross", "-", 
         RowBox[{"talk", " ", "ZZ"}], "-", 
         RowBox[{
         "coupling", " ", "in", " ", "order", " ", "of", " ", "a", " ", "few",
           " ", "Hz", " ", "on", " ", "passive", " ", "noise"}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FreqWeakZZ", "->", "5"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "direct", " ", "single", " ", "rotation", " ", "on", " ", "Nuclear", 
        " ", "spin", " ", "is", " ", "done", " ", "via", " ", "RF"}], ",", 
       " ", 
       RowBox[{
        RowBox[{"put", " ", "electron", " ", "in", " ", "state"}], " ", "-", 
        RowBox[{
        "1", " ", "leave", " ", "out", " ", "the", " ", "Rx", " ", "Ry", " ", 
         "on", " ", "nuclear", " ", "spins", " ", 
         RowBox[{"ideally", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FreqSingleXY", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", 
         RowBox[{"15", "*", 
          SuperscriptBox["10", "6"]}]}], ",", 
        RowBox[{"1", "\[Rule]", "500"}], " ", ",", 
        RowBox[{"2", "\[Rule]", "500"}], ",", 
        RowBox[{"3", "\[Rule]", "500"}], ",", 
        RowBox[{"4", "\[Rule]", "500"}], ",", 
        RowBox[{"5", "\[Rule]", "500"}]}], "|>"}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"usually", " ", "done", " ", "virtually"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"FreqSingleZ", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", 
         RowBox[{"32", "*", 
          SuperscriptBox["10", "6"]}]}], ",", 
        RowBox[{"1", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"5", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}]}], "|>"}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Frequency", " ", "of", " ", "CRot", " ", "gate"}], ",", " ", 
       RowBox[{
        RowBox[{
        "conditional", " ", "rotation", " ", "done", " ", "via", " ", 
         "dynamical", " ", "decoupling", " ", "or", " ", "dd"}], "+", 
        RowBox[{
         RowBox[{"RF", ".", " ", "The"}], " ", "gate", " ", "is", " ", 
         "conditioned", " ", "on", " ", "electron", " ", "spin", " ", 
         "state"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FreqCRot", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"1", "\[Rule]", " ", 
         RowBox[{"1.5", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"2.8", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"0.8", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", "3"]}]}], " ", ",", 
        RowBox[{"5", "\[Rule]", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", "3"]}]}]}], "|>"}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fidelity", " ", "of", " ", "CRot", " ", "gate"}], "  ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"FidCRot", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"1", "\[Rule]", " ", "0.98"}], ",", 
        RowBox[{"2", "\[Rule]", "0.98"}], ",", " ", 
        RowBox[{"3", "\[Rule]", "0.98"}], ",", 
        RowBox[{"4", "\[Rule]", "0.98"}], " ", ",", 
        RowBox[{"5", "\[Rule]", "0.98"}]}], "|>"}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"fidelity", " ", "of", " ", "x"}], "-", " ", 
       RowBox[{"and", " ", "y"}], "-", " ", 
       RowBox[{"rotations", " ", "on", " ", "each", " ", "qubit"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidSingleXY", "\[Rule]", " ", 
      RowBox[{"<|", " ", 
       RowBox[{
        RowBox[{"0", "->", "0.9995"}], ",", 
        RowBox[{"1", "\[Rule]", " ", "0.995"}], ",", 
        RowBox[{"2", "\[Rule]", "0.995"}], ",", " ", 
        RowBox[{"3", "\[Rule]", "0.99"}], ",", 
        RowBox[{"4", "\[Rule]", "0.99"}], ",", 
        RowBox[{"5", "\[Rule]", "0.99"}]}], " ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"fidelity", " ", "of", " ", "z"}], "-", " ", 
       RowBox[{"rotations", " ", "on", " ", "each", " ", "qubit"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidSingleZ", "\[Rule]", "  ", 
      RowBox[{"<|", " ", 
       RowBox[{
        RowBox[{"0", "\[Rule]", "0.9999"}], ",", 
        RowBox[{"1", "\[Rule]", " ", "0.9999"}], ",", 
        RowBox[{"2", "\[Rule]", "0.99999"}], ",", " ", 
        RowBox[{"3", "\[Rule]", "0.9999"}], ",", 
        RowBox[{"4", "\[Rule]", "0.999"}], ",", 
        RowBox[{"6", "\[Rule]", "0.99"}]}], " ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Error", " ", "ratio", " ", "of", " ", "1"}], "-", 
       RowBox[{"qubit", " ", 
        RowBox[{"depolarising", ":", 
         RowBox[{
          RowBox[{"dephasing", " ", "of", " ", "x"}], "-", " ", 
          RowBox[{"and", " ", "y"}], "-", " ", "rotations"}]}]}]}], "  ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"EFSingleXY", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.75", ",", "0.25"}], "}"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Error", " ", "ratio", " ", "of", " ", "2"}], "-", 
       RowBox[{"qubit", " ", 
        RowBox[{"depolarising", ":", 
         RowBox[{"dephasing", " ", "of", " ", "CRot", " ", "gate"}]}]}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"EFCRot", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.9", ",", "0.1"}], "}"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "initialization", " ", "fidelity", " ", "on", " ", "the", " ", 
       "electron", " ", "spin"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidInit", "\[Rule]", " ", "0.999"}], "\[IndentingNewLine]", ",",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "initialization", " ", "duration", " ", "on", " ", "the", " ", 
       "electron", " ", "spin"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DurInit", "\[Rule]", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "measurement", " ", "fidelity", " ", "on", " ", "the", " ", "electron", 
       " ", "spin"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FidMeas", "\[Rule]", "0.946"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "measurement", " ", "duration", " ", "on", " ", "the", " ", "electron", 
       " ", "spin"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DurMeas", "\[Rule]", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.839927894188654*^9, 3.839927952581277*^9}, {
   3.839928029922587*^9, 3.839928046721136*^9}, {3.839928246950265*^9, 
   3.839928262119294*^9}, {3.8399286207664022`*^9, 3.839928720887143*^9}, {
   3.8399288618708057`*^9, 3.83992887251727*^9}, {3.839928925503862*^9, 
   3.839928971864064*^9}, {3.83992907542708*^9, 3.8399291045361767`*^9}, {
   3.8399293759348373`*^9, 3.839929480647541*^9}, {3.839929577617025*^9, 
   3.839929648031954*^9}, {3.83993004543258*^9, 3.839930072321351*^9}, {
   3.83993020962976*^9, 3.839930232773197*^9}, {3.839930274528823*^9, 
   3.839930277593523*^9}, {3.8399307224513187`*^9, 3.839930830955441*^9}, {
   3.839931585484889*^9, 3.839931624130921*^9}, {3.839931788553652*^9, 
   3.8399318472749577`*^9}, {3.83993189166255*^9, 3.839931905352229*^9}, {
   3.840620946650152*^9, 3.840620978375165*^9}, {3.8406211163595047`*^9, 
   3.840621128500163*^9}, {3.8406216205788*^9, 3.8406218259771547`*^9}, {
   3.8406267015141897`*^9, 3.840626703302083*^9}, {3.840626927319627*^9, 
   3.840626928476633*^9}, 3.840626959474154*^9, {3.840627910638591*^9, 
   3.840627915461671*^9}, {3.8406281996832952`*^9, 3.840628201096939*^9}, {
   3.840628248803946*^9, 3.840628259385092*^9}, {3.840628298349492*^9, 
   3.8406282985394793`*^9}, 3.840629322197307*^9, {3.840629392496458*^9, 
   3.8406294019266253`*^9}, {3.840632173074717*^9, 3.8406322572174673`*^9}, {
   3.840632296748095*^9, 3.8406323054063387`*^9}, {3.840633033371242*^9, 
   3.84063303460853*^9}, {3.840637248337503*^9, 3.840637288889265*^9}, {
   3.840637375987792*^9, 3.840637401249991*^9}, {3.8406409662960443`*^9, 
   3.840640972189267*^9}, {3.8406410116562243`*^9, 3.840641075234317*^9}, 
   3.840641861810402*^9, {3.840676696314556*^9, 3.840676785547518*^9}, {
   3.84067700175491*^9, 3.840677017070404*^9}, {3.840677053760272*^9, 
   3.840677054218577*^9}, {3.840677429102162*^9, 3.840677463602701*^9}, {
   3.840678774033126*^9, 3.840678790926889*^9}, {3.8406788389682817`*^9, 
   3.840678884533679*^9}, {3.840679207357553*^9, 3.8406792301096077`*^9}, {
   3.840679697950511*^9, 3.8406797648283052`*^9}, {3.840680599637253*^9, 
   3.840680612593231*^9}, {3.840680709961953*^9, 3.840680792867894*^9}, {
   3.840681244498385*^9, 3.8406812468223877`*^9}, 3.84068188288124*^9, {
   3.8406840768467417`*^9, 3.8406840787155447`*^9}, {3.840684501115375*^9, 
   3.8406845040642*^9}, {3.840693459343346*^9, 3.84069349834074*^9}, {
   3.840693553142766*^9, 3.8406935542669573`*^9}, {3.8406936048387003`*^9, 
   3.84069361284754*^9}, {3.8406937005718803`*^9, 3.840693735082555*^9}, {
   3.840694022007649*^9, 3.840694023467018*^9}, {3.840694214112988*^9, 
   3.8406942482534523`*^9}, {3.8406942878180943`*^9, 3.840694337399006*^9}, {
   3.840701231526004*^9, 3.840701249885461*^9}, {3.840701744740078*^9, 
   3.840701786377056*^9}, {3.8408650745132303`*^9, 3.840865074751299*^9}, {
   3.8411249334184837`*^9, 3.841124939113748*^9}, {3.8411655615655193`*^9, 
   3.8411655640734797`*^9}, 3.841165620199329*^9, {3.841197442537198*^9, 
   3.8411974621850433`*^9}, {3.8411975089512777`*^9, 3.841197523167035*^9}, {
   3.8412229382799997`*^9, 3.8412229660034*^9}, {3.841223159130073*^9, 
   3.841223169820677*^9}, {3.841224532549408*^9, 3.841224532856201*^9}, {
   3.841224563912829*^9, 3.841224564140698*^9}, {3.84122471465732*^9, 
   3.841224715253039*^9}, {3.841224753263679*^9, 3.84122475539332*^9}, {
   3.841224973808148*^9, 3.8412249930192623`*^9}, {3.84122533118598*^9, 
   3.8412253375791473`*^9}, {3.841225380926779*^9, 3.8412253877181807`*^9}, {
   3.8412254544869337`*^9, 3.841225499853939*^9}, {3.841225636115481*^9, 
   3.841225637272079*^9}, {3.841225695242179*^9, 3.841225706976388*^9}, 
   3.841226457157134*^9, {3.841226492274156*^9, 3.8412265077812643`*^9}, {
   3.8412265477068863`*^9, 3.841226550158751*^9}, {3.841227014878249*^9, 
   3.841227023064889*^9}, {3.841227071217061*^9, 3.841227073075672*^9}, {
   3.841244211662068*^9, 3.8412442119213*^9}, {3.8413142430537567`*^9, 
   3.8413142437886553`*^9}, {3.8413143648372383`*^9, 3.841314366942554*^9}, {
   3.8413144157916403`*^9, 3.841314417637042*^9}, {3.841315780719136*^9, 
   3.841315832291005*^9}, {3.841315913712801*^9, 3.841315933790494*^9}, {
   3.8413199490815773`*^9, 3.841319993520858*^9}, {3.8413201263073063`*^9, 
   3.841320163668007*^9}, {3.8417134972304487`*^9, 3.841713497439335*^9}, {
   3.841713888789941*^9, 3.841713896638042*^9}, {3.8417140314410143`*^9, 
   3.841714037351016*^9}, {3.841714100644327*^9, 3.8417141164521933`*^9}, {
   3.8417143125377903`*^9, 3.841714402272057*^9}, {3.84171490059935*^9, 
   3.84171490072684*^9}, {3.8417154919942827`*^9, 3.84171550744444*^9}, {
   3.841715544795384*^9, 3.8417155645661497`*^9}, {3.841715599909068*^9, 
   3.841715627234455*^9}, {3.841715835399899*^9, 3.841715877779121*^9}, {
   3.8417159286490602`*^9, 3.841715986145652*^9}, {3.841716066716773*^9, 
   3.841716114514772*^9}, {3.8417161508073807`*^9, 3.84171618716676*^9}, {
   3.8417162247448187`*^9, 3.841716244154722*^9}, {3.8417163002204437`*^9, 
   3.841716350230461*^9}, {3.841716572466518*^9, 3.8417165731716967`*^9}, {
   3.841717629858612*^9, 3.841717690664359*^9}, {3.841717788497712*^9, 
   3.841717870799992*^9}, {3.841718112720851*^9, 3.8417181896592913`*^9}, {
   3.84171825652215*^9, 3.841718273023109*^9}, {3.841718354837871*^9, 
   3.8417183603266287`*^9}, {3.841718404786539*^9, 3.8417184517515717`*^9}, {
   3.841718552594561*^9, 3.841718552790226*^9}, {3.8417187969266768`*^9, 
   3.841718847164132*^9}, {3.84171903266022*^9, 3.84171912517179*^9}, {
   3.841719172840529*^9, 3.8417192512131567`*^9}, {3.841719403521562*^9, 
   3.8417194714908667`*^9}, {3.841719514675045*^9, 3.841719580434123*^9}, {
   3.841719972807612*^9, 3.841720073329372*^9}, {3.8417201372211933`*^9, 
   3.841720196946352*^9}, {3.8417203085502253`*^9, 3.841720390089863*^9}, {
   3.84172042774545*^9, 3.841720486121964*^9}, {3.841720531066762*^9, 
   3.8417205637646427`*^9}, {3.8417207214148617`*^9, 
   3.8417208177003193`*^9}, {3.841720857613235*^9, 3.8417209227359133`*^9}, {
   3.841720952776205*^9, 3.841721030325513*^9}, {3.841721070543928*^9, 
   3.841721089398485*^9}, {3.8417212336218777`*^9, 3.841721287982724*^9}, {
   3.841721323705147*^9, 3.841721387364614*^9}, {3.84172220109513*^9, 
   3.8417222562055693`*^9}, {3.8417223445141077`*^9, 
   3.8417224358036013`*^9}, {3.841722587182661*^9, 3.841722618425687*^9}, {
   3.841725537936967*^9, 3.841725555229681*^9}, {3.841727342132948*^9, 
   3.84172741413203*^9}, {3.8417274609828997`*^9, 3.84172746760049*^9}, {
   3.8417299126089897`*^9, 3.841729927614616*^9}, {3.841730156429944*^9, 
   3.8417301738951178`*^9}, {3.841730286279234*^9, 3.841730383671503*^9}, 
   3.841730415168652*^9, {3.841740773546256*^9, 3.8417408011719627`*^9}, {
   3.84174091216007*^9, 3.8417409685078983`*^9}, {3.841741016589827*^9, 
   3.841741035120451*^9}, {3.841741086089952*^9, 3.841741087282754*^9}, {
   3.841741263991736*^9, 3.84174133231709*^9}, {3.841741453984887*^9, 
   3.8417414895809717`*^9}, {3.841741526275957*^9, 3.841741536858677*^9}, {
   3.8417416050764313`*^9, 3.841741658655933*^9}, {3.841742066516554*^9, 
   3.841742106289366*^9}, {3.8417426125856867`*^9, 3.841742778006782*^9}, {
   3.8417429838770447`*^9, 3.84174315846845*^9}, {3.841743218596039*^9, 
   3.841743220039431*^9}, {3.841743253553141*^9, 3.8417432708782883`*^9}, {
   3.841743312218287*^9, 3.8417433733942738`*^9}, {3.841824471117358*^9, 
   3.84182447566321*^9}, {3.841824689259522*^9, 3.8418247147902403`*^9}, {
   3.841831876520447*^9, 3.841831957499156*^9}, {3.8418333887864*^9, 
   3.841833390189745*^9}, {3.841838079494752*^9, 3.84183811426434*^9}, {
   3.843028534675502*^9, 3.8430285485215893`*^9}, {3.8430687251138277`*^9, 
   3.8430687935845346`*^9}, {3.8430688387932177`*^9, 
   3.8430688401020803`*^9}, {3.848140396436234*^9, 3.848140396666357*^9}, {
   3.848144672255415*^9, 3.848144699539401*^9}, {3.874399428748866*^9, 
   3.8743994426828537`*^9}, {3.874399476227254*^9, 3.874399508587646*^9}, {
   3.874655122508663*^9, 3.8746553017527018`*^9}, {3.8746553336860247`*^9, 
   3.874655349206846*^9}, {3.874655470715123*^9, 3.874655492358539*^9}, {
   3.874656145627784*^9, 3.8746561526616297`*^9}, {3.874656647619297*^9, 
   3.8746567466052732`*^9}, {3.874659411287506*^9, 3.874659425034416*^9}, {
   3.874662299247755*^9, 3.8746623236945*^9}, {3.874662389727173*^9, 
   3.8746624235872803`*^9}, {3.874677367563856*^9, 3.874677408998179*^9}, {
   3.874681018237763*^9, 3.874681021718507*^9}, {3.874681903958446*^9, 
   3.874681907285522*^9}, {3.881966158082747*^9, 3.8819661666687927`*^9}, {
   3.881966258270214*^9, 3.881966310509264*^9}, {3.881967755635413*^9, 
   3.881967772554647*^9}, {3.881968005278988*^9, 3.8819680064953938`*^9}, {
   3.891601800389771*^9, 3.8916018026081047`*^9}, {3.891601946324497*^9, 
   3.891602069324462*^9}, {3.892035487009186*^9, 3.89203552723212*^9}, {
   3.892035599500806*^9, 3.892035613753233*^9}, {3.892035886304619*^9, 
   3.892035887051674*^9}, {3.892703838816949*^9, 3.892703847217319*^9}, {
   3.895591061858409*^9, 3.8955910674832172`*^9}, {3.895591226248169*^9, 
   3.895591274369281*^9}, {3.895591332289876*^9, 3.8955914720620193`*^9}, {
   3.895591509904118*^9, 3.895591651859481*^9}, 3.8956305941939793`*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"d493ea5b-1198-4fa7-8f89-66bc8b2a689c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elementary guide", "Section",
 CellChangeTimes->{{3.824992947034404*^9, 3.8249929578549128`*^9}, {
   3.824994845005229*^9, 3.824994854888184*^9}, {3.825001526112845*^9, 
   3.825001536400587*^9}, {3.827398634661207*^9, 3.827398653445489*^9}, {
   3.827399806326432*^9, 3.827399807444961*^9}, 3.827818061558731*^9, 
   3.832843949608451*^9, {3.8328440698334007`*^9, 3.832844071129669*^9}, {
   3.8344803507978973`*^9, 3.834480359765109*^9}, {3.840688073664156*^9, 
   3.8406880763786716`*^9}, {3.841227550049139*^9, 3.841227568067491*^9}, {
   3.8412280414521027`*^9, 3.841228043713237*^9}, {3.8412979138943787`*^9, 
   3.841297929269655*^9}, {3.891603712895464*^9, 
   3.891603729711031*^9}},ExpressionUUID->"f9c2da94-9ce1-47f3-aa68-\
cf4e42d9a9d1"],

Cell[CellGroupData[{

Cell["Native gates", "Subsection",
 CellChangeTimes->{{3.895565668363599*^9, 
  3.895565672293972*^9}},ExpressionUUID->"a55ea8a9-cdf3-4b72-a237-\
f73b972a8611"],

Cell[TextData[{
 StyleBox["Direct iIitialisation and measurement are on the NV electron spin \
only\n",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["Init", 
    RowBox[{"0", " "}]], TraditionalForm]],ExpressionUUID->
  "a86d7e46-38cb-4ccb-b69e-bfcd36d6fdd5"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "0"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9d7897b1-4cf9-4bd2-b105-77e02653aefe"],
 "\n",
 StyleBox["\nSingle-qubit gates",
  FontSlant->"Italic"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Rx", "q"], "[", "\[Theta]", "]"}], TraditionalForm]],
  ExpressionUUID->"70c77147-29ed-4eac-b3f3-87133e28585e"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Ry", "q"], "[", "\[Theta]", "]"}], TraditionalForm]],
  ExpressionUUID->"7c821cc3-83a5-4d6f-9795-a1b247d06d93"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Rz", "q"], "[", "\[Theta]", "]"}], TraditionalForm]],
  ExpressionUUID->"a101da62-9b8b-435c-8327-447339736328"],
 " \n\n",
 StyleBox["Two-qubit gates are conditional rotation, where  ",
  FontSlant->"Italic"],
 Cell[BoxData[
  RowBox[{
   RowBox[{"CR\[Sigma]", "[", "\[Theta]", "]"}], ":=", 
   RowBox[{"|", 
    RowBox[{"0", "X0"}], "|", 
    RowBox[{
     RowBox[{"\[CircleTimes]", " ", 
      RowBox[{"R\[Sigma]", "[", "\[Theta]", "]"}]}], "+"}], "|", 
    RowBox[{"1", "X1"}], "|", 
    RowBox[{"\[CircleTimes]", " ", 
     RowBox[{"R\[Sigma]", "[", 
      RowBox[{"-", "\[Theta]"}], "]"}]}]}]}]], "Text",
  CellChangeTimes->{{3.891602397537026*^9, 3.8916025673958282`*^9}, {
   3.8916037575051107`*^9, 3.891603866452456*^9}, {3.8916039773139267`*^9, 
   3.8916040057354193`*^9}, {3.891604114465136*^9, 3.891604149356657*^9}},
  ExpressionUUID->"586f1d21-321b-4afd-8539-1e266e0f3f9f"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["CRx", 
      RowBox[{"0", ",", "q"}]], "[", "\[Theta]", "]"}], ",", " ", 
    RowBox[{
     SubscriptBox["CRy", 
      RowBox[{"0", ",", "q"}]], "[", "\[Theta]", "]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "98b89aff-ba3f-45be-8022-c45258957fc4"],
 "\n\n",
 StyleBox["others: doing nothing\n",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["Wait", "q"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ebfff9c8-d13e-43c6-a554-912eb0f1a4a3"],
 "[duration]"
}], "Text",
 CellChangeTimes->{{3.8692122673836203`*^9, 3.869212288716358*^9}, {
   3.8732900821348667`*^9, 3.8732900892281*^9}, {3.873535234627952*^9, 
   3.8735352993376503`*^9}, 3.8735355903892736`*^9, {3.873535838903427*^9, 
   3.873535867433639*^9}, {3.873535943640603*^9, 3.873536051939383*^9}, {
   3.8737213853909492`*^9, 3.873721409511063*^9}, {3.873721675411847*^9, 
   3.87372167652286*^9}, {3.873721784879632*^9, 3.8737218004244747`*^9}, {
   3.873886462615952*^9, 3.8738864754993267`*^9}, {3.8835477479780693`*^9, 
   3.883547778908753*^9}, 3.883558706803985*^9, 3.883733935859179*^9, {
   3.895561124018421*^9, 3.8955612424709682`*^9}, {3.895561370610491*^9, 
   3.895561375643483*^9}, {3.895565715481627*^9, 3.895565773718214*^9}, {
   3.895566093199087*^9, 3.8955661878383408`*^9}, {3.895566337576305*^9, 
   3.895566360670906*^9}, {3.895566426697022*^9, 3.895566492900166*^9}, {
   3.895568279923072*^9, 3.89556867850518*^9}, {3.895589948940132*^9, 
   3.89558995026468*^9}, {3.895591796717929*^9, 3.895591830639304*^9}, {
   3.895630602088292*^9, 3.89563070232734*^9}, {3.8956307530141363`*^9, 
   3.895630755443778*^9}, {3.895630794827025*^9, 
   3.895630803418139*^9}},ExpressionUUID->"6d381f91-3180-4fd8-b6d2-\
1f19f4e8d0c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Common nuclear spin gates, obtained by sequence of native gates\
\>", "Subsection",
 CellChangeTimes->{{3.841833848186617*^9, 3.8418338541576033`*^9}, {
   3.8418338947024403`*^9, 3.841833934495782*^9}, 3.841834367068637*^9, {
   3.841916429901863*^9, 3.841916432288088*^9}, {3.874677962581897*^9, 
   3.8746779695097923`*^9}, {3.8746780982047977`*^9, 3.874678114843505*^9}, {
   3.878209649557081*^9, 3.878209650308402*^9}, {3.8916044238172083`*^9, 
   3.8916044330867662`*^9}},ExpressionUUID->"0f029284-dc78-499a-b674-\
ed1fb93eef31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cX", "::", "usage"}], "=", 
   "\"\<Controlled-X gate sequence on NV-center\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cY", "::", "usage"}], "=", 
   "\"\<Controlled-Y gate sequence on NV-center\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cZ", "::", "usage"}], "=", 
   "\"\<Controlled-Z gate sequence on NV-center\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initNcl", "::", "usage"}], "=", 
   "\"\<Nuclear spin qubit initialisation sequence on NV-center\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"measZ", "::", "usage"}], "=", 
   "\"\<Nuclear spin qubit measurement sequence on NV-center\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.895643457766077*^9, 3.895643552486805*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"4edc6d41-1978-4eb1-8f85-fa1d7d6099c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cotrolled", "-", 
     RowBox[{"pauli", " ", "gates"}]}], ",", " ", 
    RowBox[{
    "where", " ", "control", " ", "qubits", " ", "are", " ", "the", " ", 
     "electron", " ", "spins"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["cX", 
     RowBox[{"c_", ",", "t_"}]], " ", ":=", " ", 
    RowBox[{"Sequence", " ", "@@", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["CRx", 
         RowBox[{"c", ",", "t"}]], "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "c"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rx", "t"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["cY", 
     RowBox[{"c_", ",", "t_"}]], " ", ":=", " ", 
    RowBox[{"Sequence", " ", "@@", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["CRy", 
         RowBox[{"c", ",", "t"}]], "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "c"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "t"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["cZ", 
     RowBox[{"c_", ",", "t_"}]], " ", ":=", " ", 
    RowBox[{"Sequence", " ", "@@", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["Rx", "t"], "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["CRy", 
         RowBox[{"c", ",", "t"}]], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "c"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "t"], "[", 
        RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rx", "t"], "[", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"initialisation", " ", "the", " ", "nuclear", " ", "spins"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["initNcl", 
     RowBox[{"q_", " ", "/;", " ", 
      RowBox[{"q", ">", "0"}]}]], " ", ":=", 
    RowBox[{"Sequence", " ", "@@", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["Init", "0"], ",", 
       RowBox[{
        SubscriptBox["Ry", "0"], "[", 
        FractionBox["\[Pi]", "2"], "]"}], ",", 
       RowBox[{
        SubscriptBox["CRx", 
         RowBox[{"0", ",", "q"}]], "[", 
        FractionBox["\[Pi]", "2"], "]"}], ",", 
       RowBox[{
        SubscriptBox["Rx", "0"], "[", 
        FractionBox["\[Pi]", "2"], "]"}], ",", 
       RowBox[{
        SubscriptBox["CRy", 
         RowBox[{"0", ",", "q"}]], "[", 
        RowBox[{"-", 
         FractionBox["\[Pi]", "2"]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "measurement", " ", "sequences", " ", "on", " ", "nuclear", " ", "spins", 
     " ", "the", " ", "computational", " ", "basis"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["measZ", 
     RowBox[{"q_", " ", "/;", " ", 
      RowBox[{"q", ">", "0"}]}]], " ", ":=", " ", 
    RowBox[{"Sequence", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["Ry", "0"], "[", 
       FractionBox["\[Pi]", "2"], "]"}], ",", 
      RowBox[{
       SubscriptBox["Rx", "q"], "[", 
       FractionBox["\[Pi]", "2"], "]"}], ",", 
      RowBox[{
       SubscriptBox["CRy", 
        RowBox[{"0", ",", "q"}]], "[", 
       FractionBox[
        RowBox[{"-", "\[Pi]"}], "2"], "]"}], ",", 
      RowBox[{
       SubscriptBox["Rx", "0"], "[", 
       FractionBox["\[Pi]", "2"], "]"}], ",", 
      SubscriptBox["M", "0"]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8419153422634697`*^9, 3.841915357902852*^9}, {
   3.84191542339386*^9, 3.841915515595566*^9}, {3.841915693367324*^9, 
   3.841915723376233*^9}, {3.841915756346937*^9, 3.841915763257987*^9}, {
   3.841915870974616*^9, 3.841915883971613*^9}, {3.8419159482731047`*^9, 
   3.8419159889678917`*^9}, {3.841916174104876*^9, 3.841916247699245*^9}, {
   3.8419164419861183`*^9, 3.841916475796711*^9}, {3.841916511164711*^9, 
   3.841916538214004*^9}, {3.841916589127511*^9, 3.841916636890318*^9}, {
   3.841919048733109*^9, 3.8419190641137953`*^9}, 3.84191917171087*^9, {
   3.8419193136733093`*^9, 3.841919345199169*^9}, {3.841919398743342*^9, 
   3.8419194028147507`*^9}, {3.841919526667601*^9, 3.841919528001244*^9}, {
   3.841919863645975*^9, 3.841919864526177*^9}, {3.841919935991878*^9, 
   3.841919951353654*^9}, {3.84194348212573*^9, 3.841943494114791*^9}, {
   3.841943882753112*^9, 3.841943892408408*^9}, 3.841986309224881*^9, {
   3.841987545061664*^9, 3.841987550686973*^9}, {3.841987697718319*^9, 
   3.841987702906111*^9}, {3.841987741362624*^9, 3.84198774377324*^9}, {
   3.841995494133884*^9, 3.841995501188826*^9}, {3.8420715098187027`*^9, 
   3.842071512827482*^9}, {3.8431057115832767`*^9, 3.843105720976438*^9}, {
   3.8431058401015987`*^9, 3.843105847297166*^9}, {3.843202925583457*^9, 
   3.84320301702879*^9}, {3.843203049608992*^9, 3.843203054190782*^9}, 
   3.8432032340583267`*^9, 3.843203357508584*^9, 3.843206108973524*^9, {
   3.874678005249795*^9, 3.874678088335701*^9}, {3.8782094461891623`*^9, 
   3.878209491152931*^9}, {3.878209562511286*^9, 3.878209586137104*^9}, {
   3.8782098522391157`*^9, 3.87820996021167*^9}, {3.878211738465199*^9, 
   3.878211752362191*^9}, 3.8817944399858932`*^9, {3.8817944722729387`*^9, 
   3.88179447307244*^9}, {3.881863801670169*^9, 3.8818638180155573`*^9}, {
   3.8818640086150703`*^9, 3.881864013482071*^9}, {3.8916043905289307`*^9, 
   3.891604410973668*^9}, 3.8920336203111963`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"74f90a35-14ba-43bf-a85c-3ca851c72025"],

Cell[BoxData[{
 RowBox[{"{", 
  SubscriptBox["initNcl", "1"], "}"}], "\[IndentingNewLine]", 
 RowBox[{"DrawCircuit", "@", "%"}]}], "Input",
 CellChangeTimes->{{3.874682860813259*^9, 3.874682876846472*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"1daf9959-3b3b-4a22-844b-b9a5ee846594"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example: 6 Qubits initialization", "Subsection",
 CellChangeTimes->{{3.8417357644414797`*^9, 3.841735779473033*^9}, 
   3.8417393383781424`*^9, {3.841824518359138*^9, 3.841824518720909*^9}, {
   3.841833780785274*^9, 3.841833783266164*^9}, {3.895630819875285*^9, 
   3.8956308214267473`*^9}},ExpressionUUID->"99fb8a63-f5b0-49ca-ab0c-\
daec83922ac8"],

Cell["Initialize all qubits to zero", "Text",
 CellChangeTimes->{{3.841832374587064*^9, 3.841832381245659*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"80339c59-8cb5-4578-b983-326a6f9eebde"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"circInit", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["initNcl", "1"], ",", 
     SubscriptBox["initNcl", "2"], ",", 
     SubscriptBox["initNcl", "3"], ",", 
     SubscriptBox["initNcl", "4"], ",", 
     SubscriptBox["initNcl", "5"], ",", 
     SubscriptBox["Init", "0"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DrawCircuit", "[", "circInit", "]"}]}], "Input",
 CellChangeTimes->{{3.841736056357298*^9, 3.841736091913299*^9}, {
   3.841736178861768*^9, 3.841736194215075*^9}, {3.8417362288400097`*^9, 
   3.8417362361821012`*^9}, {3.841736285725009*^9, 3.8417363631744213`*^9}, {
   3.841736704034359*^9, 3.841736705811036*^9}, 3.8417367802746773`*^9, {
   3.84173700524722*^9, 3.841737061801715*^9}, 3.841737159705689*^9, {
   3.841737445123435*^9, 3.8417375064115553`*^9}, {3.841825088872699*^9, 
   3.841825112514271*^9}, {3.841828072213922*^9, 3.84182809346233*^9}, {
   3.8418286229413357`*^9, 3.841828623873723*^9}, {3.841828852897341*^9, 
   3.841828860977015*^9}, {3.841828987422028*^9, 3.841828994784791*^9}, {
   3.841832667703281*^9, 3.841832756768404*^9}, {3.841833033546341*^9, 
   3.841833036364504*^9}, {3.841937633669704*^9, 3.841937635299514*^9}, {
   3.841942270588703*^9, 3.841942272599867*^9}, 3.843105728060364*^9, {
   3.8431058123580503`*^9, 3.84310586013126*^9}, {3.874678186689993*^9, 
   3.874678230787678*^9}, {3.8818640232780027`*^9, 3.8818640268354053`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"034244f5-d113-48b8-8b75-3d3d8d845b98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"CreateDensityQureg", "[", "6", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]2", "=", 
   RowBox[{"CreateDensityQureg", "[", "6", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{"CreateQureg", "[", "6", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841292707334429*^9, 3.841292735144569*^9}, {
  3.841736425672248*^9, 3.8417364278827877`*^9}, {3.841832985008233*^9, 
  3.841832985693132*^9}, {3.8746818177871943`*^9, 3.874681860031645*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"de4d1ece-395f-4d60-91da-39f505b3dc04"],

Cell[TextData[{
 "First, create a random mix state. Notice that the fidelity is far from ",
 Cell[BoxData[
  TemplateBox[{"000000"},
   "Ket"]],ExpressionUUID->"27fc65f6-4d95-4331-88f2-6e8ccf14e8bf"],
 " "
}], "Text",
 CellChangeTimes->{{3.891604176399541*^9, 3.891604199129826*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"47651f31-09a9-4ad9-a719-d288934d1e61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetQuregMatrix", "[", 
   RowBox[{"\[Rho]", ",", " ", 
    RowBox[{"RandomMixState", "[", "6", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CalcFidelity", "[", 
  RowBox[{"\[Rho]", ",", " ", 
   RowBox[{"InitZeroState", " ", "@", " ", "\[Psi]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8412911920598373`*^9, 3.84129119543442*^9}, {
  3.8412912344422073`*^9, 3.8412912521117887`*^9}, {3.841292699067937*^9, 
  3.841292704893355*^9}, {3.84173642981887*^9, 3.841736430774087*^9}, {
  3.8418252981538687`*^9, 3.841825313469874*^9}, {3.841832987823262*^9, 
  3.8418329889908323`*^9}, {3.841834942779179*^9, 3.841834943225712*^9}, {
  3.841834993936343*^9, 3.841834996810987*^9}, {3.878815269831641*^9, 
  3.878815273778174*^9}, {3.891604247926609*^9, 3.8916042502297153`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"137dc8f3-4385-4f9f-b4cf-fd1dd13b89ec"],

Cell["\<\
Initialization on the noisy circuit. Serialize[circ] removes parallelism in \
the circuit.
In practice, the operators are done in serial manner while \
dynamical-decoupling sequences are applied to passive qubits (qubits that are \
not operated upon)\
\>", "Text",
 CellChangeTimes->{{3.841832338452476*^9, 3.841832341555002*^9}, {
  3.841833122251227*^9, 3.841833127636816*^9}, {3.841835161706152*^9, 
  3.841835177362451*^9}, {3.89563084496621*^9, 3.895630894609828*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"76e91cef-02b2-43a6-93f8-be75a1996a42"],

Cell[BoxData[
 RowBox[{"DrawCircuit", "@", 
  RowBox[{"Serialize", "@", "circInit"}]}]], "Input",
 CellChangeTimes->{{3.848142548200131*^9, 3.848142557705958*^9}, {
  3.8746806134801064`*^9, 3.8746806242543783`*^9}, {3.874681132020509*^9, 
  3.8746811481957703`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"f6e6e06a-9aa3-4ca1-995a-555d882daa69"],

Cell[BoxData["circInit"], "Input",
 CellChangeTimes->{{3.895643574271915*^9, 3.895643575246125*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"90e25ae4-1c4c-4e7d-8187-65e2dee5a0ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
   "noisy", " ", "initialisation", " ", "circuit", " ", "on", " ", "the", " ",
     "specified", " ", "device"}], " ", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"circInitOnDev", "=", 
     RowBox[{"InsertCircuitNoise", "[", 
      RowBox[{
       RowBox[{"Serialize", " ", "@", " ", "circInit"}], ",", " ", 
       RowBox[{"NVCenterDelft", "[", "]"}], ",", " ", 
       RowBox[{"ReplaceAliases", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DrawCircuit", "[", 
    RowBox[{"%", ",", "6"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.841737853734214*^9, 3.8417378641084146`*^9}, {
   3.841745912009655*^9, 3.841745917696714*^9}, 3.8418339936923437`*^9, {
   3.841834586139723*^9, 3.841834590235015*^9}, {3.841834867904627*^9, 
   3.841834869691821*^9}, 3.841834914150189*^9, {3.841834951922617*^9, 
   3.8418349652905684`*^9}, {3.874681155273292*^9, 3.874681183713562*^9}, {
   3.8746812961003447`*^9, 3.874681320616397*^9}, 3.874681355716338*^9, 
   3.874681486395637*^9, 3.874681666682558*^9, {3.8746817858106327`*^9, 
   3.8746817899074583`*^9}, {3.891604276402774*^9, 3.8916043083602057`*^9}, {
   3.895643777137134*^9, 3.895643792405364*^9}, {3.895644448957979*^9, 
   3.895644461279167*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"0f5aab87-782f-4658-b73a-288f32a5a38b"],

Cell[TextData[{
 "The fidelity is now so closer to the state ",
 Cell[BoxData[
  TemplateBox[{"000000"},
   "Ket"]],ExpressionUUID->"76f64d4a-fd55-418c-aca5-ef31f232e6cc"],
 "\t\t\t\t"
}], "Text",
 CellChangeTimes->{{3.891604328605812*^9, 3.8916043807641783`*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"e922fe7f-a105-4e2b-be45-3000625dc717"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ApplyCircuit", "[", 
   RowBox[{
    RowBox[{"CloneQureg", "[", 
     RowBox[{"\[Rho]2", ",", "\[Rho]"}], "]"}], ",", 
    RowBox[{"ExtractCircuit", " ", "@", " ", "circInitOnDev"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CalcFidelity", "[", 
  RowBox[{"\[Rho]2", ",", " ", 
   RowBox[{"InitZeroState", " ", "@", " ", "\[Psi]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.841736476492292*^9, 3.8417364947521467`*^9}, {
  3.841737081975494*^9, 3.841737085328239*^9}, {3.841737696003623*^9, 
  3.841737738504027*^9}, {3.8417378710207663`*^9, 3.8417378745168037`*^9}, {
  3.841833228754518*^9, 3.8418332378269987`*^9}, {3.841833341123418*^9, 
  3.841833349520549*^9}, {3.841833412911174*^9, 3.841833425956092*^9}, {
  3.841835399562985*^9, 3.84183541985678*^9}, {3.891604313995483*^9, 
  3.891604322889441*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"21c3b677-4ced-444e-a378-2df9857ebe75"],

Cell[BoxData[
 RowBox[{"DestroyAllQuregs", "[", "]"}]], "Input",
 CellChangeTimes->{{3.841836037857119*^9, 3.841836039210066*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7b86f670-e9fd-406c-821c-f40ad88ae016"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Measurements", "Subsection",
 CellChangeTimes->{{3.8432007534489393`*^9, 3.843200777926093*^9}, {
  3.843200919305202*^9, 
  3.843200920175497*^9}},ExpressionUUID->"6f030ecf-2a7c-420b-85c6-\
960c1f28fdbb"],

Cell["\<\
Measurements in the computational basis. Compare 4k shots of measurement to \
the fidelity set in the device \
\>", "Text",
 CellChangeTimes->{{3.8432008327376547`*^9, 3.843200861580064*^9}, 
   3.843200902151182*^9, {3.84320095549675*^9, 3.843200956112369*^9}, {
   3.87468231361709*^9, 3.8746823381446257`*^9}, {3.874682447699195*^9, 
   3.874682454955854*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"3a11bdfe-a70f-424f-b72d-02f2513e601b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nshots", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Rho]", ",", "\[Rho]init"}], "}"}], "=", 
   RowBox[{"CreateDensityQuregs", "[", 
    RowBox[{"6", ",", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.843201022712121*^9, 3.84320102647477*^9}, {
   3.843201116686852*^9, 3.843201123683989*^9}, {3.843201678233671*^9, 
   3.843201678502223*^9}, {3.8432017745658503`*^9, 3.843201775052952*^9}, {
   3.84320618851932*^9, 3.8432061886885977`*^9}, {3.8746838286962843`*^9, 
   3.874683829432122*^9}, 3.875693135763729*^9, 3.8756932112998543`*^9, {
   3.8782115484085417`*^9, 3.878211558527831*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"537fea4e-864a-439b-9d93-e0a29e7114ed"],

Cell[CellGroupData[{

Cell["On the electron spin", "Subsubsection",
 CellChangeTimes->{{3.843202521789654*^9, 
  3.84320252540728*^9}},ExpressionUUID->"84042dea-1ebb-47fc-8c79-\
688d2799c3be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outputs", "=", "\[IndentingNewLine]", 
   RowBox[{"Flatten", " ", "@", " ", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ApplyCircuit", "[", 
       RowBox[{
        RowBox[{"InitZeroState", " ", "@", " ", "\[Rho]"}], ",", 
        RowBox[{"ExtractCircuit", " ", "@", " ", 
         RowBox[{"InsertCircuitNoise", "[", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["M", "0"], "}"}], ",", 
           RowBox[{"NVCenterDelft", "[", "]"}], ",", 
           RowBox[{"ReplaceAliases", "\[Rule]", "True"}]}], "]"}]}]}], "]"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"{", "nshots", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"\"\<correct outputs(0):\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"nshots", " ", "-", " ", 
       RowBox[{"Total", " ", "@", " ", "outputs"}]}], "]"}]}], ",", "  ", 
    RowBox[{"\"\<\\nflipped outputs(1):\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"Total", " ", "@", " ", "outputs"}], "]"}]}], ",", 
    RowBox[{"\"\<\\nfidelity:\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", 
       RowBox[{"1", " ", "-", " ", 
        RowBox[{
         RowBox[{"Total", " ", "@", " ", "outputs"}], "/", "nshots"}]}], 
       "]"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.843200868689666*^9, 3.843200884139989*^9}, {
  3.843200938732965*^9, 3.843201016809793*^9}, {3.84320110686677*^9, 
  3.843201110147065*^9}, {3.8432014825148087`*^9, 3.843201665011902*^9}, {
  3.843201796383807*^9, 3.843201796957211*^9}, {3.874682228539795*^9, 
  3.874682231596401*^9}, {3.875693183195565*^9, 3.875693186525873*^9}, {
  3.89160445551367*^9, 3.891604513917549*^9}, {3.89160472314149*^9, 
  3.891604750975469*^9}, {3.89564550294487*^9, 3.89564550406723*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"219d489f-c644-4265-800a-bd65fbaf92c7"],

Cell["Compare it to the targeted fidelity of measurement", "Text",
 CellChangeTimes->{{3.891604527823925*^9, 3.8916045410639*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"7b092f1f-b910-481d-8b57-f4038c612cd6"],

Cell[BoxData[
 RowBox[{"OptionValue", "[", 
  RowBox[{"NVCenterDelft", ",", "FidMeas"}], "]"}]], "Input",
 CellChangeTimes->{{3.874682273328298*^9, 3.8746823048407516`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"c7ce6366-f3d1-42cd-8563-3411325c8409"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Measurement on the nuclear spins", "Subsubsection",
 CellChangeTimes->{{3.843202521789654*^9, 3.84320252540728*^9}, {
   3.8432025640805883`*^9, 3.8432025773249187`*^9}, {3.8746822515376453`*^9, 
   3.8746822576980963`*^9}, {3.878211626085024*^9, 3.8782116307437763`*^9}, 
   3.878211763830585*^9},ExpressionUUID->"9ff4bebe-4c63-4be3-8a9c-\
848e0d1985d5"],

Cell[BoxData[
 RowBox[{"DrawCircuit", "[", 
  RowBox[{"{", 
   SubscriptBox["measZ", "1"], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.843206510878325*^9, 3.8432065174760303`*^9}, {
  3.8746835085652103`*^9, 3.874683511778243*^9}, {3.878210011489442*^9, 
  3.8782100127251596`*^9}, {3.8782114062734528`*^9, 3.878211519430134*^9}, {
  3.878211728672724*^9, 3.8782117288384943`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"c0def0b3-f28d-41da-9098-ff1821ca5264"],

Cell["\<\
Should be worse than direct measurement on the electron spin, because it is \
an indirect measurement\
\>", "Text",
 CellChangeTimes->{{3.891604527823925*^9, 3.8916045410639*^9}, {
  3.891604588953293*^9, 3.891604610261375*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"82a3418c-54ae-46b8-8a22-24faaa7520e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dev", "=", 
   RowBox[{"NVCenterDelft", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.881796490696383*^9, 3.881796493541593*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"c1d0ccf5-54ba-45fe-9d09-813db9315a95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nshots", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputs", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ApplyCircuit", "[", 
       RowBox[{
        RowBox[{"InitZeroState", "@", "\[Rho]"}], ",", 
        RowBox[{"ExtractCircuit", "@", 
         RowBox[{"InsertCircuitNoise", "[", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["measZ", "1"], "}"}], ",", 
           RowBox[{"NVCenterDelft", "[", "]"}], ",", 
           RowBox[{"ReplaceAliases", "\[Rule]", "True"}]}], "]"}]}]}], "]"}], 
      ",", 
      RowBox[{"{", "nshots", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   RowBox[{"\"\<correct outputs(0):\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"nshots", "-", 
      RowBox[{"Total", "@", "outputs"}]}], "]"}]}], ",", " ", 
   RowBox[{"\"\<\\nflipped outputs(1):\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"Total", "@", "outputs"}], "]"}]}], ",", 
   RowBox[{"\"\<\\nfidelity:\>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"N", "[", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"Total", "[", "outputs", "]"}], "/", "nshots"}]}], "]"}], 
     "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.843200868689666*^9, 3.843200884139989*^9}, {
   3.843200938732965*^9, 3.843201016809793*^9}, {3.84320110686677*^9, 
   3.843201110147065*^9}, {3.8432014825148087`*^9, 3.843201665011902*^9}, {
   3.843201796383807*^9, 3.843201796957211*^9}, {3.843203069932969*^9, 
   3.843203071439384*^9}, {3.843204933598679*^9, 3.8432049876006927`*^9}, {
   3.843205051064747*^9, 3.843205051407584*^9}, {3.84320514038212*^9, 
   3.843205143930727*^9}, {3.843206140688816*^9, 3.8432061435122347`*^9}, {
   3.874682352150229*^9, 3.874682353262394*^9}, {3.874683552155805*^9, 
   3.874683554202652*^9}, {3.874683786142315*^9, 3.874683787550263*^9}, {
   3.874683825235693*^9, 3.8746838258658457`*^9}, {3.878210024246169*^9, 
   3.8782100249325943`*^9}, {3.8782105794983997`*^9, 3.87821058623193*^9}, {
   3.878211161797061*^9, 3.878211165328698*^9}, {3.878211320807119*^9, 
   3.878211321472663*^9}, {3.878211562924663*^9, 3.8782115735108147`*^9}, 
   3.8817945154802303`*^9, {3.881796437673169*^9, 3.881796502529467*^9}, {
   3.88186377194*^9, 3.8818637874680767`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"a6d3148a-e28f-4040-8e5b-6dd569bc2579"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Paper supplement: BCS dynamic simulation  ", "Section",
 CellChangeTimes->{{3.891604657051633*^9, 
  3.891604669905468*^9}},ExpressionUUID->"6d581b08-10ac-4127-8949-\
6fa35e833b10"],

Cell[CellGroupData[{

Cell["Trotterization", "Subsection",
 CellChangeTimes->{{3.8520232287538643`*^9, 3.852023240485355*^9}, {
  3.8520286105443783`*^9, 3.852028612558879*^9}, {3.852347979177206*^9, 
  3.852347990407613*^9}, {3.857003783339116*^9, 3.857003785806119*^9}, {
  3.892033643061001*^9, 3.892033677589005*^9}, {3.892033715257798*^9, 
  3.892033722158358*^9}, {3.8920363206345882`*^9, 
  3.892036321213336*^9}},ExpressionUUID->"bcfb6449-c9b4-4375-a84b-\
f952066d9c67"],

Cell[TextData[{
 "It requires around one thousand gates -- before conversion to the native \
NV-gates. See ",
 StyleBox["supplement/BCSonVNCenterDelft/BCSDynamicsTrotter.nb",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.892036322945623*^9, 3.892036365612494*^9}, {
  3.895631025657721*^9, 3.895631069320607*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"b95b8a84-d2c7-4c28-a4a8-1c595c095164"]
}, Open  ]],

Cell[CellGroupData[{

Cell["BCS simulation", "Subsection",
 CellChangeTimes->{{3.841746203317483*^9, 3.841746207346401*^9}, {
  3.8418336085676823`*^9, 3.841833611301277*^9}, {3.84183365618616*^9, 
  3.841833656574897*^9}, {3.8418357390019913`*^9, 3.841835741001678*^9}, {
  3.841837361280662*^9, 3.841837372397109*^9}, {3.841837928028625*^9, 
  3.841837929972949*^9}, {3.874683949581272*^9, 3.874683950496847*^9}, {
  3.8782879649154377`*^9, 
  3.878287968467505*^9}},ExpressionUUID->"b5d08dee-f526-4bf5-ad7b-\
d8fcff0b3307"],

Cell[CellGroupData[{

Cell["Setting up the Hamiltonian", "Subsubsection",
 CellChangeTimes->{{3.892033741861754*^9, 3.8920337469748917`*^9}, {
  3.8956455413177843`*^9, 
  3.895645541956794*^9}},ExpressionUUID->"aec702d0-7f8a-41d3-aff8-\
e9cc90822322"],

Cell["Set the constants for the Hamiltonian", "Text",
 CellChangeTimes->{{3.892033835135723*^9, 3.89203384432664*^9}, {
  3.892034249355816*^9, 3.892034252361052*^9}, {3.895645538632894*^9, 
  3.895645539242468*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"6159fd4c-f781-45ed-9d2e-757eef8bd607"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"non", "-", 
    RowBox[{"iteracting", " ", "harmonic", " ", "oscillator"}], "-", 
    RowBox[{"type", " ", "energy", " ", "levels"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Epsilon]", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", 
        RowBox[{"(", 
         RowBox[{"#", "+", "0.5"}], ")"}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "4"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"time", "-", 
     RowBox[{"dependent", " ", "coupling", " ", "function"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coupling", "[", 
     RowBox[{"t_", ",", "g0_", ",", "gc_"}], "]"}], ":=", 
    RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t", "-", "t1"}], ")"}], 
           RowBox[{"J", "/", 
            RowBox[{"(", 
             RowBox[{"\[HBar]", " ", "\[CapitalGamma]"}], ")"}]}]}], "]"}], 
         "+", 
         RowBox[{"\[Pi]", "/", "2"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t2", "-", "t"}], ")"}], 
           RowBox[{"J", "/", 
            RowBox[{"(", 
             RowBox[{"\[HBar]", " ", "\[CapitalGamma]"}], ")"}]}]}], "]"}], 
         "+", 
         RowBox[{"\[Pi]", "/", "2"}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"gc", "-", "g0"}], ")"}], "/", 
        SuperscriptBox["\[Pi]", "2"]}]}], "+", "g0"}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.878287986999201*^9, 3.878287991143291*^9}, {
   3.8782887253275957`*^9, 3.8782887441663523`*^9}, {3.878288804017159*^9, 
   3.878288958392704*^9}, 3.878289100431686*^9, {3.878289151191736*^9, 
   3.878289160783039*^9}, {3.87828920773106*^9, 3.8782892112694807`*^9}, {
   3.878290379267542*^9, 3.878290383301724*^9}, {3.878299293162649*^9, 
   3.878299304550866*^9}, {3.878300160493469*^9, 3.878300170799027*^9}, {
   3.878646480329439*^9, 3.878646507568781*^9}, {3.878721850779255*^9, 
   3.8787218857170267`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"6a7a3d1f-e2cd-4396-b094-4802f0fbcbe1"],

Cell[BoxData[
 RowBox[{"constants", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"time", " ", "start", " ", "to", " ", "quench", " ", "and", " ", 
     RowBox[{"reverse", ".", " ", "J"}], " ", "is", " ", "an", " ", 
     "arbitrary", " ", "energy", " ", "unit"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", "->", 
     RowBox[{"9", " ", 
      RowBox[{"\[HBar]", "/", "J"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"t2", "->", 
     RowBox[{"18", " ", 
      RowBox[{"\[HBar]", "/", "J"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"initial", " ", "coupling", " ", "constant"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"\[CapitalGamma]", "->", "0.1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", "frequency", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Omega]", "->", 
     RowBox[{"5", 
      RowBox[{"J", "/", "3"}]}]}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.878288961549892*^9, 3.8782890769498167`*^9}, {
  3.878289125434126*^9, 3.878289140269389*^9}, {3.8782891886024017`*^9, 
  3.878289192440847*^9}, {3.8782892263215027`*^9, 3.878289250177916*^9}, {
  3.878290397518237*^9, 3.878290403543269*^9}, {3.878299265121233*^9, 
  3.878299265503162*^9}, {3.8782995523174667`*^9, 3.878299578437085*^9}, {
  3.8782996801661987`*^9, 3.878299681200865*^9}, {3.878373832503097*^9, 
  3.878373838217227*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"bde2edab-ffbe-449b-a477-b6aaa2c5dccf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"mean", "-", 
    RowBox[{"field", " ", "eigenvalues"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ej", "[", 
     RowBox[{"\[Epsilon]_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], "+", 
      SuperscriptBox[
       RowBox[{"Abs", "[", "\[CapitalDelta]", "]"}], "2"]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"superconducting", " ", "gap"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     FractionBox["2", "g"], "=", 
     RowBox[{
      UnderscriptBox["\[Sum]", "k"], 
      RowBox[{
       FractionBox["1", 
        SubscriptBox["E", "k"]], 
       RowBox[{"tanh", "[", 
        FractionBox[
         SubscriptBox["E", "k"], 
         RowBox[{"2", 
          SubscriptBox["k", "b"], "Temp"}]], "]"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "since", " ", "we", " ", "consider", " ", "temperature", " ", "Temp"}], 
      "=", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"tanh", 
       RowBox[{"(", "\[Infinity]", ")"}]}], "=", "1"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Superconducting", " ", "gaps"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]0", "=", "J"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]c", "=", 
     RowBox[{"2", "J"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.878293421882765*^9, 3.878293462229877*^9}, {
  3.878293544361319*^9, 3.8782936738741817`*^9}, {3.878293723765422*^9, 
  3.878293734357229*^9}, {3.878299190591432*^9, 3.8782992028766537`*^9}, {
  3.878299312969419*^9, 3.878299314702883*^9}, {3.8786468059564333`*^9, 
  3.8786468130053797`*^9}, {3.878646886510315*^9, 3.878646887433296*^9}, {
  3.878647330766898*^9, 3.878647336465802*^9}, {3.878721564443808*^9, 
  3.878721567428643*^9}, {3.8787216204220343`*^9, 3.87872162195288*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"ae175ae7-a9dd-44e0-8f90-14922f092593"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g0", "=", 
   RowBox[{"2", " ", "/", 
    RowBox[{"Total", "[", 
     FractionBox["1", 
      RowBox[{"Ej", "[", 
       RowBox[{"\[Epsilon]", ",", "\[CapitalDelta]0"}], "]"}]], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gc", "=", 
   RowBox[{"2", "/", " ", 
    RowBox[{"Total", "[", 
     FractionBox["1", 
      RowBox[{"Ej", "[", 
       RowBox[{"\[Epsilon]", ",", "\[CapitalDelta]c"}], "]"}]], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.878299145310164*^9, 3.87829917698697*^9}, {
   3.878299218301976*^9, 3.878299249707189*^9}, {3.8782994473260603`*^9, 
   3.878299474930129*^9}, {3.878299964160029*^9, 3.878299965205612*^9}, {
   3.878300030583703*^9, 3.878300058401067*^9}, {3.878300541220664*^9, 
   3.8783005433092422`*^9}, {3.8787205906621513`*^9, 3.878720593199745*^9}, {
   3.8787207684861517`*^9, 3.878720776773673*^9}, {3.8787208393445587`*^9, 
   3.878720871958444*^9}, 3.8787215521046343`*^9, {3.878721623914716*^9, 
   3.878721624530328*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"9f1f9fae-f930-4a69-b8a8-0e6af1a3fda0"],

Cell["The entire Hamiltonain", "Text",
 CellChangeTimes->{{3.8920338298068333`*^9, 3.8920338574716597`*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"78d6d3e1-cb27-4b3d-879c-6695f02e867a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Gaudin", " ", "term"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Hgaudin", "[", 
    RowBox[{"q_", ",", "n_", ",", "\[Epsilon]_", ",", "g_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Total", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", "q"], ",", 
           SubscriptBox["Y", "q"], ",", 
           SubscriptBox["Z", "q"]}], "}"}], ".", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", "j"], ",", 
           SubscriptBox["Y", "j"], ",", 
           SubscriptBox["Z", "j"]}], "}"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"q", "+", "1"}], "]"}], "]"}], "-", 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ")"}]}]], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}], ",", 
           RowBox[{"{", "q", "}"}]}], "]"}]}], "}"}]}], "]"}]}], "+", 
    FractionBox[
     SubscriptBox["Z", "q"], "g"]}]}]}]], "Input",
 CellChangeTimes->{{3.878388263675469*^9, 3.8783884165868673`*^9}, {
  3.878723001901499*^9, 3.878723010073791*^9}, {3.878723316816169*^9, 
  3.878723383638908*^9}, {3.878723693563384*^9, 3.878723722754937*^9}, {
  3.8788358785999002`*^9, 3.878835910706489*^9}, {3.878836159290352*^9, 
  3.878836161627089*^9}, {3.892033969276847*^9, 3.892033975272374*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"53cf8897-1751-47c7-a749-382ea0409b76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   SubscriptBox["H", "BCS"], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HBCS", "[", 
    RowBox[{"n_", ",", "\[Epsilon]_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", "=", 
       RowBox[{
        RowBox[{"coupling", "[", 
         RowBox[{
          RowBox[{"\[Tau]", "*", 
           RowBox[{"\[HBar]", "/", "\[CapitalDelta]0"}]}], ",", "g0", ",", 
          "gc"}], "]"}], "/.", "constants"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"SimplifyPaulis", "@", 
      RowBox[{"Chop", "@", 
       RowBox[{"ExpandAll", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "g"}], " ", 
                   RowBox[{"\[Epsilon]", "[", 
                    RowBox[{"[", 
                    RowBox[{"q", "+", "1"}], "]"}], "]"}]}], "+", 
                  FractionBox[
                   SuperscriptBox["g", "2"], "2"]}], ")"}], 
                FractionBox[
                 RowBox[{"Hgaudin", "[", 
                  RowBox[{"q", ",", "n", ",", "\[Epsilon]", ",", "g"}], "]"}],
                  "\[CapitalDelta]0"]}], "/.", "constants"}], ",", 
              RowBox[{"J", ">", "0"}]}], "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"q", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"SimplifyPaulis", "@", 
          RowBox[{"Chop", "@", 
           RowBox[{"ExpandAll", "[", 
            RowBox[{"SimplifyPaulis", "@", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 FractionBox[
                  SuperscriptBox["g", "3"], 
                  RowBox[{"4", "\[CapitalDelta]0"}]], "*", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"Total", "@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Hgaudin", "[", 
                    RowBox[{"q", ",", "n", ",", "\[Epsilon]", ",", "g"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"q", ",", "0", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], 
                  "2"]}], "/.", "constants"}], ",", 
               RowBox[{"J", ">", "0"}]}], "]"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.87922950267177*^9, 3.879229564194743*^9}, {
   3.8792299933372993`*^9, 3.8792304265383587`*^9}, {3.8792304863246803`*^9, 
   3.879230697355687*^9}, 3.879231053102865*^9, {3.8792313391708937`*^9, 
   3.879231364634429*^9}, {3.879231395473311*^9, 3.8792314402910633`*^9}, {
   3.879242203014793*^9, 3.879242220085353*^9}, {3.879242356855844*^9, 
   3.879242573936233*^9}, {3.8792709103210087`*^9, 3.879270910463718*^9}, {
   3.880909360816394*^9, 3.8809093625242*^9}, {3.892033961765192*^9, 
   3.8920339669310493`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"391d971f-f101-4325-a834-40ef67bd8ed1"],

Cell["Set up the time discretisation and the quench g(\[Tau])", "Text",
 CellChangeTimes->{{3.892034613710458*^9, 3.892034626715632*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"5fc611c4-999c-4adc-a898-3282c86c635c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Medium", " ", "resolution"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"\[Tau]s", "=", 
    RowBox[{"Sort", "@", 
     RowBox[{"DeleteDuplicates", "@", 
      RowBox[{"Chop", "@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "4.", ",", "8."}], "}"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{"8.", ",", "20.", ",", "0.2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"20.", ",", "23.5", ",", "27"}], "}"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", "timesteps"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]\[Tau]", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Tau]s", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"\[Tau]s", "[", 
         RowBox[{"[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "\[Tau]s"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrependTo", "[", 
     RowBox[{"\[Delta]\[Tau]", ",", "0"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"sanity", " ", "check"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"And", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Tau]s", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "==", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Delta]\[Tau]", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", "i", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "\[Tau]s"}]}], "}"}]}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{"\[Tau]", "=", 
     RowBox[{"t", " ", 
      RowBox[{"J", "/", "\[HBar]"}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8798631867125*^9, 3.879863196805717*^9}, {
   3.879863793600444*^9, 3.879863806218521*^9}, {3.879863910056219*^9, 
   3.8798639165617437`*^9}, {3.8798639831539*^9, 3.879863986253419*^9}, {
   3.879864023814981*^9, 3.879864024819536*^9}, {3.8798640567181*^9, 
   3.879864069519493*^9}, {3.8798642228406887`*^9, 3.879864260905492*^9}, {
   3.879882177066049*^9, 3.879882200748611*^9}, {3.879952781857626*^9, 
   3.8799527968901854`*^9}, {3.8799533350035152`*^9, 3.87995334376081*^9}, {
   3.880112214638424*^9, 3.880112218498686*^9}, 3.880536473680361*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"ce78c7d0-8839-4f80-b171-42431e68935e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[Tau]", "=", 
   RowBox[{"t", " ", 
    RowBox[{"J", "/", "\[HBar]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.87828927616803*^9, 3.8782892861786633`*^9}, {
   3.878290364801785*^9, 3.878290370572208*^9}, 3.878290568873632*^9, 
   3.878290627083*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"e886c606-0b0c-45f6-915e-9a75ab68776d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"dense", " ", "quench", " ", "for", " ", "reference"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"gdense", 
    RowBox[{"<<", "\"\<supplement/BCSonNVCenterDelft/gdense.mx\>\""}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.881732901281554*^9, 3.881732911366501*^9}, 
   3.881969004101616*^9, {3.892034489028029*^9, 3.892034495750462*^9}, {
   3.892034530190427*^9, 3.892034537170162*^9}, {3.8920345724181137`*^9, 
   3.892034572599053*^9}, {3.892034716187008*^9, 3.8920347300703907`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"d96f4a3b-351c-4ed1-a545-8d8c0bb07f80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "See", " ", "the", " ", "quench", " ", "almost", " ", "overlap", " ", 
    "with", " ", "the", " ", "discretised", " ", "one"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gvals", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coupling", "[", 
             RowBox[{
              RowBox[{"#", "*", 
               RowBox[{"\[HBar]", "/", "\[CapitalDelta]0"}]}], ",", "g0", ",",
               "gc"}], "]"}], "/", "\[CapitalDelta]0"}], "&"}], "/@", 
          "\[Tau]s"}], ")"}], "//.", "constants"}], ",", 
       RowBox[{"J", ">", "0"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"\[Tau]s", ",", "gvals"}], "}"}]}], ",", "gdense"}], "}"}], 
     ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{"1.16", ",", "1.56"}], "}"}]}], ",", 
     RowBox[{"Joined", "->", "True"}], ",", 
     RowBox[{"AspectRatio", "->", "0.3"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "1.55", ",", "0.05"}], "]"}], ",", "None"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "27", ",", "1"}], "]"}], ",", "None"}], "}"}]}], 
       "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.878637668292924*^9, 3.8786376800363483`*^9}, {
   3.878646540075543*^9, 3.878646541247448*^9}, {3.878720978437278*^9, 
   3.87872098446387*^9}, {3.878721057578096*^9, 3.878721064177147*^9}, {
   3.878721109402334*^9, 3.878721116483931*^9}, 3.878721671972493*^9, 
   3.878726325029861*^9, {3.8787263713620043`*^9, 3.878726401651847*^9}, {
   3.878726500900569*^9, 3.878726526787057*^9}, {3.878726767278472*^9, 
   3.8787267993532667`*^9}, {3.878728653945978*^9, 3.8787286612857847`*^9}, {
   3.878728797449539*^9, 3.878728802908045*^9}, {3.8788188408219423`*^9, 
   3.8788188409516077`*^9}, {3.878819531841399*^9, 3.878819531973462*^9}, 
   3.879252174336501*^9, {3.8798822170592203`*^9, 3.87988221754883*^9}, {
   3.89203466349198*^9, 3.892034699391843*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"76f23e1e-4327-4cab-8158-2604f220f4c7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulations on various noise scenarios", "Subsection",
 CellChangeTimes->{{3.881621522146928*^9, 
  3.8816215453551903`*^9}},ExpressionUUID->"09da23ba-ab76-4ff4-bc77-\
34a492b2e2db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"summarycss2", 
   RowBox[{"<<", "\"\<supplement/BCSonNVCenterDelft/summarycss2.mx\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.892186894852766*^9, 3.892186903727378*^9}, {
   3.892186946571415*^9, 3.89218696662617*^9}, 3.8921871156376467`*^9},
 CellLabel->"In[60]:=",ExpressionUUID->"9f408cb2-adee-4811-b0bd-ef4472446759"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CustomGatesDefinitions", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["SW", 
         RowBox[{"index1_", ",", "index2_"}]], "[", "\[Theta]_", "]"}], ":>", 
       RowBox[{
        SubscriptBox["U", 
         RowBox[{"index1", ",", "index2"}]], "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
             RowBox[{"Cos", "[", 
              FractionBox["\[Theta]", "2"], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
             RowBox[{"Sin", "[", 
              FractionBox["\[Theta]", "2"], "]"}]}], ",", "0"}], " ", "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
             RowBox[{"Sin", "[", 
              FractionBox["\[Theta]", "2"], "]"}]}], ",", " ", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
             RowBox[{"Cos", "[", 
              FractionBox["\[Theta]", "2"], "]"}]}], ",", "0"}], " ", "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
        "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        SubscriptBox["CRx", 
         RowBox[{"e_", ",", "n_"}]], "[", "\[Theta]_", "]"}], ":>", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"U", ",", " ", "e", ",", "n"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "0", ",", 
            RowBox[{"I", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "/", "2"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "I"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "0", ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"I", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "0", ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
       "\[IndentingNewLine]", ",", "\n", "\t", 
      RowBox[{
       RowBox[{
        SubscriptBox["CRy", 
         RowBox[{"e_", ",", "n_"}]], "[", "\[Theta]_", "]"}], ":>", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"U", ",", " ", "e", ",", "n"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "0", ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "0", ",", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "0", ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "0", ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], "}"}]}], "}"}], 
        "]"}]}]}], "\t", "\[IndentingNewLine]", "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CustomGatesDraw", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["SW", 
       RowBox[{"index1_", ",", "index2_"}]], "[", "_", "]"}], ":>", 
     SubscriptBox["SWAP", 
      RowBox[{"index1", ",", "index2"}]]}], "}"}]}], ";"}]}], "Input",
 CellLabel->"In[61]:=",ExpressionUUID->"8bc4e6dd-a953-4dae-8079-8de74896e496"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noisyBCS", "[", 
   RowBox[{"\[Rho]_", ",", "\[Rho]init_", ",", "\[Psi]init_", ",", 
    RowBox[{"vdopt_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Tau]", ",", "rexactnoisy", ",", "noisycirc", ",", "fid"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CloneQureg", "[", 
      RowBox[{"\[Rho]", ",", "\[Rho]init"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rexactnoisy", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"noisycirc", " ", "=", " ", 
         RowBox[{"ExtractCircuit", " ", "@", " ", 
          RowBox[{"InsertCircuitNoise", "[", 
           RowBox[{
            RowBox[{"List", " ", "/@", " ", 
             RowBox[{"sum", "[", "\"\<circnvc\>\"", "]"}]}], ",", " ", 
            RowBox[{"NVCenterDelft", "[", 
             RowBox[{"Sequence", " ", "@@", " ", "vdopt"}], "]"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"noisycirc", " ", "=", " ", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"noisycirc", ",", 
             RowBox[{
              SubscriptBox["__", "__"], "[", "0.", "]"}]}], "]"}], " ", ",", 
           RowBox[{
            SubscriptBox["__", "__"], "[", "0", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{"\[Rho]", ",", " ", 
          RowBox[{"noisycirc", "/.", "CustomGatesDefinitions"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"fid", " ", "=", " ", 
         RowBox[{"CalcFidelity", "[", 
          RowBox[{"\[Rho]", ",", " ", "\[Psi]init"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Tau]", " ", "+=", " ", 
         RowBox[{"sum", "[", "\"\<\[Delta]\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"rexactnoisy", ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", " ", "fid"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<\[Tau]\>\"", "->", "\[Tau]"}], ",", 
          RowBox[{"\"\<\[Delta]\>\"", "->", 
           RowBox[{"sum", "[", "\"\<\[Delta]\>\"", "]"}]}], ",", 
          RowBox[{"\"\<fidnoisy\>\"", "->", "fid"}], ",", 
          RowBox[{"\"\<\[Epsilon]noisy\>\"", "->", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"sum", "[", "\"\<fidexact\>\"", "]"}], "-", "fid"}], 
            "]"}]}]}], "|>"}], "*)"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"sum", ",", "  ", "summarycss2"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "rexactnoisy"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.881044812097389*^9, 3.8810448217436934`*^9}, {
   3.881048084638349*^9, 3.881048094231847*^9}, {3.881048845837515*^9, 
   3.88104886667205*^9}, {3.8810494208471823`*^9, 3.881049423540078*^9}, {
   3.881051557355317*^9, 3.8810515643370934`*^9}, {3.8810515953693047`*^9, 
   3.881051600511465*^9}, {3.881051688439776*^9, 3.881051689455961*^9}, {
   3.8810517641026983`*^9, 3.8810517758782063`*^9}, {3.881051808201334*^9, 
   3.881051898329975*^9}, 3.881051929461796*^9, {3.881053718613748*^9, 
   3.881053743301497*^9}, {3.881055028720049*^9, 3.881055126760248*^9}, {
   3.881055187372018*^9, 3.881055237049036*^9}, {3.8810554729141483`*^9, 
   3.8810554835839033`*^9}, {3.881186239549334*^9, 3.881186242760048*^9}, {
   3.88119353798378*^9, 3.8811935749992247`*^9}, {3.881193872370514*^9, 
   3.8811938804444513`*^9}, {3.8811940792955*^9, 3.881194082066586*^9}, {
   3.881194172120743*^9, 3.8811942074322033`*^9}, {3.881194244279276*^9, 
   3.8811942666151133`*^9}, {3.881194858002404*^9, 3.881194886659912*^9}, {
   3.881194947222557*^9, 3.881194961341895*^9}, {3.881196238841362*^9, 
   3.8811962445356007`*^9}, {3.8811962831479473`*^9, 3.881196350995047*^9}, {
   3.881196388392069*^9, 3.881196391886203*^9}, {3.881203956876966*^9, 
   3.881203958217658*^9}, 3.881221088913815*^9, {3.881430525140645*^9, 
   3.881430526182588*^9}, {3.881431196768702*^9, 3.881431197129931*^9}, {
   3.881612935353835*^9, 3.881612980479375*^9}, {3.881613095329672*^9, 
   3.8816131868367863`*^9}, {3.881621483936997*^9, 3.881621486944118*^9}, {
   3.881622184474296*^9, 3.88162218508153*^9}, {3.8816225215921164`*^9, 
   3.881622523399881*^9}, {3.881622562198123*^9, 3.88162256663373*^9}, {
   3.8920351924205627`*^9, 3.892035222121623*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"370af995-e86d-4065-8152-a8b7f6f8b0fb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
A realistic setting of virtual NV-center device -- inspired from the paper\
\>", "Section",
 CellChangeTimes->{{3.881569656170794*^9, 3.881569659589794*^9}, {
  3.892035912592703*^9, 3.8920359132313004`*^9}, {3.89203608281219*^9, 
  3.892036088173319*^9}, {3.895631084645995*^9, 
  3.895631120825356*^9}},ExpressionUUID->"2777f5e8-01cc-4935-a052-\
ae0147e6dfaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NVCenterDelft", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"QubitNum", "\[Rule]", "5"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"T1", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", " ", "3600"}], ",", 
        RowBox[{"1", "\[Rule]", "60"}], ",", 
        RowBox[{"2", "\[Rule]", "60"}], ",", 
        RowBox[{"3", "\[Rule]", "60"}], ",", 
        RowBox[{"4", "\[Rule]", "60"}]}], " ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"T2", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", " ", "1.5"}], ",", 
        RowBox[{"1", "\[Rule]", "10"}], ",", 
        RowBox[{"2", "\[Rule]", "10"}], ",", 
        RowBox[{"3", "\[Rule]", "10"}], ",", 
        RowBox[{"4", "\[Rule]", "9"}]}], "|>"}]}], "\[IndentingNewLine]", ",",
      "\[IndentingNewLine]", 
     RowBox[{"FreqWeakZZ", "->", "5"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FreqSingleXY", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", 
         RowBox[{"15", "*", 
          SuperscriptBox["10", "6"]}]}], ",", 
        RowBox[{"1", "\[Rule]", "500"}], " ", ",", 
        RowBox[{"2", "\[Rule]", "500"}], ",", 
        RowBox[{"3", "\[Rule]", "500"}], ",", 
        RowBox[{"4", "\[Rule]", "500"}]}], "|>"}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"FreqSingleZ", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"0", "\[Rule]", 
         RowBox[{"32", "*", 
          SuperscriptBox["10", "6"]}]}], ",", 
        RowBox[{"1", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"400", "*", 
          SuperscriptBox["10", "3"]}]}]}], "|>"}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"FreqCRot", "\[Rule]", " ", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"1", "\[Rule]", " ", 
         RowBox[{"1.5", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"2.8", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"0.8", "*", 
          SuperscriptBox["10", "3"]}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", "3"]}]}]}], " ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"FidCRot", "\[Rule]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"1", "\[Rule]", " ", "0.98"}], ",", 
        RowBox[{"2", "\[Rule]", "0.98"}], ",", " ", 
        RowBox[{"3", "\[Rule]", "0.98"}], ",", 
        RowBox[{"4", "\[Rule]", "0.98"}]}], "|>"}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"FidSingleXY", "\[Rule]", " ", 
      RowBox[{"<|", " ", 
       RowBox[{
        RowBox[{"0", "->", "0.9995"}], ",", 
        RowBox[{"1", "\[Rule]", " ", "0.995"}], ",", 
        RowBox[{"2", "\[Rule]", "0.995"}], ",", " ", 
        RowBox[{"3", "\[Rule]", "0.99"}], ",", 
        RowBox[{"4", "\[Rule]", "0.99"}]}], " ", "|>"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"FidSingleZ", "\[Rule]", "  ", 
      RowBox[{"<|", " ", 
       RowBox[{
        RowBox[{"0", "\[Rule]", "1"}], ",", 
        RowBox[{"1", "\[Rule]", " ", "1"}], ",", 
        RowBox[{"2", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"3", "\[Rule]", "1"}], ",", 
        RowBox[{"4", "\[Rule]", "1"}]}], " ", "|>"}]}], "\[IndentingNewLine]",
      ",", "\[IndentingNewLine]", 
     RowBox[{"EFSingleXY", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.75", ",", "0.25"}], "}"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"EFCRot", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.9", ",", "0.1"}], "}"}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FidInit", "\[Rule]", " ", "0.999"}], "\[IndentingNewLine]", ",",
      "\[IndentingNewLine]", 
     RowBox[{"DurInit", "\[Rule]", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}]}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FidMeas", "\[Rule]", "0.946"}], "\[IndentingNewLine]", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DurMeas", "\[Rule]", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.881204069786517*^9, 3.88120408944002*^9}, {
  3.881204119735301*^9, 3.881204119994586*^9}, {3.8819681028864*^9, 
  3.881968109297831*^9}, {3.881968320358224*^9, 3.8819683205338917`*^9}, {
  3.883120416904372*^9, 3.883120428009083*^9}, {3.89203504684268*^9, 
  3.892035052758197*^9}, {3.8920359217208548`*^9, 3.8920359219262342`*^9}, {
  3.892186754563805*^9, 3.892186792991967*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"6fbc810d-6485-4b4c-991e-597dc0300328"],

Cell[TextData[{
 StyleBox["Several tested error scenarios -- these can be flexibly \
changed/added :\n",
  FontWeight->"Bold"],
 StyleBox["\n",
  FontSlant->"Italic"],
 "1)  Exact unitary using ",
 StyleBox["MatrixExp[]",
  FontWeight->"Bold"],
 "\n2) Checking using the resulting CSS compilation\n3) Realistic numbers \
from Mohammed \n4) Perfect gates with realistic decoherence\n5) Extremely \
high gates fidelity 99.999, realistic decoherence\n6) 10x longer decoherece \
with excellent gates 99.999"
}], "Text",
 CellChangeTimes->{{3.881566551932397*^9, 3.8815665820655317`*^9}, {
  3.881566617448444*^9, 3.881566636063497*^9}, {3.881567097780864*^9, 
  3.881567100721909*^9}, {3.881567193119897*^9, 3.881567193950491*^9}, {
  3.881567330619088*^9, 3.8815673932162247`*^9}, {3.881567458429543*^9, 
  3.881567487791073*^9}, {3.881567537111122*^9, 3.881567601967602*^9}, {
  3.8815709012180653`*^9, 3.881570903052471*^9}, {3.881621094720378*^9, 
  3.881621108507627*^9}, {3.8920360998453827`*^9, 3.892036120062954*^9}, {
  3.892195313222911*^9, 3.892195325084111*^9}, {3.895631225872316*^9, 
  3.895631229388225*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"86e66a6c-4d29-45eb-ba5a-c5eccd7dcffa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"labels", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"1", "->", "\"\<Exact propagator\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"2", "->", "\"\<Subspace compilation\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"3", "->", "\"\<Realistic noise\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"4", "->", "\"\<Gates fidelity 99.999, no cross-talk\>\""}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"5", "->", "\"\<Gates fidelity 99.999\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"6", "->", "\"\<10x of T1,T2\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"7", "->", "\"\<Gates fidelity 99.999, 10x of T1,T2\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "8", "->", 
      "\"\<Gates fidelity 99.999, 10x of T1,T2, no cross-talk\>\""}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.88162112502916*^9, 3.881621241977262*^9}, {
  3.881621758233307*^9, 3.881621760977974*^9}, {3.8816220534034367`*^9, 
  3.881622074247993*^9}, {3.881623550624254*^9, 3.881623566810066*^9}, {
  3.881965487631507*^9, 3.881965493340919*^9}, {3.8819656170752172`*^9, 
  3.8819656253149652`*^9}, {3.881968579622805*^9, 3.881968591627492*^9}, {
  3.8819703486623898`*^9, 3.881970362610386*^9}, {3.883106665417835*^9, 
  3.883106696157165*^9}, {3.8831071918077707`*^9, 3.883107194706295*^9}, {
  3.892186824343206*^9, 3.8921868272521687`*^9}, {3.8921890379162827`*^9, 
  3.892189043574061*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"ee7ca4c0-eca8-463b-93f6-e928baeac385"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
   "Prepare", " ", "initialisation", " ", "state", " ", "in", " ", 
    "\[Psi]init", " ", "as", " ", "an", " ", "exact", " ", "groundstate", " ",
     "from", " ", 
    SubscriptBox["H", "BCS"]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DestroyAllQuregs", "[", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]init", "=", 
     RowBox[{"CreateQureg", "[", "5", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hbcs0", "=", 
     RowBox[{"HBCS", "[", 
      RowBox[{"5", ",", "\[Epsilon]", ",", "0"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eigval", ",", "eigvec"}], "}"}], "=", 
     RowBox[{"Eigensystem", "[", 
      RowBox[{"CalcPauliStringMatrix", "@", "hbcs0"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Ordering", "[", 
     RowBox[{"eigval", ",", "1"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initv", "=", 
     RowBox[{"eigvec", "[", 
      RowBox[{"[", 
       RowBox[{"First", "@", 
        RowBox[{"Ordering", "[", 
         RowBox[{"eigval", ",", "1"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initmat", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "/@", "initv"}], ")"}], ".", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"{", "initv", "}"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Rho]", ",", "\[Rho]init"}], "}"}], "=", 
     RowBox[{"CreateDensityQuregs", "[", 
      RowBox[{"5", ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetQuregMatrix", "[", 
     RowBox[{"\[Rho]init", ",", "initmat"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetQuregMatrix", "[", 
     RowBox[{"\[Psi]init", ",", "initv"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8810457443764677`*^9, 3.881045744577362*^9}, {
  3.88104629350677*^9, 3.881046319646402*^9}, {3.881049430787016*^9, 
  3.881049442141918*^9}, {3.881050557202805*^9, 3.881050574201003*^9}, {
  3.8811939890659227`*^9, 3.8811940576143513`*^9}, {3.881194779445217*^9, 
  3.881194783262883*^9}, {3.881194846302162*^9, 3.8811948508959846`*^9}, {
  3.881194980317321*^9, 3.881194980586398*^9}, {3.8811961693625727`*^9, 
  3.88119621794864*^9}, {3.881613219859808*^9, 3.881613222713348*^9}, {
  3.8921871764845057`*^9, 3.892187177425295*^9}, {3.892195332861196*^9, 
  3.8921953603990993`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"adba71c9-6f6e-456b-9bb4-f8ef07351c8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Load", " ", "other", " ", "data", " ", "for", " ", "result", " ", 
     RowBox[{"comparison", ":", " ", "\[IndentingNewLine]", 
      RowBox[{"exact", " ", "propagator"}]}]}], ",", "\[IndentingNewLine]", 
    "  ", 
    RowBox[{
    "approximation", " ", "by", " ", "compilation", " ", "in", " ", "the", 
     " ", "subspace", " ", "and", " ", "converted", " ", "to", " ", "the", 
     " ", "native", " ", "NVC", " ", "gates"}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rexactot2", 
     RowBox[{"<<", "\"\<supplement/BCSonNVCenterDelft/rexactot2.mx\>\""}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rexactcompcss", 
     RowBox[{
     "<<", "\"\<supplement/BCSonNVCenterDelft/rexactcompcss.mx\>\""}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8921871794371233`*^9, 3.892187232407414*^9}, {
  3.892195364194339*^9, 3.892195435452482*^9}, {3.895645524460593*^9, 
  3.8956455273488407`*^9}, {3.8956456211937647`*^9, 3.895645621913433*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"6a29d4b9-5640-4426-9f1a-46b6efaf3de9"],

Cell["\<\
The main execution on scaling the noise.
Highly configurable\
\>", "Text",
 CellChangeTimes->{{3.892188739079855*^9, 3.892188742262006*^9}, {
  3.8921956063162746`*^9, 3.892195614652088*^9}, {3.895643124836425*^9, 
  3.895643134496663*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"94e08855-96d2-4617-a3d7-1c64779744f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
   "Here", " ", "are", " ", "some", " ", "options", " ", "used", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"optgates", ":", " ", 
     RowBox[{
     "set", " ", "all", " ", "qubits", " ", "fidelity", " ", "to", " ", 
      "99.999", "\[IndentingNewLine]", "optdec"}], ":", " ", 
     RowBox[{
     "set", " ", "all", " ", "decoherece", " ", "T1", " ", "and", " ", "T2", 
      " ", "to", " ", "10", "x", " ", "longer"}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"optgates", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FidCRot", " ", "->", " ", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", " ", "->", " ", ".99999"}], "}"}], " ", "&"}], " ", "/@",
           " ", 
          RowBox[{"Range", "[", "4", "]"}]}], "]"}]}], ",", " ", 
       RowBox[{"FidSingleXY", " ", "->", " ", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", " ", "->", " ", ".99999"}], "}"}], " ", "&"}], " ", "/@",
           " ", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}]}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"optdec", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T1", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"0", " ", "->", " ", "36000"}], ",", " ", 
          RowBox[{"1", " ", "->", " ", "600"}], ",", " ", 
          RowBox[{"2", " ", "->", " ", "600"}], ",", " ", 
          RowBox[{"3", " ", "->", " ", "600"}], ",", " ", 
          RowBox[{"4", " ", "->", " ", "600"}]}], " ", "|>"}]}], ",", " ", 
       RowBox[{"T2", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"0", " ", "->", " ", "15"}], ",", " ", 
          RowBox[{"1", " ", "->", " ", "100"}], ",", " ", 
          RowBox[{"2", " ", "->", " ", "100"}], ",", " ", 
          RowBox[{"3", " ", "->", " ", "100"}], ",", " ", 
          RowBox[{"4", " ", "->", " ", "90"}]}], "|>"}]}]}], "}"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", "\n", 
    RowBox[{"The", " ", "main", " ", 
     RowBox[{"execution", ":", " ", 
      RowBox[{
      "notice", " ", "that", " ", "we", " ", "can", " ", "just", " ", 
       "change", " ", "the", " ", 
       RowBox[{"options", ".", " ", "Feel"}], " ", "free", " ", "to", " ", 
       RowBox[{"change", "/", "add"}], " ", "here"}]}]}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bcsfidelities", " ", "=", " ", 
     RowBox[{"<|", "\n", "   ", 
      RowBox[{
       RowBox[{"1", " ", "->", " ", "rexactot2"}], ",", "\n", "   ", 
       RowBox[{"2", " ", "->", " ", "rexactcompcss"}], ",", "\n", "   ", 
       RowBox[{"3", " ", "->", " ", 
        RowBox[{"noisyBCS", "[", 
         RowBox[{"\[Rho]", ",", " ", "\[Rho]init", ",", " ", "\[Psi]init"}], 
         "]"}]}], ",", "\n", "   ", 
       RowBox[{"4", " ", "->", " ", 
        RowBox[{"noisyBCS", "[", 
         RowBox[{
         "\[Rho]", ",", " ", "\[Rho]init", ",", " ", "\[Psi]init", ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"optgates", ",", 
            RowBox[{"{", 
             RowBox[{"FreqWeakZZ", "->", "False"}], "}"}]}], "]"}]}], "]"}]}],
        ",", "\n", "   ", 
       RowBox[{"5", " ", "->", " ", 
        RowBox[{"noisyBCS", "[", 
         RowBox[{
         "\[Rho]", ",", " ", "\[Rho]init", ",", " ", "\[Psi]init", ",", " ", 
          "optgates"}], "]"}]}], ",", "\n", "   ", 
       RowBox[{"6", " ", "->", " ", 
        RowBox[{"noisyBCS", "[", 
         RowBox[{
         "\[Rho]", ",", " ", "\[Rho]init", ",", " ", "\[Psi]init", ",", " ", 
          "optdec"}], "]"}]}], ",", "\n", "   ", 
       RowBox[{"7", " ", "->", " ", 
        RowBox[{"noisyBCS", "[", 
         RowBox[{
         "\[Rho]", ",", " ", "\[Rho]init", ",", " ", "\[Psi]init", ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"optgates", ",", " ", "optdec"}], "]"}]}], "]"}]}], ",", 
       "\n", "   ", 
       RowBox[{"8", " ", "->", " ", 
        RowBox[{"noisyBCS", "[", 
         RowBox[{
         "\[Rho]", ",", " ", "\[Rho]init", ",", " ", "\[Psi]init", ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"optgates", ",", " ", "optdec", ",", " ", 
            RowBox[{"{", 
             RowBox[{"FreqWeakZZ", " ", "->", " ", "False"}], "}"}]}], 
           "]"}]}], "]"}]}]}], "\n", "   ", "|>"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.881613935815844*^9, 3.8816140108435183`*^9}, {
   3.881620755312771*^9, 3.8816207875212727`*^9}, {3.881620821977428*^9, 
   3.881620848464929*^9}, {3.881620933613995*^9, 3.8816210880261307`*^9}, {
   3.881621980794237*^9, 3.881621991677987*^9}, {3.881622025016025*^9, 
   3.8816220423306093`*^9}, {3.881622080419648*^9, 3.881622080732902*^9}, {
   3.881622422042897*^9, 3.881622429747674*^9}, {3.881622550835907*^9, 
   3.881622551121665*^9}, {3.881622632315589*^9, 3.881622632923779*^9}, {
   3.881622677286893*^9, 3.881622680417213*^9}, {3.881968545667677*^9, 
   3.881968567763423*^9}, {3.8831204388055677`*^9, 3.883120439181264*^9}, 
   3.883222085660736*^9, {3.883222185582541*^9, 3.883222185583103*^9}, 
   3.892035839243065*^9, {3.892186855387188*^9, 3.8921868599658613`*^9}, {
   3.8921890253168592`*^9, 3.892189056340735*^9}, {3.892195437914422*^9, 
   3.892195521928772*^9}, {3.8921955836057453`*^9, 3.892195598416553*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"35c016d4-3e08-4239-a611-a3e3ec86610e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotstyles", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AspectRatio", "->", ".6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Background", "->", "White"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "->", "600"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", "Black", ",", "17"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", "16", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"GridLines", "->", 
      RowBox[{"{", 
       RowBox[{"\[Tau]s", ",", "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"GridLinesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"GrayLevel", "[", 
         RowBox[{"0.8", ",", "0.8"}], "]"}], ",", "Thin"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.881623049583599*^9, 3.8816230584593687`*^9}, {
   3.881623183518592*^9, 3.881623238888999*^9}, {3.881623459597453*^9, 
   3.881623479464097*^9}, 3.882511506481716*^9, {3.882511541896653*^9, 
   3.8825115661452847`*^9}, {3.883106529970532*^9, 3.883106540075306*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"5145e7bf-92f8-4de5-9fc7-518b30474d0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "  ", "\[IndentingNewLine]", 
   RowBox[{
   "Beautiful", " ", "plot", " ", "for", " ", "the", " ", "quench", " ", 
    "potential"}], " ", "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"keys", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<analytic\>\"", ",", "\"\<discretised\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"bcs1", "=", 
    RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gdense", ",", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", 
          RowBox[{"\[Tau]s", ",", "gvals"}], "}"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"1.16", ",", "1.58"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Joined", "->", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "->", "0.24"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Dashed"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLegends", "->", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"LineLegend", "[", 
          RowBox[{"keys", ",", 
           RowBox[{"Spacings", "->", "0"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{".15", ",", ".25"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<g(\[Tau])/\!\(\*SubscriptBox[\(\[CapitalDelta]\), \
\(0\)]\)\>\"", ",", "None"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImagePadding", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"58", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Sequence", "@@", "plotstyles"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8817326641340733`*^9, 3.881732760682555*^9}, 
   3.8817328050010157`*^9, {3.881732919001924*^9, 3.88173292929251*^9}, {
   3.881736130945018*^9, 3.8817361386832542`*^9}, {3.881894940710095*^9, 
   3.8818949414192333`*^9}, {3.8818951227847567`*^9, 3.881895142774719*^9}, {
   3.881895175393412*^9, 3.881895211032143*^9}, {3.881895445557815*^9, 
   3.881895445909808*^9}, {3.881895535990794*^9, 3.881895551606728*^9}, 
   3.881895680080551*^9, {3.8819689903007317`*^9, 3.8819689911994753`*^9}, {
   3.8819692319865103`*^9, 3.8819692438501167`*^9}, {3.881969323068407*^9, 
   3.881969323746106*^9}, {3.881973204887807*^9, 3.881973205084941*^9}, {
   3.88197335470647*^9, 3.881973371108632*^9}, {3.881976200373461*^9, 
   3.8819762776980953`*^9}, {3.881979901640664*^9, 3.881979932650825*^9}, {
   3.8819805254412813`*^9, 3.881980525873403*^9}, {3.882509943786853*^9, 
   3.88250995176845*^9}, {3.88251045885736*^9, 3.882510464626831*^9}, {
   3.8825111072209187`*^9, 3.882511117276023*^9}, 3.883106498879101*^9, {
   3.883106584687478*^9, 3.883106589175153*^9}, {3.883107073036481*^9, 
   3.883107102621832*^9}, {3.892195528917327*^9, 3.892195543035337*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"1952878c-9c9f-4e75-afc9-f4fdcfd51193"],

Cell["The compilation outputs for a reference", "Text",
 CellChangeTimes->{{3.8816237839690123`*^9, 3.881623788071558*^9}, {
  3.892195552084433*^9, 3.892195553797122*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"62dcc0ee-f4f2-4878-9aca-4c9c5a738084"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"keys", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bcs2", "=", 
  RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bcsfidelities", "/@", "keys"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Joined", "->", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"True", ",", 
       RowBox[{"Length", "@", "keys"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotStyle", "->", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "Thick", "}"}], ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Dashed", ",", 
         RowBox[{
          RowBox[{"Length", "@", "keys"}], "-", "1"}]}], "]"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"LineLegend", "[", 
        RowBox[{
         RowBox[{"labels", "/@", "keys"}], ",", 
         RowBox[{"Spacings", "->", "0"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{".22", ",", ".2"}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", 
       RowBox[{"{", 
        RowBox[{"0.96", ",", "1.002"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AspectRatio", "->", ".33"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImagePadding", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"58", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "0"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Tau]\>\"", ",", 
       "\"\<Fid(\!\(\*SubscriptBox[\(\[Psi]\), \(t\)]\),\!\(\*SubscriptBox[\(\
\[Psi]\), \(0\)]\))\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", "plotstyles"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ3X9YXWbO6zeOHS1rlUH0TEbRFoU3bxyXWbiC6ea7
01eA6K5MiyMg+qsH40UQfcgw8SqIXt9RecoFSHtsugemp3396OUKpN/N/wem
AyIu1YFoFpmbYJpxsc0ONyCtqCi1E0TXnxXy9QLSQhVyYHoW218f37dvHA/+
X+QLolNNJ8WD6L7H68G08H/GdBCdk55aA6JFn3q1gGiVB6fAtO3sCdcD3r1x
fGDzB0z/sD8iXwCkPSxeKILo7OJ5QSB62s1zYLpHRDoczP/BFAOic7ZFFILo
zKL1YLpnb5f0sf9vHNteHgHTAHr7qTs=
  "],
 CellLabel->"In[84]:=",ExpressionUUID->"cb2b3cae-c1b6-44f2-b533-22ad623fa40e"],

Cell[BoxData[{
 RowBox[{"Column", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bcs1", ",", "bcs2"}], "}"}], ",", 
   RowBox[{"Spacings", "->", 
    RowBox[{"-", "0.1"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<quench.pdf\>\"", ",", "%"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8825109822423887`*^9, 3.882511011428917*^9}, 
   3.8832220973852377`*^9, 3.895631265191358*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"12b7ddf9-da8a-4fde-91f9-d21d3111b797"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
   "The", " ", "final", " ", "plot", " ", "after", " ", "various", " ", 
    "trials"}], " ", "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"keys", "=", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "2", ",", "8", ",", "7", ",", "4", ",", "5", ",", "6", ",", 
       "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"bcs3", "=", 
    RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bcsfidelities", "/@", "keys"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Joined", "->", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"True", ",", 
         RowBox[{"Length", "@", "bcsfidelities"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{
        "Thick", ",", "Dashed", ",", "Thick", ",", "Thick", ",", "Thick", ",",
          "Thick", ",", "Dashed", ",", "Thick"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "->", "0.8"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"LineLegend", "[", 
          RowBox[{
           RowBox[{"labels", "/@", "keys"}], ",", 
           RowBox[{"Spacings", "->", "0"}], ",", 
           RowBox[{"LegendFunction", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Framed", "[", 
               RowBox[{"#", ",", 
                RowBox[{"FrameStyle", "->", 
                 RowBox[{"(", 
                  RowBox[{"Antialiasing", "->", "False"}], ")"}]}], ",", 
                RowBox[{"FrameMargins", "\[Rule]", "0"}]}], "]"}], "&"}], 
             ")"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0.4", ",", "0.2"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImagePadding", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"58", ",", "10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "0"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[Tau]\>\"", ",", 
         "\"\<Fid(\!\(\*SubscriptBox[\(\[Psi]\), \(0\)]\),\!\(\*SubscriptBox[\
\(\[Psi]\), \(t\)]\))\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "27"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.0", ",", "1.03"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BaseStyle", "->", 
       RowBox[{"{", "14", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Sequence", "@@", "plotstyles"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<bcsall.pdf\>\"", ",", "%"}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.881894949082507*^9, 3.881894949978004*^9}, {
   3.8818954678214827`*^9, 3.881895521357092*^9}, {3.881895614472336*^9, 
   3.8818956229430647`*^9}, {3.881965393886487*^9, 3.8819654054487553`*^9}, {
   3.88196545797571*^9, 3.88196545937816*^9}, {3.881965502122761*^9, 
   3.881965581863265*^9}, {3.881968515315143*^9, 3.881968518509193*^9}, {
   3.881968863241658*^9, 3.881968863382017*^9}, {3.8819692475930023`*^9, 
   3.88196924860846*^9}, {3.881970277008391*^9, 3.881970298356309*^9}, {
   3.8819704643408537`*^9, 3.88197048553074*^9}, 3.881970662379367*^9, {
   3.881970755206854*^9, 3.881970755522295*^9}, {3.881971140956897*^9, 
   3.881971142440648*^9}, {3.881971177111713*^9, 3.881971241503668*^9}, {
   3.881971277397957*^9, 3.881971356447937*^9}, {3.881971563419306*^9, 
   3.881971573537422*^9}, {3.88197161151742*^9, 3.881971615087516*^9}, {
   3.881972396318503*^9, 3.88197239645936*^9}, {3.881973085113574*^9, 
   3.8819730862349377`*^9}, {3.8819731687674513`*^9, 3.881973241757391*^9}, {
   3.881980531347496*^9, 3.881980531967565*^9}, {3.882509936176056*^9, 
   3.8825099375594473`*^9}, {3.8825110676868877`*^9, 3.882511070594262*^9}, {
   3.883041179710515*^9, 3.88304138029642*^9}, {3.88304196835086*^9, 
   3.8830420097394257`*^9}, {3.883042055295239*^9, 3.8830420642380247`*^9}, {
   3.883042208569767*^9, 3.8830422111715927`*^9}, {3.883106611178063*^9, 
   3.883106634108881*^9}, {3.8831067144868107`*^9, 3.883106780983336*^9}, 
   3.883222107294652*^9, 3.8920360488616447`*^9, {3.892189289981832*^9, 
   3.892189407955145*^9}, {3.892195560329205*^9, 3.892195570914484*^9}, 
   3.8949706296048307`*^9, 3.8956312495904512`*^9},
 CellLabel->"In[87]:=",ExpressionUUID->"6db6d8ef-40cf-4196-9204-257c7227bc97"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1296., 801.5},
WindowMargins->{{0, Automatic}, {0, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification->1.,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c999cceb-93c8-46be-8fbf-77f5b388eaf3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 451, 7, 98, "Title",ExpressionUUID->"d15a831b-a7a9-4c44-9fc8-632f14beb7e9"],
Cell[1034, 31, 1433, 25, 53, "Subtitle",ExpressionUUID->"86b6ae0c-b31f-476a-8cfd-71aa29495616"],
Cell[CellGroupData[{
Cell[2492, 60, 154, 3, 67, "Section",ExpressionUUID->"2ac9a657-8798-4d2d-b923-97964512c847"],
Cell[2649, 65, 374, 5, 51, "Text",ExpressionUUID->"3304fd8a-d7dc-4a75-8cf8-3d33d0cf0751"],
Cell[3026, 72, 391, 8, 30, "Input",ExpressionUUID->"aed5bfe1-5767-4439-be35-1e2df05d494a"],
Cell[3420, 82, 649, 12, 74, "Text",ExpressionUUID->"ce76efab-251b-412c-b6a3-02c0d0c36601"],
Cell[4072, 96, 1617, 23, 30, "Input",ExpressionUUID->"6e693605-cc17-45f2-9601-2db93546cf18"],
Cell[5692, 121, 897, 20, 74, "Text",ExpressionUUID->"de033515-a5bc-4ab2-8f5f-0a6afdcdab37"],
Cell[6592, 143, 2492, 58, 317, "Input",ExpressionUUID->"2b6af876-686f-4f13-a448-c8adbd2fd37b"],
Cell[9087, 203, 689, 14, 51, "Text",ExpressionUUID->"1a57288f-5674-4f4e-a47b-92ef1e42b7c2"],
Cell[9779, 219, 1221, 17, 30, "Input",ExpressionUUID->"0bca19ed-8b53-40a5-b274-5d8948466e3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11037, 241, 350, 5, 67, "Section",ExpressionUUID->"0a272559-54f5-4241-a2ef-952b0c75bf12"],
Cell[11390, 248, 3519, 123, 102, "Text",ExpressionUUID->"e73935be-87b8-409b-a155-d15789a0d941"],
Cell[14912, 373, 18765, 352, 1032, "Input",ExpressionUUID->"d493ea5b-1198-4fa7-8f89-66bc8b2a689c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33714, 730, 756, 11, 67, "Section",ExpressionUUID->"f9c2da94-9ce1-47f3-aa68-cf4e42d9a9d1"],
Cell[CellGroupData[{
Cell[34495, 745, 160, 3, 54, "Subsection",ExpressionUUID->"a55ea8a9-cdf3-4b72-a237-f73b972a8611"],
Cell[34658, 750, 3673, 94, 273, "Text",ExpressionUUID->"6d381f91-3180-4fd8-b6d2-1f19f4e8d0c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38368, 849, 546, 9, 54, "Subsection",ExpressionUUID->"0f029284-dc78-499a-b674-ed1fb93eef31"],
Cell[38917, 860, 937, 27, 116, "Input",ExpressionUUID->"4edc6d41-1978-4eb1-8f85-fa1d7d6099c6"],
Cell[39857, 889, 6160, 154, 208, "Input",ExpressionUUID->"74f90a35-14ba-43bf-a85c-3ca851c72025"],
Cell[46020, 1045, 284, 5, 52, "Input",ExpressionUUID->"1daf9959-3b3b-4a22-844b-b9a5ee846594"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46341, 1055, 355, 5, 54, "Subsection",ExpressionUUID->"99fb8a63-f5b0-49ca-ab0c-daec83922ac8"],
Cell[46699, 1062, 207, 3, 51, "Text",ExpressionUUID->"80339c59-8cb5-4578-b983-326a6f9eebde"],
Cell[46909, 1067, 1526, 26, 52, "Input",ExpressionUUID->"034244f5-d113-48b8-8b75-3d3d8d845b98"],
Cell[48438, 1095, 651, 15, 73, "Input",ExpressionUUID->"de4d1ece-395f-4d60-91da-39f505b3dc04"],
Cell[49092, 1112, 382, 9, 54, "Text",ExpressionUUID->"47651f31-09a9-4ad9-a719-d288934d1e61"],
Cell[49477, 1123, 904, 16, 55, "Input",ExpressionUUID->"137dc8f3-4385-4f9f-b4cf-fd1dd13b89ec"],
Cell[50384, 1141, 579, 11, 74, "Text",ExpressionUUID->"76e91cef-02b2-43a6-93f8-be75a1996a42"],
Cell[50966, 1154, 346, 6, 30, "Input",ExpressionUUID->"f6e6e06a-9aa3-4ca1-995a-555d882daa69"],
Cell[51315, 1162, 179, 2, 30, "Input",ExpressionUUID->"90e25ae4-1c4c-4e7d-8187-65e2dee5a0ae"],
Cell[51497, 1166, 1441, 28, 117, "Input",ExpressionUUID->"0f5aab87-782f-4658-b73a-288f32a5a38b"],
Cell[52941, 1196, 363, 9, 54, "Text",ExpressionUUID->"e922fe7f-a105-4e2b-be45-3000625dc717"],
Cell[53307, 1207, 937, 18, 55, "Input",ExpressionUUID->"21c3b677-4ced-444e-a378-2df9857ebe75"],
Cell[54247, 1227, 209, 3, 30, "Input",ExpressionUUID->"7b86f670-e9fd-406c-821c-f40ad88ae016"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54493, 1235, 211, 4, 54, "Subsection",ExpressionUUID->"6f030ecf-2a7c-420b-85c6-960c1f28fdbb"],
Cell[54707, 1241, 469, 9, 51, "Text",ExpressionUUID->"3a11bdfe-a70f-424f-b72d-02f2513e601b"],
Cell[55179, 1252, 773, 15, 52, "Input",ExpressionUUID->"537fea4e-864a-439b-9d93-e0a29e7114ed"],
Cell[CellGroupData[{
Cell[55977, 1271, 170, 3, 45, "Subsubsection",ExpressionUUID->"84042dea-1ebb-47fc-8c79-688d2799c3be"],
Cell[56150, 1276, 2023, 43, 188, "Input",ExpressionUUID->"219d489f-c644-4265-800a-bd65fbaf92c7"],
Cell[58176, 1321, 229, 3, 51, "Text",ExpressionUUID->"7b092f1f-b910-481d-8b57-f4038c612cd6"],
Cell[58408, 1326, 252, 4, 30, "Input",ExpressionUUID->"c7ce6366-f3d1-42cd-8563-3411325c8409"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58697, 1335, 361, 5, 45, "Subsubsection",ExpressionUUID->"9ff4bebe-4c63-4be3-8a9c-848e0d1985d5"],
Cell[59061, 1342, 462, 8, 30, "Input",ExpressionUUID->"c0def0b3-f28d-41da-9098-ff1821ca5264"],
Cell[59526, 1352, 337, 7, 51, "Text",ExpressionUUID->"82a3418c-54ae-46b8-8a22-24faaa7520e1"],
Cell[59866, 1361, 250, 5, 30, "Input",ExpressionUUID->"c1d0ccf5-54ba-45fe-9d09-813db9315a95"],
Cell[60119, 1368, 2477, 51, 119, "Input",ExpressionUUID->"a6d3148a-e28f-4040-8e5b-6dd569bc2579"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62657, 1426, 187, 3, 67, "Section",ExpressionUUID->"6d581b08-10ac-4127-8949-6fa35e833b10"],
Cell[CellGroupData[{
Cell[62869, 1433, 456, 7, 54, "Subsection",ExpressionUUID->"bcfb6449-c9b4-4375-a84b-f952066d9c67"],
Cell[63328, 1442, 419, 9, 51, "Text",ExpressionUUID->"b95b8a84-d2c7-4c28-a4a8-1c595c095164"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63784, 1456, 504, 8, 54, "Subsection",ExpressionUUID->"b5d08dee-f526-4bf5-ad7b-d8fcff0b3307"],
Cell[CellGroupData[{
Cell[64313, 1468, 230, 4, 45, "Subsubsection",ExpressionUUID->"aec702d0-7f8a-41d3-aff8-e9cc90822322"],
Cell[64546, 1474, 315, 5, 51, "Text",ExpressionUUID->"6159fd4c-f781-45ed-9d2e-757eef8bd607"],
Cell[64864, 1481, 2391, 62, 142, "Input",ExpressionUUID->"6a7a3d1f-e2cd-4396-b094-4802f0fbcbe1"],
Cell[67258, 1545, 1529, 30, 204, "Input",ExpressionUUID->"bde2edab-ffbe-449b-a477-b6aaa2c5dccf"],
Cell[68790, 1577, 2160, 57, 191, "Input",ExpressionUUID->"ae175ae7-a9dd-44e0-8f90-14922f092593"],
Cell[70953, 1636, 1109, 25, 90, "Input",ExpressionUUID->"9f1f9fae-f930-4a69-b8a8-0e6af1a3fda0"],
Cell[72065, 1663, 207, 3, 51, "Text",ExpressionUUID->"78d6d3e1-cb27-4b3d-879c-6695f02e867a"],
Cell[72275, 1668, 1822, 47, 76, "Input",ExpressionUUID->"53cf8897-1751-47c7-a749-382ea0409b76"],
Cell[74100, 1717, 3460, 81, 289, "Input",ExpressionUUID->"391d971f-f101-4325-a834-40ef67bd8ed1"],
Cell[77563, 1800, 236, 3, 51, "Text",ExpressionUUID->"5fc611c4-999c-4adc-a898-3282c86c635c"],
Cell[77802, 1805, 2632, 66, 179, "Input",ExpressionUUID->"ce78c7d0-8839-4f80-b171-42431e68935e"],
Cell[80437, 1873, 375, 8, 30, "Input",ExpressionUUID->"e886c606-0b0c-45f6-915e-9a75ab68776d"],
Cell[80815, 1883, 649, 13, 52, "Input",ExpressionUUID->"d96f4a3b-351c-4ed1-a545-8d8c0bb07f80"],
Cell[81467, 1898, 2534, 62, 94, "Input",ExpressionUUID->"76f23e1e-4327-4cab-8158-2604f220f4c7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84050, 1966, 188, 3, 54, "Subsection",ExpressionUUID->"09da23ba-ab76-4ff4-bc77-34a492b2e2db"],
Cell[84241, 1971, 364, 7, 30, "Input",ExpressionUUID->"9f408cb2-adee-4811-b0bd-ef4472446759"],
Cell[84608, 1980, 5335, 138, 276, "Input",ExpressionUUID->"8bc4e6dd-a953-4dae-8079-8de74896e496"],
Cell[89946, 2120, 4928, 98, 344, "Input",ExpressionUUID->"370af995-e86d-4065-8152-a8b7f6f8b0fb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94923, 2224, 372, 7, 67, "Section",ExpressionUUID->"2777f5e8-01cc-4935-a052-ae0147e6dfaf"],
Cell[95298, 2233, 5336, 128, 714, "Input",ExpressionUUID->"6fbc810d-6485-4b4c-991e-597dc0300328"],
Cell[100637, 2363, 1215, 24, 212, "Text",ExpressionUUID->"86e66a6c-4d29-45eb-ba5a-c5eccd7dcffa"],
Cell[101855, 2389, 1609, 31, 222, "Input",ExpressionUUID->"ee7ca4c0-eca8-463b-93f6-e928baeac385"],
Cell[103467, 2422, 2649, 65, 286, "Input",ExpressionUUID->"adba71c9-6f6e-456b-9bb4-f8ef07351c8b"],
Cell[106119, 2489, 1195, 26, 158, "Input",ExpressionUUID->"6a29d4b9-5640-4426-9f1a-46b6efaf3de9"],
Cell[107317, 2517, 349, 8, 74, "Text",ExpressionUUID->"94e08855-96d2-4617-a3d7-1c64779744f0"],
Cell[107669, 2527, 5644, 125, 471, "Input",ExpressionUUID->"35c016d4-3e08-4239-a611-a3e3ec86610e"],
Cell[113316, 2654, 1544, 31, 243, "Input",ExpressionUUID->"5145e7bf-92f8-4de5-9fc7-518b30474d0f"],
Cell[114863, 2687, 3442, 75, 307, "Input",ExpressionUUID->"1952878c-9c9f-4e75-afc9-f4fdcfd51193"],
Cell[118308, 2764, 271, 4, 51, "Text",ExpressionUUID->"62dcc0ee-f4f2-4878-9aca-4c9c5a738084"],
Cell[118582, 2770, 2435, 63, 264, "Input",ExpressionUUID->"cb2b3cae-c1b6-44f2-b533-22ad623fa40e"],
Cell[121020, 2835, 531, 13, 52, "Input",ExpressionUUID->"12b7ddf9-da8a-4fde-91f9-d21d3111b797"],
Cell[121554, 2850, 4786, 101, 392, "Input",ExpressionUUID->"6db6d8ef-40cf-4196-9204-257c7227bc97"]
}, Open  ]]
}, Open  ]]
}
]
*)

